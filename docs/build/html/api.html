

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; AFIM 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Methodology: Antarctic (Land)Fast (Sea) Ice Modelling and Metrics" href="AFIM_sensitivity_methodology.html" />
    <link rel="prev" title="AFIM Python Package Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            AFIM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-sea_ice_toolbox">sea_ice_toolbox</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.align_time_coordinate_of_three_arrays"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.align_time_coordinate_of_three_arrays()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.coarsen_and_align_simulated_FI_to_observed_FI"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.coarsen_and_align_simulated_FI_to_observed_FI()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.compute_doy_climatology"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.compute_doy_climatology()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.compute_fipdiff_stats_weighted"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.compute_fipdiff_stats_weighted()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.compute_rolling_mean_on_dataset"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.compute_rolling_mean_on_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.correct_timestamp_for_all_monthly_zarr_iceh"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.correct_timestamp_for_all_monthly_zarr_iceh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.cosine_vector_similarity"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.cosine_vector_similarity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.count_zarr_files"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.count_zarr_files()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.create_empty_valid_DS_dictionary"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.create_empty_valid_DS_dictionary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.create_monthly_strings"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.create_monthly_strings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.daily_iceh_to_monthly_zarr"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.daily_iceh_to_monthly_zarr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.define_classification_dir"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.define_classification_dir()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.define_datetime_vars"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.define_datetime_vars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.define_fast_ice_class_name"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.define_fast_ice_class_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.define_hemisphere"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.define_hemisphere()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.define_ice_class_name"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.define_ice_class_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.define_ice_speed_name"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.define_ice_speed_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.define_iceh_dirs"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.define_iceh_dirs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.define_ispd_thresh_dir"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.define_ispd_thresh_dir()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.define_month_first_last_dates"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.define_month_first_last_dates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.delete_original_cice"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.delete_original_cice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.dict_to_ds"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.dict_to_ds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.get_cice_files_between_dates"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.get_cice_files_between_dates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.get_dir_size"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.get_dir_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.get_month_range"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.get_month_range()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.get_static_grid"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.get_static_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.help"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.help()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.interpret_ice_speed_threshold"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.interpret_ice_speed_threshold()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.load_cice_zarr"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.load_cice_zarr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.load_classified_ice"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.load_classified_ice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.monthly_zarr_iceh_time_correction"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.monthly_zarr_iceh_time_correction()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.parse_simulation_metadata"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.parse_simulation_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.radians_to_degrees"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.radians_to_degrees()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.setup_logging"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.setup_logging()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.slice_hemisphere"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.slice_hemisphere()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.summary"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.summary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.vector_angle_diff"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.vector_angle_diff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.verify_month"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.verify_month()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox.verify_zarr_and_cleanup_netcdf"><code class="docutils literal notranslate"><span class="pre">SeaIceToolbox.verify_zarr_and_cleanup_netcdf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolboxManager"><code class="docutils literal notranslate"><span class="pre">SeaIceToolboxManager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolboxManager.get_toolbox"><code class="docutils literal notranslate"><span class="pre">SeaIceToolboxManager.get_toolbox()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolboxManager.shutdown"><code class="docutils literal notranslate"><span class="pre">SeaIceToolboxManager.shutdown()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-sea_ice_gridwork">sea_ice_gridwork</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.build_F2_GI_from_df"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.build_F2_GI_from_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.build_F2_GI_from_gpkg"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.build_F2_GI_from_gpkg()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.build_F2_form_factors_from_high_res_coast"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.build_F2_form_factors_from_high_res_coast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.build_grid_corners"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.build_grid_corners()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.build_grid_faces"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.build_grid_faces()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.compute_regular_grid_area"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.compute_regular_grid_area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.compute_tcell_dxdy_m"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.compute_tcell_dxdy_m()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.load_cice_grid"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.load_cice_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.map_points_to_tgrid"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.map_points_to_tgrid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.map_xy_to_tgrid"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.map_xy_to_tgrid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.normalise_longitudes"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.normalise_longitudes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.read_grounded_iceberg_csv"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.read_grounded_iceberg_csv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.read_grounded_iceberg_gpkg"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.read_grounded_iceberg_gpkg()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.reapply_landmask"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.reapply_landmask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork.write_F2_with_GI"><code class="docutils literal notranslate"><span class="pre">SeaIceGridWork.write_F2_with_GI()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-sea_ice_classification">sea_ice_classification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#seaiceclassification">SeaIceClassification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#high-level-api">High-level API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#assumptions-required-attributes">Assumptions / required attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.B2Ta"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.B2Ta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.B2Tb"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.B2Tb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.B2Tx"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.B2Tx()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.Bavg_methA"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.Bavg_methA()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.Bavg_methB"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.Bavg_methB()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.C2T"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.C2T()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.Cavg_meth"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.Cavg_meth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.classify_binary_days_fast_ice"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.classify_binary_days_fast_ice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.classify_binary_days_mask"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.classify_binary_days_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.classify_binary_days_pack_ice"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.classify_binary_days_pack_ice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.classify_fast_ice"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.classify_fast_ice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.classify_pack_ice"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.classify_pack_ice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.classify_sea_ice"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.classify_sea_ice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_classification.SeaIceClassification.compute_ispdT"><code class="docutils literal notranslate"><span class="pre">SeaIceClassification.compute_ispdT()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-sea_ice_observations">sea_ice_observations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.AF2020_clim_to_model_time"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.AF2020_clim_to_model_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.AF2020_interpolate_FIA_clim"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.AF2020_interpolate_FIA_clim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.NSIDC_coordinate_transformation"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.NSIDC_coordinate_transformation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.add_lonlat_from_epsg3031"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.add_lonlat_from_epsg3031()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.build_AF2020_grid_corners"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.build_AF2020_grid_corners()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.build_sea_ice_satellite_paths"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.build_sea_ice_satellite_paths()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.compute_NSIDC_metrics"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.compute_NSIDC_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.compute_fip_weight"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.compute_fip_weight()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.dedup_daily_one_file_per_day"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.dedup_daily_one_file_per_day()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.dedup_monthly_one_file_per_month"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.dedup_monthly_one_file_per_month()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.define_FIP_diff_names"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.define_FIP_diff_names()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.define_fast_ice_coordinates"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.define_fast_ice_coordinates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.define_fast_ice_mask_da"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.define_fast_ice_mask_da()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.define_fast_ice_persistence_da"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.define_fast_ice_persistence_da()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.define_reG_regular_weights"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.define_reG_regular_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.define_regular_G"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.define_regular_G()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.ease2_nh_25km"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.ease2_nh_25km()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.ease2_sh_50km"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.ease2_sh_50km()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.grid_coords_from_area"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.grid_coords_from_area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.index_satellite_paths"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.index_satellite_paths()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.l2p_to_daily_grid_pyresample"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.l2p_to_daily_grid_pyresample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.l3c_paths_to_monthly_grid"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.l3c_paths_to_monthly_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.laea_area_def"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.laea_area_def()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.load_AF2020_FIA_summary"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.load_AF2020_FIA_summary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.load_local_NSIDC"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.load_local_NSIDC()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.make_area_definition"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.make_area_definition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.make_daily_gridded_SIT"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.make_daily_gridded_SIT()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.make_monthly_gridded_SIT_L3"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.make_monthly_gridded_SIT_L3()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.regional_fast_ice_area"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.regional_fast_ice_area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.resample_swath_to_area"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.resample_swath_to_area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.snap_extent_to_grid"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.snap_extent_to_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.to_3031_extent"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.to_3031_extent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_observations.SeaIceObservations.union_extents"><code class="docutils literal notranslate"><span class="pre">SeaIceObservations.union_extents()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-sea_ice_metrics">sea_ice_metrics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.antarctic_year_labels"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.antarctic_year_labels()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_area"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.compute_hemisphere_ice_area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_area_rate"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.compute_hemisphere_ice_area_rate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_strength"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.compute_hemisphere_ice_strength()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_thickness"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.compute_hemisphere_ice_thickness()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_volume"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.compute_hemisphere_ice_volume()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_volume_rate"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.compute_hemisphere_ice_volume_rate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_variable_aggregate"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.compute_hemisphere_variable_aggregate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.compute_sea_ice_metrics"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.compute_sea_ice_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.compute_seasonal_statistics"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.compute_seasonal_statistics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.compute_sector_FIA"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.compute_sector_FIA()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.compute_sector_ice_area"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.compute_sector_ice_area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.compute_skill_statistics"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.compute_skill_statistics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.extrema_means_antarctic_year"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.extrema_means_antarctic_year()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.fast_ice_metrics_data_dict"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.fast_ice_metrics_data_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.load_computed_metrics"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.load_computed_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.pack_ice_metrics_data_dict"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.pack_ice_metrics_data_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.persistence_ice_distance_mean_max"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.persistence_ice_distance_mean_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.persistence_stability_index"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.persistence_stability_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics.sea_ice_metrics_data_dict"><code class="docutils literal notranslate"><span class="pre">SeaIceMetrics.sea_ice_metrics_data_dict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-sea_ice_plotter">sea_ice_plotter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.create_IBCSO_bath"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.create_IBCSO_bath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.create_cbar_frame"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.create_cbar_frame()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.extract_min_max_dates"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.extract_min_max_dates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.generate_regional_annotation_stats"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.generate_regional_annotation_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.get_meridian_center_from_geographic_extent"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.get_meridian_center_from_geographic_extent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.load_IBCSO_bath"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.load_IBCSO_bath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.load_ice_shelves"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.load_ice_shelves()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.plot_taylor"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.plot_taylor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.pygmt_FIP_figure"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.pygmt_FIP_figure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.pygmt_da_prep"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.pygmt_da_prep()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.pygmt_fastice_panel"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.pygmt_fastice_panel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.pygmt_map_plot_multi_var_8sectors"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.pygmt_map_plot_multi_var_8sectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.pygmt_map_plot_one_var"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.pygmt_map_plot_one_var()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.pygmt_timeseries"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.pygmt_timeseries()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.tricolor_cpt_and_alpha"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.tricolor_cpt_and_alpha()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.write_tricolor_category_cpt"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.write_tricolor_category_cpt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_plotter.SeaIcePlotter.write_tricolour_cpt"><code class="docutils literal notranslate"><span class="pre">SeaIcePlotter.write_tricolour_cpt()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-sea_ice_regridder">sea_ice_regridder</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder.add_lonlat_from_epsg3031"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder.add_lonlat_from_epsg3031()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder.define_reG_weights"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder.define_reG_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder.grid_coords_from_area"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder.grid_coords_from_area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder.make_area_definition"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder.make_area_definition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder.pygmt_regrid"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder.pygmt_regrid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder.reG_bgrid_to_tgrid_xesmf"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder.reG_bgrid_to_tgrid_xesmf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder.resample_swath_to_area"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder.resample_swath_to_area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder.simple_spatial_averaging_bgrid_to_tgrid"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder.simple_spatial_averaging_bgrid_to_tgrid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder.snap_extent_to_grid"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder.snap_extent_to_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder.subset_by_lonlat_box"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder.subset_by_lonlat_box()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder.to_3031_extent"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder.to_3031_extent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder.union_extents"><code class="docutils literal notranslate"><span class="pre">SeaIceRegridder.union_extents()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-sea_ice_icebergs">sea_ice_icebergs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sea_ice_icebergs.SeaIceIcebergs"><code class="docutils literal notranslate"><span class="pre">SeaIceIcebergs</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_icebergs.SeaIceIcebergs.check_GI_coverage"><code class="docutils literal notranslate"><span class="pre">SeaIceIcebergs.check_GI_coverage()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_icebergs.SeaIceIcebergs.compute_grounded_iceberg_area"><code class="docutils literal notranslate"><span class="pre">SeaIceIcebergs.compute_grounded_iceberg_area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_icebergs.SeaIceIcebergs.load_GI_lon_lats"><code class="docutils literal notranslate"><span class="pre">SeaIceIcebergs.load_GI_lon_lats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_icebergs.SeaIceIcebergs.load_existing_thinned"><code class="docutils literal notranslate"><span class="pre">SeaIceIcebergs.load_existing_thinned()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_icebergs.SeaIceIcebergs.modify_landmask_with_grounded_icebergs"><code class="docutils literal notranslate"><span class="pre">SeaIceIcebergs.modify_landmask_with_grounded_icebergs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_icebergs.SeaIceIcebergs.process_raw_grounded_iceberg_database"><code class="docutils literal notranslate"><span class="pre">SeaIceIcebergs.process_raw_grounded_iceberg_database()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_icebergs.SeaIceIcebergs.regrid_gi_to_fip_bool"><code class="docutils literal notranslate"><span class="pre">SeaIceIcebergs.regrid_gi_to_fip_bool()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_icebergs.SeaIceIcebergs.write_modified_landmask_and_counts_to_disk"><code class="docutils literal notranslate"><span class="pre">SeaIceIcebergs.write_modified_landmask_and_counts_to_disk()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-sea_ice_ACCESS">sea_ice_ACCESS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sea_ice_ACCESS.SeaIceACCESS"><code class="docutils literal notranslate"><span class="pre">SeaIceACCESS</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_ACCESS.SeaIceACCESS.list_access_cice_variables"><code class="docutils literal notranslate"><span class="pre">SeaIceACCESS.list_access_cice_variables()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_ACCESS.SeaIceACCESS.load_ACCESS_OM_CICE"><code class="docutils literal notranslate"><span class="pre">SeaIceACCESS.load_ACCESS_OM_CICE()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sea_ice_ACCESS.SeaIceACCESS.write_ACCESS_to_monthly_zarr"><code class="docutils literal notranslate"><span class="pre">SeaIceACCESS.write_ACCESS_to_monthly_zarr()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="AFIM_sensitivity_methodology.html">Methodology: Antarctic (Land)Fast (Sea) Ice Modelling and Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="lateral_drag_form_factor_creation.html">Coastal-drag form factors from high-resolution coastline and grounded icebergs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AFIM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading"></a></h1>
<section id="module-sea_ice_toolbox">
<span id="sea-ice-toolbox"></span><h2>sea_ice_toolbox<a class="headerlink" href="#module-sea_ice_toolbox" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sea_ice_toolbox.</span></span><span class="sig-name descname"><span class="pre">SeaIceToolbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_json</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_CICE_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_of_BorC2T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iceh_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_concentration_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_speed_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_win_days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_min_days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cice_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemisphere</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dask_memory_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_zarr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_saved_figs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_new_figs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_figs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_original_cice_iceh_nc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_recompile_ice_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sea_ice_classification.SeaIceClassification" title="sea_ice_classification.SeaIceClassification"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeaIceClassification</span></code></a>, <a class="reference internal" href="#sea_ice_metrics.SeaIceMetrics" title="sea_ice_metrics.SeaIceMetrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeaIceMetrics</span></code></a>, <a class="reference internal" href="sea_ice_plotter.html#sea_ice_plotter.SeaIcePlotter" title="sea_ice_plotter.SeaIcePlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeaIcePlotter</span></code></a>, <a class="reference internal" href="#sea_ice_icebergs.SeaIceIcebergs" title="sea_ice_icebergs.SeaIceIcebergs"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeaIceIcebergs</span></code></a>, <a class="reference internal" href="#sea_ice_observations.SeaIceObservations" title="sea_ice_observations.SeaIceObservations"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeaIceObservations</span></code></a>, <a class="reference internal" href="#sea_ice_ACCESS.SeaIceACCESS" title="sea_ice_ACCESS.SeaIceACCESS"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeaIceACCESS</span></code></a>, <a class="reference internal" href="#sea_ice_gridwork.SeaIceGridWork" title="sea_ice_gridwork.SeaIceGridWork"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeaIceGridWork</span></code></a>, <a class="reference internal" href="#sea_ice_regridder.SeaIceRegridder" title="sea_ice_regridder.SeaIceRegridder"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeaIceRegridder</span></code></a></p>
<p>Unified toolbox for processing and analysing Antarctic sea ice from CICE simulations
as part of the Antarctic Fast Ice Model (AFIM) workflow.</p>
<section id="composition">
<h3>Composition<a class="headerlink" href="#composition" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>SeaIceClassification : fast/pack ice masking and simulation I/O</p></li>
<li><p>SeaIceMetrics        : metrics and statistics</p></li>
<li><p>SeaIcePlotter        : PyGMT maps and time series</p></li>
<li><p>SeaIceIcebergs       : grounded iceberg thinning/masking</p></li>
<li><p>SeaIceObservations   : Fraser et al. (2020) &amp; NSIDC integration</p></li>
<li><p>SeaIceACCESS         : ACCESS-OM sea-ice helpers</p></li>
<li><p>SeaIceGridWork       :</p></li>
<li><p>SeaIceRegridder      : B→T regridding helpers</p></li>
</ul>
</section>
<section id="key-external-data">
<h3>Key external data<a class="headerlink" href="#key-external-data" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Fraser et al. (2020) fast-ice climatology (ESSD)</p></li>
<li><p>NSIDC daily sea-ice concentration</p></li>
<li><p>AFIM JSON config (paths, parameters)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">param P_json<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to AFIM JSON configuration file (defaults to project root if None).</p>
</dd>
<dt class="field-even">type P_json<span class="colon">:</span></dt>
<dd class="field-even"><p>str | Path, optional</p>
</dd>
<dt class="field-odd">param sim_name<span class="colon">:</span></dt>
<dd class="field-odd"><p>Simulation name (must match an entry under <cite>AFIM_out</cite> in the config).</p>
</dd>
<dt class="field-even">type sim_name<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
<dt class="field-odd">param dt0_str<span class="colon">:</span></dt>
<dd class="field-odd"><p>Analysis date bounds in <cite>YYYY-MM-DD</cite>.</p>
</dd>
<dt class="field-even">type dt0_str<span class="colon">:</span></dt>
<dd class="field-even"><p>str, optional</p>
</dd>
<dt class="field-odd">param dtN_str<span class="colon">:</span></dt>
<dd class="field-odd"><p>Analysis date bounds in <cite>YYYY-MM-DD</cite>.</p>
</dd>
<dt class="field-even">type dtN_str<span class="colon">:</span></dt>
<dd class="field-even"><p>str, optional</p>
</dd>
<dt class="field-odd">param ice_concentration_threshold<span class="colon">:</span></dt>
<dd class="field-odd"><p>Concentration cutoff for fast ice (default 0.15).</p>
</dd>
<dt class="field-even">type ice_concentration_threshold<span class="colon">:</span></dt>
<dd class="field-even"><p>float, optional</p>
</dd>
<dt class="field-odd">param ice_speed_threshold<span class="colon">:</span></dt>
<dd class="field-odd"><p>Speed threshold (m/s) below which ice is considered fast (default 5e-4).</p>
</dd>
<dt class="field-even">type ice_speed_threshold<span class="colon">:</span></dt>
<dd class="field-even"><p>float, optional</p>
</dd>
<dt class="field-odd">param ice_vector_type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Which speed field(s) to use: <cite>‘B’</cite>, <cite>‘Ta’</cite>, <cite>‘Tb’</cite> <cite>‘Tx’</cite>, or <cite>‘BT’</cite>.</p>
</dd>
<dt class="field-even">type ice_vector_type<span class="colon">:</span></dt>
<dd class="field-even"><p>str | list[str], optional</p>
</dd>
<dt class="field-odd">param ice_type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Classification (“FI”, “PI”, etc.), combined later into <cite>self.ice_class</cite>.</p>
</dd>
<dt class="field-even">type ice_type<span class="colon">:</span></dt>
<dd class="field-even"><p>str | list[str], optional</p>
</dd>
<dt class="field-odd">param mean_period<span class="colon">:</span></dt>
<dd class="field-odd"><p>N-day rolling window for speed smoothing (default 15).</p>
</dd>
<dt class="field-even">type mean_period<span class="colon">:</span></dt>
<dd class="field-even"><p>int, optional</p>
</dd>
<dt class="field-odd">param bin_win_days<span class="colon">:</span></dt>
<dd class="field-odd"><p>Binary-days window size and minimum days (defaults per config).</p>
</dd>
<dt class="field-even">type bin_win_days<span class="colon">:</span></dt>
<dd class="field-even"><p>int, optional</p>
</dd>
<dt class="field-odd">param bin_min_days<span class="colon">:</span></dt>
<dd class="field-odd"><p>Binary-days window size and minimum days (defaults per config).</p>
</dd>
<dt class="field-even">type bin_min_days<span class="colon">:</span></dt>
<dd class="field-even"><p>int, optional</p>
</dd>
<dt class="field-odd">param hemisphere<span class="colon">:</span></dt>
<dd class="field-odd"><p>Controls hemisphere slicing throughout the pipeline.</p>
</dd>
<dt class="field-even">type hemisphere<span class="colon">:</span></dt>
<dd class="field-even"><p>{‘south’,’north’}, optional</p>
</dd>
<dt class="field-odd">param P_log<span class="colon">:</span></dt>
<dd class="field-odd"><p>Log file to attach to the toolbox logger.</p>
</dd>
<dt class="field-even">type P_log<span class="colon">:</span></dt>
<dd class="field-even"><p>Path, optional</p>
</dd>
<dt class="field-odd">param save_new_figs<span class="colon">:</span></dt>
<dd class="field-odd"><p>Figure output/interactive toggles.</p>
</dd>
<dt class="field-even">type save_new_figs<span class="colon">:</span></dt>
<dd class="field-even"><p>bool, optional</p>
</dd>
<dt class="field-odd">param show_figs<span class="colon">:</span></dt>
<dd class="field-odd"><p>Figure output/interactive toggles.</p>
</dd>
<dt class="field-even">type show_figs<span class="colon">:</span></dt>
<dd class="field-even"><p>bool, optional</p>
</dd>
<dt class="field-odd">param client<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pre-existing Dask client. If omitted, use <cite>SeaIceToolboxManager</cite>.</p>
</dd>
<dt class="field-even">type client<span class="colon">:</span></dt>
<dd class="field-even"><p>dask.distributed.Client, optional</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The constructor normalises configuration, paths, thresholds, and date
bounds, then prints a short summary to the logger.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.align_time_coordinate_of_three_arrays">
<span class="sig-name descname"><span class="pre">align_time_coordinate_of_three_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.align_time_coordinate_of_three_arrays"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.align_time_coordinate_of_three_arrays" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.coarsen_and_align_simulated_FI_to_observed_FI">
<span class="sig-name descname"><span class="pre">coarsen_and_align_simulated_FI_to_observed_FI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doy_vals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_time_coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.coarsen_and_align_simulated_FI_to_observed_FI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.coarsen_and_align_simulated_FI_to_observed_FI" title="Link to this definition"></a></dt>
<dd><p>Coarsen daily sim data into windows defined by AF2020 observation periods.</p>
<dl class="simple">
<dt>INPUTS:</dt><dd><p>sim_ds : xr.Dataset; daily CICE model output with time dimension.
obs_ds : xr.Dataset; oservational fast ice dataset with <cite>t_FI_obs</cite> coordinate.
doy_vals : list of int; DOY start values for each observation period. Defaults to AF2020 standard (24 bins).
method : str; Aggregation method (“mean” or “median”).</p>
</dd>
<dt>OUTPUTS:</dt><dd><p>Dataset with same shape as obs_ds[t_FI_obs] and matched time resolution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.compute_doy_climatology">
<span class="sig-name descname"><span class="pre">compute_doy_climatology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leap_year</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.compute_doy_climatology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.compute_doy_climatology" title="Link to this definition"></a></dt>
<dd><p>Compute day-of-year (DOY) climatology statistics from a time series.</p>
<p>This method calculates the climatological mean, minimum, maximum, and standard deviation
of a given time series DataArray, grouped by day-of-year. The result is returned as a
dictionary of Pandas Series indexed by a datetime index constructed using a reference
<cite>leap_year</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<em>xarray.DataArray</em>) – The input time series with a time coordinate. Can be daily or sub-daily resolution,
but must be regular and span multiple years for meaningful climatology.</p></li>
<li><p><strong>leap_year</strong> (<em>int</em><em>, </em><em>optional</em>) – The reference leap year to use when reconstructing the datetime index for the output.
Defaults to <cite>self.leap_year</cite> if not provided.</p></li>
<li><p><strong>time_coord</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the time coordinate in <cite>da</cite>. Defaults to <cite>self.CICE_dict[‘time_dim’]</cite> if not specified.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A dictionary with keys:
- ‘mean’ : pd.Series of climatological mean values
- ‘min’  : pd.Series of climatological minimum values
- ‘max’  : pd.Series of climatological maximum values
- ‘std’  : pd.Series of climatological standard deviation</p>
<p>Each Series is indexed by datetime values (from the specified <cite>leap_year</cite>) corresponding to
days 1–366.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The output includes 366 days if data contains leap years; otherwise, it includes up to 365.</p></li>
<li><p>The use of a leap year for index construction ensures that the DOY mapping to dates is valid,</p></li>
</ul>
<p>especially for plotting or seasonal alignment.
- The DataArray is fully loaded into memory before processing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.compute_fipdiff_stats_weighted">
<span class="sig-name descname"><span class="pre">compute_fipdiff_stats_weighted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FIP</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PIXEL</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regs_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gi_mask_da</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip01</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threecat_percent_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.compute_fipdiff_stats_weighted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.compute_fipdiff_stats_weighted" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.compute_rolling_mean_on_dataset">
<span class="sig-name descname"><span class="pre">compute_rolling_mean_on_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.compute_rolling_mean_on_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.compute_rolling_mean_on_dataset" title="Link to this definition"></a></dt>
<dd><p>Apply a centered temporal rolling mean to a dataset.</p>
<p>This method smooths temporal noise by computing a centered moving average across the time dimension,
typically for use in rolling fast ice classification.</p>
<dl class="simple">
<dt>INPUTS:</dt><dd><p>ds          : xarray.Dataset; input dataset with a <cite>time</cite> dimension.
mean_period : int, optional; rolling window size in days. Defaults to <cite>self.mean_period</cite>.</p>
</dd>
<dt>OUTPUTS:</dt><dd><p>xarray.Dataset; dataset with all variables averaged over the specified rolling window.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.correct_timestamp_for_all_monthly_zarr_iceh">
<span class="sig-name descname"><span class="pre">correct_timestamp_for_all_monthly_zarr_iceh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dry_run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.correct_timestamp_for_all_monthly_zarr_iceh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.correct_timestamp_for_all_monthly_zarr_iceh" title="Link to this definition"></a></dt>
<dd><p>Loop through all monthly Zarr files in one or more simulation archives and correct the time index.
See monthly_zarr_iceh_time_correction()</p>
<dl>
<dt>INPUTS</dt><dd><dl class="simple">
<dt>sim_name_list<span class="classifier">list of str, optional; list of simulation names (e.g., [“FI-heavy”, “PI-control”]).</span></dt><dd><p>If None, defaults to [self.sim_name].</p>
</dd>
</dl>
<p>dry_run       : bool, optional; if True, no files will be changed — actions will be logged only.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.cosine_vector_similarity">
<span class="sig-name descname"><span class="pre">cosine_vector_similarity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">um</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.cosine_vector_similarity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.cosine_vector_similarity" title="Link to this definition"></a></dt>
<dd><p>Compute the cosine similarity between two vector fields (e.g., observed vs. modelled velocity vectors).</p>
<p>This metric quantifies the directional alignment of the two vector fields without considering magnitude.
A value of:
- +1.0 means the vectors point in exactly the same direction,
-  0.0 means the vectors are orthogonal (90° apart),
- -1.0 means the vectors point in opposite directions.</p>
<p>The cosine similarity is computed as the dot product of the two vectors, divided by the product of their magnitudes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uo</strong> (<em>xarray.DataArray</em>) – Components of the observed vector field (e.g., <cite>u</cite> and <cite>v</cite> velocity components) in units of m/s.</p></li>
<li><p><strong>vo</strong> (<em>xarray.DataArray</em>) – Components of the observed vector field (e.g., <cite>u</cite> and <cite>v</cite> velocity components) in units of m/s.</p></li>
<li><p><strong>um</strong> (<em>xarray.DataArray</em>) – Components of the modelled vector field (same units as <cite>uo</cite>, <cite>vo</cite>).</p></li>
<li><p><strong>vm</strong> (<em>xarray.DataArray</em>) – Components of the modelled vector field (same units as <cite>uo</cite>, <cite>vo</cite>).</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional</em>) – Small constant to prevent division by zero in regions where either vector magnitude is near-zero. Default is 1e-12.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cosine similarity between vectors, dimensionless, in the range [-1, 1].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>NaNs are returned where either the observed or modelled vector magnitude is near-zero.</p></li>
<li><p>This metric is <strong>scale-invariant</strong> — it compares <strong>direction only</strong>, not speed.</p></li>
<li><p>Particularly useful for evaluating sea ice drift direction skill, regardless of speed bias.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.count_zarr_files">
<span class="sig-name descname"><span class="pre">count_zarr_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.count_zarr_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.count_zarr_files" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.create_empty_valid_DS_dictionary">
<span class="sig-name descname"><span class="pre">create_empty_valid_DS_dictionary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">valid_zarr_DS_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.create_empty_valid_DS_dictionary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.create_empty_valid_DS_dictionary" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.create_monthly_strings">
<span class="sig-name descname"><span class="pre">create_monthly_strings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.create_monthly_strings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.create_monthly_strings" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.daily_iceh_to_monthly_zarr">
<span class="sig-name descname"><span class="pre">daily_iceh_to_monthly_zarr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_iceh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">netcdf_engine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scipy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_original</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.daily_iceh_to_monthly_zarr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.daily_iceh_to_monthly_zarr" title="Link to this definition"></a></dt>
<dd><p>Convert daily CICE <code class="docutils literal notranslate"><span class="pre">iceh.YYYY-MM-DD.nc</span></code> files into a monthly Zarr store.</p>
<p>For each month intersecting the requested date window, this method:
1) groups existing daily NetCDFs by month,
2) opens them with <code class="docutils literal notranslate"><span class="pre">xarray.open_mfdataset(...,</span> <span class="pre">engine='scipy')</span></code>,
3) shifts the time coordinate <strong>back by 1 day</strong> (CICE writes 00:00:00 of
the following day for daily averages),
4) writes to a grouped Zarr store at <code class="docutils literal notranslate"><span class="pre">{self.D_zarr}/iceh_daily.zarr</span></code>
under group <code class="docutils literal notranslate"><span class="pre">YYYY-MM</span></code> (consolidated metadata),
5) optionally deletes the original NetCDF files if the Zarr group exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sim_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Simulation name. Defaults to <code class="docutils literal notranslate"><span class="pre">self.sim_name</span></code>.</p></li>
<li><p><strong>dt0_str</strong> (<em>str</em><em>, </em><em>optional</em>) – Date window (inclusive) in <code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">self.dt0_str</span></code>
and <code class="docutils literal notranslate"><span class="pre">self.dtN_str</span></code> when omitted.</p></li>
<li><p><strong>dtN_str</strong> (<em>str</em><em>, </em><em>optional</em>) – Date window (inclusive) in <code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">self.dt0_str</span></code>
and <code class="docutils literal notranslate"><span class="pre">self.dtN_str</span></code> when omitted.</p></li>
<li><p><strong>D_iceh</strong> (<em>str</em><em> or </em><em>pathlib.Path</em><em>, </em><em>optional</em>) – Directory containing the per-day <code class="docutils literal notranslate"><span class="pre">iceh.YYYY-MM-DD.nc</span></code> files.
Defaults to <code class="docutils literal notranslate"><span class="pre">self.D_iceh</span></code>.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False and a monthly group already exists, the group is skipped (but
originals may still be deleted if <cite>delete_original</cite> is True).
Defaults to <code class="docutils literal notranslate"><span class="pre">self.overwrite_zarr_group</span></code>.</p></li>
<li><p><strong>delete_original</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, remove the month’s original NetCDF files <strong>after</strong> successful
Zarr write. Defaults to <code class="docutils literal notranslate"><span class="pre">self.del_org_cice_iceh_nc</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Writes Zarr groups and logs progress; may delete input NetCDFs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The time shift of <code class="docutils literal notranslate"><span class="pre">-1</span> <span class="pre">day</span></code> aligns Zarr entries with the <a href="#id1"><span class="problematic" id="id2">*</span></a>date of the</p></li>
</ul>
<p>average*, not the CICE timestamp.
- Output chunks are set via <code class="docutils literal notranslate"><span class="pre">self.CICE_dict['FI_chunks']</span></code> after open.
- The Zarr root is <code class="docutils literal notranslate"><span class="pre">{self.D_zarr}/iceh_daily.zarr</span></code> with one subgroup per month.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.define_classification_dir">
<span class="sig-name descname"><span class="pre">define_classification_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_zarr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ispd_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.define_classification_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.define_classification_dir" title="Link to this definition"></a></dt>
<dd><p>Define the output directory path for a given ice speed threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>D_zarr</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Base path to the parent Zarr directory. Defaults to <cite>self.D_zarr</cite>.</p></li>
<li><p><strong>ispd_thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – Ice speed threshold to be included in the subdirectory name. Defaults to <cite>self.ispd_thresh</cite>.</p></li>
<li><p><strong>Sets</strong></p></li>
<li><p><strong>----</strong></p></li>
<li><p><strong>self.D_ispd_thresh</strong> (<em>Path</em>) – Full path to the threshold-specific subdirectory, e.g., “ispd_thresh_5.0e-4”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.define_datetime_vars">
<span class="sig-name descname"><span class="pre">define_datetime_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.define_datetime_vars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.define_datetime_vars" title="Link to this definition"></a></dt>
<dd><p>Define date range attributes from start and end date strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt0_str</strong> (<em>str</em><em>, </em><em>optional</em>) – Start date string (e.g., ‘1994-01-01’). Defaults to <cite>self.dt0_str</cite>.</p></li>
<li><p><strong>dtN_str</strong> (<em>str</em><em>, </em><em>optional</em>) – End date string (e.g., ‘1999-12-31’). Defaults to <cite>self.dtN_str</cite>.</p></li>
<li><p><strong>Sets</strong></p></li>
<li><p><strong>----</strong></p></li>
<li><p><strong>self.dt0</strong> (<em>pd.Timestamp</em>) – Parsed start date.</p></li>
<li><p><strong>self.dtN</strong> (<em>pd.Timestamp</em>) – Parsed end date.</p></li>
<li><p><strong>self.yrs_mos</strong> (<em>np.ndarray</em>) – Array of ‘YYYY-MM’ strings for each month in the range.</p></li>
<li><p><strong>self.ymd_strs</strong> (<em>np.ndarray</em>) – Array of ‘YYYY-MM-DD’ strings for each day in the range.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.define_fast_ice_class_name">
<span class="sig-name descname"><span class="pre">define_fast_ice_class_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">BorC2T_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fast_ice_class_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'binary-days'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.define_fast_ice_class_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.define_fast_ice_class_name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.define_hemisphere">
<span class="sig-name descname"><span class="pre">define_hemisphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hemisphere</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.define_hemisphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.define_hemisphere" title="Link to this definition"></a></dt>
<dd><p>Initialise the hemisphere configuration for analysis.</p>
<p>Maps common inputs (e.g. ‘north’, ‘NH’, ‘sh’) to the internal
<cite>self.hemisphere_dict</cite> used for slicing, and converts the configured
<cite>nj_slice</cite> tuple to a Python <cite>slice</cite>.</p>
<section id="sets">
<h4>Sets<a class="headerlink" href="#sets" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>self.hemisphere_dict<span class="classifier">dict</span></dt><dd><p>Slicing and naming metadata (includes <cite>nj_slice</cite> and abbreviation).</p>
</dd>
<dt>self.hemisphere<span class="classifier">str</span></dt><dd><p>Canonical lowercase hemisphere name.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">raises ValueError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If the input does not match any accepted names.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.define_ice_class_name">
<span class="sig-name descname"><span class="pre">define_ice_class_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BorC2T_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.define_ice_class_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.define_ice_class_name" title="Link to this definition"></a></dt>
<dd><p>Define the classification name string for ice type and vector component type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice_type</strong> (<em>str</em><em> or </em><em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Type(s) of ice classification (e.g., ‘fast’, ‘drift’). Defaults to <cite>self.ice_type</cite>.</p></li>
<li><p><strong>BorC2T_type</strong> (<em>str</em><em> or </em><em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Type(s) of ice velocity vector used (e.g., ‘B’, ‘Ta’, ‘Tb’, ‘Tx’). Defaults to <cite>self.BorC2T_type</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – If any provided <cite>ice_type</cite> or <cite>BorC2T_type</cite> is not in the list of valid types.</p></li>
<li><p><strong>Sets</strong> – </p></li>
<li><p><strong>----</strong> – </p></li>
</ul>
</dd>
</dl>
<p>:raises self.ice_class : str: Combined classification string in the format “{ice_type}_{BorC2T_type}”.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.define_ice_speed_name">
<span class="sig-name descname"><span class="pre">define_ice_speed_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">BorC2T_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.define_ice_speed_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.define_ice_speed_name" title="Link to this definition"></a></dt>
<dd><p>Set the canonical name for the selected ice-speed vector type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BorC2T_type</strong> (<em>str</em><em>, </em><em>optional</em>) – One of the valid vector types (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ta&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Tx&quot;</span></code>, or
composites depending on your config). Defaults to <code class="docutils literal notranslate"><span class="pre">self.BorC2T_type</span></code>.</p></li>
<li><p><strong>Sets</strong></p></li>
<li><p><strong>----</strong></p></li>
<li><p><strong>self.ispd_name</strong> (<em>str</em>) – Name used throughout outputs/paths, formatted as <code class="docutils literal notranslate"><span class="pre">f&quot;ispd_{BorC2T_type}&quot;</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>BorC2T_type</cite> is invalid (validated by <cite>_check_BorC2T_type</cite>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.define_iceh_dirs">
<span class="sig-name descname"><span class="pre">define_iceh_dirs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D_sim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iceh_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.define_iceh_dirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.define_iceh_dirs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.define_ispd_thresh_dir">
<span class="sig-name descname"><span class="pre">define_ispd_thresh_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D_zarr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ispd_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.define_ispd_thresh_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.define_ispd_thresh_dir" title="Link to this definition"></a></dt>
<dd><p>Define the output directory path for a given ice speed threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>D_zarr</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Base path to the parent Zarr directory. Defaults to <cite>self.D_zarr</cite>.</p></li>
<li><p><strong>ispd_thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – Ice speed threshold to be included in the subdirectory name. Defaults to <cite>self.ispd_thresh</cite>.</p></li>
<li><p><strong>Sets</strong></p></li>
<li><p><strong>----</strong></p></li>
<li><p><strong>self.D_ispd_thresh</strong> (<em>Path</em>) – Full path to the threshold-specific subdirectory, e.g., “ispd_thresh_5.0e-4”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.define_month_first_last_dates">
<span class="sig-name descname"><span class="pre">define_month_first_last_dates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year_month_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.define_month_first_last_dates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.define_month_first_last_dates" title="Link to this definition"></a></dt>
<dd><p>Given a ‘YYYY-MM’ string, return the first and last dates of that month.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>year_month_str</strong> (<em>str</em>) – Year and month string in ‘YYYY-MM’ format.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>First and last day of the month in ‘YYYY-MM-DD’ format.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.delete_original_cice">
<span class="sig-name descname"><span class="pre">delete_original_cice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_orgs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_iceh_zarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.delete_original_cice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.delete_original_cice" title="Link to this definition"></a></dt>
<dd><p>Delete the original daily NetCDF files for a given month if the monthly Zarr exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P_orgs</strong> (<em>list</em><em>[</em><em>pathlib.Path</em><em>]</em>) – Paths to the month’s daily <code class="docutils literal notranslate"><span class="pre">iceh.YYYY-MM-DD.nc</span></code> files.</p></li>
<li><p><strong>P_iceh_zarr</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – Path to the Zarr root (e.g., <code class="docutils literal notranslate"><span class="pre">.../iceh_daily.zarr</span></code>).</p></li>
<li><p><strong>m_str</strong> (<em>str</em>) – Month string in <code class="docutils literal notranslate"><span class="pre">YYYY-MM</span></code> used as the Zarr group name.</p></li>
<li><p><strong>Behavior</strong></p></li>
<li><p><strong>--------</strong></p></li>
<li><p><strong>exists</strong> (<em>If {P_iceh_zarr}/.zgroup</em>)</p></li>
<li><p><strong>each</strong> (<em>the method attempts to delete</em>)</p></li>
<li><p><strong>is</strong> (<em>file in P_orgs. Failures are logged with a warning. If the Zarr store</em>)</p></li>
<li><p><strong>.zgroup</strong><strong>)</strong> (<em>incomplete</em><em> (</em><em>no</em>)</p></li>
<li><p><strong>warning.</strong> (<em>deletion is skipped with a</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.dict_to_ds">
<span class="sig-name descname"><span class="pre">dict_to_ds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.dict_to_ds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.dict_to_ds" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.get_cice_files_between_dates">
<span class="sig-name descname"><span class="pre">get_cice_files_between_dates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D_iceh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.get_cice_files_between_dates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.get_cice_files_between_dates" title="Link to this definition"></a></dt>
<dd><p>List existing daily CICE iceh NetCDF files for a date range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>D_iceh</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – Directory containing daily files named <code class="docutils literal notranslate"><span class="pre">iceh.YYYY-MM-DD.nc</span></code>.</p></li>
<li><p><strong>dt0_str</strong> (<em>str</em>) – Inclusive date range in <code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span></code>.</p></li>
<li><p><strong>dtN_str</strong> (<em>str</em>) – Inclusive date range in <code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sorted list of existing files in the range. Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> and logs
an info message if none are found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[pathlib.Path] or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.get_dir_size">
<span class="sig-name descname"><span class="pre">get_dir_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.get_dir_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.get_dir_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.get_month_range">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_month_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year_month</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.get_month_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.get_month_range" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.get_static_grid">
<span class="sig-name descname"><span class="pre">get_static_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.get_static_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.get_static_grid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.help">
<span class="sig-name descname"><span class="pre">help</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.help"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.help" title="Link to this definition"></a></dt>
<dd><p>Print an overview of available methods grouped by module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.interpret_ice_speed_threshold">
<span class="sig-name descname"><span class="pre">interpret_ice_speed_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ispd_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-60</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.interpret_ice_speed_threshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.interpret_ice_speed_threshold" title="Link to this definition"></a></dt>
<dd><p>Translate the ice speed threshold into intuitive grid-scale metrics.</p>
<p>Computes:
- meters per day at the given speed,
- the <strong>median</strong> grid-cell edge length south of <cite>lat_thresh</cite> on the model</p>
<blockquote>
<div><p>grid (<cite>self.CICE_dict[‘P_G’]</cite>),</p>
</div></blockquote>
<ul class="simple">
<li><p>displacement as a fraction of a grid cell per day,</p></li>
<li><p>days required to traverse a grid cell at the threshold speed.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ispd_thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold in m/s. Defaults to <code class="docutils literal notranslate"><span class="pre">self.ispd_thresh</span></code>.</p></li>
<li><p><strong>lat_thresh</strong> (<em>float</em><em>, </em><em>default -60</em>) – Latitude (degrees) used to select the polar region for the median cell size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Summary metrics with keys:
<code class="docutils literal notranslate"><span class="pre">{'ice_speed_thresh_m_per_s',</span> <span class="pre">'displacement_m_per_day',</span>
<span class="pre">'median_grid_cell_length_m',</span> <span class="pre">'percent_displacement_per_day',</span>
<span class="pre">'days_per_grid_cell'}</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses CICE grid variables from <code class="docutils literal notranslate"><span class="pre">self.CICE_dict['P_G']</span></code> (radians) and</p></li>
</ul>
<p>converts to degrees for masking.
- Logs a human-readable summary via <cite>self.logger</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.load_cice_zarr">
<span class="sig-name descname"><span class="pre">load_cice_zarr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_alt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_hem</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.load_cice_zarr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.load_cice_zarr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.load_classified_ice">
<span class="sig-name descname"><span class="pre">load_classified_ice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roll_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ispd_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BorC2T_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_zarr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.load_classified_ice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.load_classified_ice" title="Link to this definition"></a></dt>
<dd><p>Load classified ice products (daily, binary-day, or rolling) from yearly Zarr groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sim_name</strong> (<em>str</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>bin_days</strong> (bool, default True; load <cite>_bin.zarr</cite> product; if False and <cite>roll_mean=True</cite>, load <cite>_roll.zarr</cite>; else load the daily product.)</p></li>
<li><p><strong>roll_mean</strong> (<em>bool</em><em>, </em><em>default False</em>)</p></li>
<li><p><strong>ispd_thresh</strong> (float, optional; threshold embedded in the Zarr path (defaults to <cite>self.ispd_thresh</cite>).)</p></li>
<li><p><strong>ice_type</strong> (<em>str</em><em>, </em><em>optional; either 'FI'</em><em>, </em><em>'PI'</em><em> or </em><em>'SI'</em>)</p></li>
<li><p><strong>BorC2T_type</strong> (<em>str</em><em>, </em><em>optional; either 'Ta'</em><em>, </em><em>'Tb'</em><em>, </em><em>'Tx'</em><em> or </em><em>'BT'</em><em> (</em><em>composite</em><em>)</em>)</p></li>
<li><p><strong>variables</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional; variable subset to select on open.</em>)</p></li>
<li><p><strong>dt0_str</strong> (<em>str</em><em>, </em><em>optional; start date</em>)</p></li>
<li><p><strong>dtN_str</strong> (<em>str</em><em>, </em><em>optional; end date</em>)</p></li>
<li><p><strong>D_zarr</strong> (<em>str</em><em> | </em><em>Path</em><em>, </em><em>optional; override base zarr directory.</em>)</p></li>
<li><p><strong>chunks</strong> (dict, optional; chunking to apply after concat (default <cite>self.CICE_dict[“FI_chunks”]</cite>).)</p></li>
<li><p><strong>persist</strong> (<em>bool</em><em>, </em><em>default False; dask-persist the concatenated dataset in memory.</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>xr.Dataset</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Drops duplicate <cite>ni</cite> coords per year before concatenation to avoid
index collisions along x (see <cite>_drop_duplicate_coords()</cite>).</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.monthly_zarr_iceh_time_correction">
<span class="sig-name descname"><span class="pre">monthly_zarr_iceh_time_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_mnthly_zarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dry_run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.monthly_zarr_iceh_time_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.monthly_zarr_iceh_time_correction" title="Link to this definition"></a></dt>
<dd><p>Fix the time coordinate in a monthly iceh zarr file by shifting all time entries back by 1 day.
This corrects for CICE’s 00:00:00 datestamp which represents daily averages for the <em>previous</em> day.
This method was done after a correction to daily_iceh_to_monthly_zarr() accounts for this timestamp
discrepancy and hence this method may quickly become outdated/unnecessary.</p>
<dl class="simple">
<dt>INPUTS:</dt><dd><p>P_mnthly_zarr : str or Path; path to the Zarr directory to correct (e.g., iceh_2011-05.zarr).
dry_run   : bool, optional; if True, do not write any files — only print what would be changed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.parse_simulation_metadata">
<span class="sig-name descname"><span class="pre">parse_simulation_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_recompile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.parse_simulation_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.parse_simulation_metadata" title="Link to this definition"></a></dt>
<dd><p>Parse or load simulation metadata for CICE AFIM runs.</p>
<p>If a cached JSON config file exists in the simulation directory and
<cite>force_recompile=False</cite>, this method will load and return the metadata from that file.
Otherwise, it will parse the <cite>ice_diag.d</cite> file and store the extracted parameters
in a structured JSON file for future use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>force_recompile</strong> (<em>bool</em>) – If True, re-parse the raw ice_diag.d file even if a cached JSON exists.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of extracted parameters including inferred grounded iceberg info.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.radians_to_degrees">
<span class="sig-name descname"><span class="pre">radians_to_degrees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.radians_to_degrees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.radians_to_degrees" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.setup_logging">
<span class="sig-name descname"><span class="pre">setup_logging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.setup_logging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.setup_logging" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.slice_hemisphere">
<span class="sig-name descname"><span class="pre">slice_hemisphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.slice_hemisphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.slice_hemisphere" title="Link to this definition"></a></dt>
<dd><p>Apply the configured hemisphere slice to a Dataset/DataArray (and corners).</p>
<p>Uses <cite>self.hemisphere_dict[‘nj_slice’]</cite> on the cell-centre row dimension
(e.g., <cite>nj</cite>). If a matching corner dimension is present (e.g., <cite>nj_b</cite>),
expands the stop bound by +1 to include the boundary row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> (<em>xr.Dataset</em><em> | </em><em>xr.DataArray</em><em> | </em><em>dict</em><em>[</em><em>str</em><em>, </em><em>xr.Dataset</em><em> | </em><em>xr.DataArray</em><em>]</em>) – Object(s) to slice. Dict values are sliced if their dims match.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sliced object of the same type as the input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset | xr.DataArray | dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Cell-centre dimension name is taken from <cite>self.CICE_dict[“y_dim”]</cite>.</p></li>
<li><p>Corner dim is assumed to be <cite>‘nj_b’</cite>. If you parameterise corners in
your config, adapt <cite>_indexers_for()</cite> accordingly.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.summary" title="Link to this definition"></a></dt>
<dd><p>Print a summary of key simulation setup and configuration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.vector_angle_diff">
<span class="sig-name descname"><span class="pre">vector_angle_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">um</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.vector_angle_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.vector_angle_diff" title="Link to this definition"></a></dt>
<dd><p>Compute the signed angular difference (in radians) between two vector fields.</p>
<p>This metric measures the angle by which the modelled vector differs from the observed vector.
The difference is returned as a signed value in the range [-π, π], where:
-  0    indicates perfect alignment,
- +pi/2 indicates model is rotated 90° counter-clockwise from observation,
- -pi/2 indicates 90° clockwise rotation,
- +/-pi indicates vectors are anti-parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uo</strong> (<em>xarray.DataArray</em>) – Components of the observed vector field (e.g., <cite>u</cite> and <cite>v</cite> velocity components), in m/s.</p></li>
<li><p><strong>vo</strong> (<em>xarray.DataArray</em>) – Components of the observed vector field (e.g., <cite>u</cite> and <cite>v</cite> velocity components), in m/s.</p></li>
<li><p><strong>um</strong> (<em>xarray.DataArray</em>) – Components of the modelled vector field (in m/s).</p></li>
<li><p><strong>vm</strong> (<em>xarray.DataArray</em>) – Components of the modelled vector field (in m/s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Signed angular difference (model - obs) in radians, bounded in [-pi, pi].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The angular difference is computed using <cite>arctan2</cite> on the vector components.</p></li>
<li><p>Use <cite>np.rad2deg()</cite> to convert output to degrees, if desired.</p></li>
<li><p>This metric is useful for directional error analysis in drift or flow fields.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.verify_month">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">verify_month</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args_tuple</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.verify_month"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.verify_month" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolbox.verify_zarr_and_cleanup_netcdf">
<span class="sig-name descname"><span class="pre">verify_zarr_and_cleanup_netcdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dry_run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolbox.verify_zarr_and_cleanup_netcdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolbox.verify_zarr_and_cleanup_netcdf" title="Link to this definition"></a></dt>
<dd><p>Verify monthly Zarr groups against expected daily NetCDFs and optionally delete NetCDFs.</p>
<p>The procedure scans <code class="docutils literal notranslate"><span class="pre">{self.D_zarr}/iceh_YYYY-MM.zarr</span></code> directories, and for
each month it checks:
1) that the Zarr <cite>time</cite> coordinate covers all expected daily dates;
2) that Zarr contains the union of variables present in the month’s</p>
<blockquote>
<div><p>remaining NetCDFs.</p>
</div></blockquote>
<p>A log of results is appended to <code class="docutils literal notranslate"><span class="pre">{self.D_sim}/cleanup.log</span></code>. When
<cite>delete=True</cite>, an interactive confirmation is prompted and, if accepted,
the verified month’s NetCDFs are removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dry_run</strong> (<em>bool</em><em>, </em><em>default True</em>) – If False, write a <code class="docutils literal notranslate"><span class="pre">.done_YYYY-MM</span></code> marker in the Zarr directory after
successful verification. When True, do not create markers.</p></li>
<li><p><strong>delete</strong> (<em>bool</em><em>, </em><em>default False</em>) – If True, prompt to delete verified NetCDFs after verification.</p></li>
<li><p><strong>max_workers</strong> (<em>int</em><em>, </em><em>default 4</em>) – Number of processes used for parallel month verification.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Writes to log and may delete files on user confirmation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Verification is parallelised with <code class="docutils literal notranslate"><span class="pre">ProcessPoolExecutor</span></code>.</p></li>
<li><p>Month logic expects Zarr directories named <code class="docutils literal notranslate"><span class="pre">iceh_YYYY-MM.zarr</span></code> and daily</p></li>
</ul>
<p>files at <code class="docutils literal notranslate"><span class="pre">{self.D_sim}/history/daily/iceh.YYYY-MM-DD.nc</span></code>.
- The verification routines are implemented as static helpers (<cite>get_month_range</cite>,
<cite>verify_month</cite>).</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolboxManager">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sea_ice_toolbox.</span></span><span class="sig-name descname"><span class="pre">SeaIceToolboxManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mem_lim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'16GB'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_dask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolboxManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolboxManager" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Lightweight factory for a shared Dask client and preconfigured <cite>SeaIceToolbox</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>P_log</strong> (<em>str</em><em> | </em><em>Path</em>) – Path to a log file to attach to the toolbox logger.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p><cite>get_shared_dask_client()</cite> creates a class-level client (cached) so multiple
toolboxes reuse the same cluster.</p></li>
<li><p><cite>get_toolbox(sim_name, **kwargs)</cite> returns a <cite>SeaIceToolbox</cite> bound to the
shared client and your log file.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sea_ice_toolbox.SeaIceToolbox" title="sea_ice_toolbox.SeaIceToolbox"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SeaIceToolbox</span></code></a></dt><dd><p>The main analysis class composed from SeaIce* modules.</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolboxManager.get_toolbox">
<span class="sig-name descname"><span class="pre">get_toolbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolboxManager.get_toolbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolboxManager.get_toolbox" title="Link to this definition"></a></dt>
<dd><p>This requires a simulation name and can pass any of the accepted agruments that SeaIceToolbox takes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_toolbox.SeaIceToolboxManager.shutdown">
<span class="sig-name descname"><span class="pre">shutdown</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_toolbox.html#SeaIceToolboxManager.shutdown"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_toolbox.SeaIceToolboxManager.shutdown" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sea_ice_gridwork">
<span id="sea-ice-gridwork"></span><h2>sea_ice_gridwork<a class="headerlink" href="#module-sea_ice_gridwork" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sea_ice_gridwork.</span></span><span class="sig-name descname"><span class="pre">SeaIceGridWork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.build_F2_GI_from_df">
<span class="sig-name descname"><span class="pre">build_F2_GI_from_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'simple-geometry'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'perimeter'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_area_m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_gi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_crs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'EPSG:3031'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_map_dist_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_cluster_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cluster_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_buffer_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_amplification</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'perim'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.build_F2_GI_from_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.build_F2_GI_from_df" title="Link to this definition"></a></dt>
<dd><p>Build grounded-iceberg (GI) contributions to F2 form factors on the CICE T-grid.</p>
<p>This method maps grounded iceberg locations (and optional size metrics) onto
the model T-grid and accumulates additional form-factor terms (F2x_gi, F2y_gi)
intended to represent sub-grid-scale coastal/obstacle form drag associated
with grounded icebergs.</p>
<p>Two approaches are supported:</p>
<p>1) method=”simple-geometry”
Each GI contributes an isotropic projected length scale Lproj normalised by
local grid metrics:</p>
<blockquote>
<div><p>F2x_gi += C_gi * (Lproj / dx)
F2y_gi += C_gi * (Lproj / dy)</p>
</div></blockquote>
<p>where Lproj is derived from either perimeter (preferred) or area.</p>
<p>2) method=”cluster-axis”
Nearby GI points are clustered (DBSCAN-like). Each cluster is represented
by an oriented ellipse/rectangle described by principal axes in projected
space. Cluster-aligned projected lengths are rotated into the local model
coordinate frame using the grid angle, and then distributed back to member
points with optional weighting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input table of GI features. Expected columns:
- lon, lat (degrees) and/or x_m, y_m (meters in <cite>proj_crs</cite>)
Optional columns:
- area_m2 : feature area in m^2
- perim_m : feature perimeter in m
- C_gi    : per-feature scaling coefficient</p></li>
<li><p><strong>method</strong> (<em>{&quot;simple-geometry&quot;</em><em>,</em><em>&quot;cluster-axis&quot;}</em><em>, </em><em>default=&quot;simple-geometry&quot;</em>) – Parameterisation for converting GI features into form factors.</p></li>
<li><p><strong>length_scale</strong> (<em>{&quot;perimeter&quot;</em><em>,</em><em>&quot;area&quot;}</em><em>, </em><em>default=&quot;perimeter&quot;</em>) – Length-scale basis for “simple-geometry”. If perimeter is unavailable,
falls back to area.</p></li>
<li><p><strong>base_area_m2</strong> (<em>float</em><em>, </em><em>optional</em>) – Default area used when df lacks area_m2. If None, uses median T-cell area.</p></li>
<li><p><strong>C_gi</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Default scaling coefficient applied when df lacks per-feature C_gi.</p></li>
<li><p><strong>proj_crs</strong> (<em>str</em><em>, </em><em>default=&quot;EPSG:3031&quot;</em>) – CRS for x/y mapping and clustering operations (meters).</p></li>
<li><p><strong>max_map_dist_km</strong> (<em>float</em><em>, </em><em>default=50.0</em>) – Maximum allowed distance between a GI point and its nearest T-cell center.
Features beyond this are dropped.</p></li>
<li><p><strong>eps_cluster_km</strong> (<em>float</em><em>, </em><em>default=15.0</em>) – Clustering neighborhood radius (km) for “cluster-axis”.</p></li>
<li><p><strong>min_cluster_size</strong> (<em>int</em><em>, </em><em>default=3</em>) – Minimum number of points required to form a cluster in “cluster-axis”.</p></li>
<li><p><strong>cluster_buffer_m</strong> (<em>float</em><em>, </em><em>optional</em>) – Buffer added to cluster axis lengths (meters). If None, defaults to an
equivalent-radius buffer derived from <cite>base_area_m2</cite>.</p></li>
<li><p><strong>cluster_amplification</strong> (<em>float</em><em>, </em><em>default=0.0</em>) – <dl class="simple">
<dt>Optional amplification factor for cluster lengths:</dt><dd><p>amp = 1 + cluster_amplification * log1p(n_cluster)</p>
</dd>
</dl>
<p>(applied to both principal axes).</p>
</p></li>
<li><p><strong>weight_by</strong> (<em>{&quot;equal&quot;</em><em>,</em><em>&quot;perim&quot;</em><em>,</em><em>&quot;area&quot;}</em><em>, </em><em>default=&quot;perim&quot;</em>) – Weighting used to distribute cluster-scale form factor back to member
points/cells. Falls back to equal weights when required metrics are missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>ds</strong> – Dataset containing:
- F2x_gi(nj,ni), F2y_gi(nj,ni) : float32, unitless
- gi_count(nj,ni) : int32 count of mapped GI features per cell
plus diagnostic vectors indexed by “ngi” (mapped features):
- gi_lon, gi_lat, gi_i, gi_j, gi_cluster_id, gi_map_dist_m,</p>
<blockquote>
<div><p>gi_area_m2, gi_perim_m</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>method</cite> is unsupported.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Grid metrics dx/dy are computed (and cached) via <cite>compute_tcell_dxdy_m</cite>.</p></li>
<li><p>Mapping is performed by nearest-neighbor search in projected space using</p></li>
</ul>
<p>a cached KDTree of T-cell centers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.build_F2_GI_from_gpkg">
<span class="sig-name descname"><span class="pre">build_F2_GI_from_gpkg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_gpkg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'grounded_icebergs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'simple-geometry'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'perimeter'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_gi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_crs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'EPSG:3031'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_map_dist_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dedup_uid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.build_F2_GI_from_gpkg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.build_F2_GI_from_gpkg" title="Link to this definition"></a></dt>
<dd><p>Convenience wrapper to build GI form factors directly from a GeoPackage.</p>
<p>This reads grounded iceberg polygons from a GeoPackage layer using
<cite>read_grounded_iceberg_gpkg</cite>, then delegates to <cite>build_F2_GI_from_df</cite> for
mapping and accumulation on the CICE T-grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P_gpkg</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – GeoPackage path.</p></li>
<li><p><strong>layer</strong> (<em>str</em><em>, </em><em>default=&quot;grounded_icebergs&quot;</em>) – Layer name containing GI features.</p></li>
<li><p><strong>method</strong> (<em>{&quot;simple-geometry&quot;</em><em>,</em><em>&quot;cluster-axis&quot;}</em><em>, </em><em>default=&quot;simple-geometry&quot;</em>) – GI form-factor parameterisation.</p></li>
<li><p><strong>length_scale</strong> (<em>{&quot;perimeter&quot;</em><em>,</em><em>&quot;area&quot;}</em><em>, </em><em>default=&quot;perimeter&quot;</em>) – Length-scale option forwarded to <cite>build_F2_GI_from_df</cite>.</p></li>
<li><p><strong>C_gi</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Default scaling coefficient forwarded to <cite>build_F2_GI_from_df</cite>.</p></li>
<li><p><strong>proj_crs</strong> (<em>str</em><em>, </em><em>default=&quot;EPSG:3031&quot;</em>) – CRS used for mapping/clustering.</p></li>
<li><p><strong>max_map_dist_km</strong> (<em>float</em><em>, </em><em>default=50.0</em>) – Maximum mapping distance threshold (km).</p></li>
<li><p><strong>dedup_uid</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to deduplicate GI features by UID prior to mapping.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments forwarded to <cite>build_F2_GI_from_df</cite> (e.g.,
clustering controls).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ds</strong> – Output dataset from <cite>build_F2_GI_from_df</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.build_F2_form_factors_from_high_res_coast">
<span class="sig-name descname"><span class="pre">build_F2_form_factors_from_high_res_coast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_shp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_crs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'EPSG:3031'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coast_write_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_subset_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">netcdf_compression</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_coastal_ocean_kdtree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coast_buffer_cells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_assign_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.build_F2_form_factors_from_high_res_coast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.build_F2_form_factors_from_high_res_coast" title="Link to this definition"></a></dt>
<dd><p>Compute Liu et al. (2022) coastal form factors (F2x, F2y) on the CICE T-grid
from a high-resolution polygon coastline.</p>
<dl class="simple">
<dt>The cell-based form factors (Liu et al. 2022, Eqs. 9–10) are computed as:</dt><dd><p>F2x(i,j) = Σ_n | l_n cos(θ_n) | / dx(i,j)
F2y(i,j) = Σ_n | l_n sin(θ_n) | / dy(i,j)</p>
</dd>
</dl>
<p>where each coastline segment n has geodesic length l_n (WGS84) and bearing
projected into the local model axes using:</p>
<blockquote>
<div><p>θ_n = α_n - anglet(i,j),</p>
</div></blockquote>
<p>with α_n the segment angle in Earth-referenced east-north coordinates and
anglet the local model grid rotation (radians).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P_shp</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the high-resolution coastline/land polygons. If None, uses
<cite>self.CICE_dict[“P_high_res_coast”]</cite>.</p></li>
<li><p><strong>P_grid</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the CICE grid file. If None, uses <cite>self.CICE_dict[“P_G”]</cite>.</p></li>
<li><p><strong>P_out</strong> (<em>str</em><em>, </em><em>optional</em>) – Output NetCDF path. If None, uses <cite>self.CICE_dict[“P_F2_coast”]</cite>.</p></li>
<li><p><strong>proj_crs</strong> (<em>str</em><em>, </em><em>default=&quot;EPSG:3031&quot;</em>) – Projected CRS used to assign each coastline segment midpoint to the
nearest T-cell via KDTree (meters).</p></li>
<li><p><strong>chunk_segments</strong> (<em>int</em><em>, </em><em>default=2_000_000</em>) – Process coastline segments in chunks to limit memory use.</p></li>
<li><p><strong>coast_write_stride</strong> (<em>int</em><em>, </em><em>default=25</em>) – Subsampling stride for storing coastline vertices in the output dataset
for provenance/plotting. Set &lt;=0 or None to disable.</p></li>
<li><p><strong>lat_subset_max</strong> (<em>float</em><em>, </em><em>default=-30.0</em>) – Only T-cells with latitude &lt;= this threshold are included in the KDTree
(a performance and relevance filter for Antarctic use).</p></li>
<li><p><strong>netcdf_compression</strong> (<em>int</em><em>, </em><em>default=4</em>) – NetCDF zlib compression level for output variables.</p></li>
<li><p><strong>use_coastal_ocean_kdtree</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True and an ocean mask can be inferred from the grid file, restrict the
KDTree to ocean cells within <cite>coast_buffer_cells</cite> of land (to avoid
mapping segments to interior ice-shelf/grounding-line regions).</p></li>
<li><p><strong>coast_buffer_cells</strong> (<em>int</em><em>, </em><em>default=1</em>) – Buffer (in grid cells) used to define the coastal-ocean band via binary
dilation of the land mask.</p></li>
<li><p><strong>max_assign_km</strong> (<em>float</em><em>, </em><em>default=50.0</em>) – Reject segment-to-cell assignments whose KDTree distance exceeds this
threshold (in km). Use None to disable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ds_out</strong> – Dataset containing:
- F2x(nj,ni), F2y(nj,ni) : float32, unitless
- lon(ncoast), lat(ncoast) : thinned coastline vertices (float32)
with provenance attributes describing inputs and settings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If required paths are not provided via arguments or configuration.</p></li>
<li><p><strong>RuntimeError</strong> – If no grid cells satisfy the latitude subset filter (likely units issue).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This computes the <em>cell-based</em> integrals (Liu f2^u and f2^v). Conversion to</p></li>
</ul>
<p>C-grid u/v points (Liu Eqs. 11–12) is intentionally deferred (e.g., Fortran).
- Segment lengths and azimuths are computed geodesically on WGS84 (pyproj.Geod).
- Nearest-cell assignment uses segment midpoints in the projected CRS.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.build_grid_corners">
<span class="sig-name descname"><span class="pre">build_grid_corners</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat_rads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_rads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_in_radians</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.build_grid_corners"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.build_grid_corners" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.build_grid_faces">
<span class="sig-name descname"><span class="pre">build_grid_faces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_in_radians</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.build_grid_faces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.build_grid_faces" title="Link to this definition"></a></dt>
<dd><p>Build C-grid geometry from <em>cell-centre</em> lon/lat arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> (<em>array-like</em>) – 2D arrays of cell-centre lon/lat, either in degrees or radians.
Shape (nj, ni).</p></li>
<li><p><strong>lat</strong> (<em>array-like</em>) – 2D arrays of cell-centre lon/lat, either in degrees or radians.
Shape (nj, ni).</p></li>
<li><p><strong>source_in_radians</strong> (<em>bool</em>) – If True, lon/lat are radians and will be converted to degrees.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>lon_b, lat_b</strong> (<em>ndarray</em>) – Corner coordinates, shape (nj+1, ni+1)</p></li>
<li><p><strong>lon_e, lat_e</strong> (<em>ndarray</em>) – Vertical face centres (E/W faces), shape (nj, ni+1)
(dims can be interpreted as (nj, ni_b))</p></li>
<li><p><strong>lon_n, lat_n</strong> (<em>ndarray</em>) – Horizontal face centres (N/S faces), shape (nj+1, ni)
(dims can be interpreted as (nj_b, ni))</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.compute_regular_grid_area">
<span class="sig-name descname"><span class="pre">compute_regular_grid_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.compute_regular_grid_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.compute_regular_grid_area" title="Link to this definition"></a></dt>
<dd><p>Compute cell areas (km^2) for a regular lat/lon grid (1D coords).</p>
<p>Assumes 1D, monotonically increasing latitude and longitude coordinates with
uniform longitudinal spacing. Uses spherical geometry to integrate the area
between latitude edges for each latitude band, broadcasting across longitudes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>da</strong> (<em>xr.DataArray</em>) – Any DataArray that carries 1D coordinates named <code class="docutils literal notranslate"><span class="pre">'lat'</span></code> and <code class="docutils literal notranslate"><span class="pre">'lon'</span></code>.
Values are not used; only the coordinates are read.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D area array with dims (<code class="docutils literal notranslate"><span class="pre">lat</span></code>, <code class="docutils literal notranslate"><span class="pre">lon</span></code>) in <strong>km²</strong>, aligned to the
provided coordinate vectors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Earth radius is fixed at 6,371,000 m.</p></li>
<li><p>For non-uniform lon spacing or curvilinear grids, use model grid areas</p></li>
</ul>
<p>(e.g., CICE <cite>tarea</cite>) rather than this helper.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.compute_tcell_dxdy_m">
<span class="sig-name descname"><span class="pre">compute_tcell_dxdy_m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.compute_tcell_dxdy_m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.compute_tcell_dxdy_m" title="Link to this definition"></a></dt>
<dd><p>Compute approximate T-cell metric lengths dx and dy (meters).</p>
<p>The method estimates T-cell sizes using distances between adjacent face-center
coordinates derived from grid corner/face metadata (self.G_e, self.G_n). Great-
circle (ellipsoidal) distances are computed on the WGS84 ellipsoid using
<cite>pyproj.Geod.inv</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, recompute dx/dy even if cached values exist.</p></li>
<li><p><strong>cache</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, store results in <cite>self._dxdy_cache</cite> and reuse on subsequent calls.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dx_m</strong> (<em>numpy.ndarray</em>) – Zonal metric length between adjacent vertical-face centers, shape (nj, ni),
in meters (float64).</p></li>
<li><p><strong>dy_m</strong> (<em>numpy.ndarray</em>) – Meridional metric length between adjacent horizontal-face centers, shape
(nj, ni), in meters (float64).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong> – If <cite>pyproj</cite> is not available.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Distances are returned as absolute values; non-finite or non-positive values</p></li>
</ul>
<p>are set to NaN.
- This is an approximate metric consistent with face-center spacing; it is
appropriate for normalising form-factor sums and related diagnostics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.load_cice_grid">
<span class="sig-name descname"><span class="pre">load_cice_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slice_hem</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_faces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.load_cice_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.load_cice_grid" title="Link to this definition"></a></dt>
<dd><p>Unified grid loader.</p>
<p>Sets class attributes (no return):
- self.G_t : t-grid dataset (centres + corners, mask, angle, area)
- self.G_u : legacy u-grid dataset (centres + corners, mask, angle, area)
- self.G_e : C-grid vertical-face coords derived from t-grid corners (lon_e/lat_e)
- self.G_n : C-grid horizontal-face coords derived from t-grid corners (lon_n/lat_n)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slice_hem</strong> (<em>bool</em>) – If True, applies self.slice_hemisphere() to all constructed grid datasets.</p></li>
<li><p><strong>build_faces</strong> (<em>bool</em>) – If True, compute C-grid face coordinate datasets (G_e, G_n).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.map_points_to_tgrid">
<span class="sig-name descname"><span class="pre">map_points_to_tgrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_crs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'EPSG:3031'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.map_points_to_tgrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.map_points_to_tgrid" title="Link to this definition"></a></dt>
<dd><p>Map geographic lon/lat points to the nearest CICE T-cell.</p>
<p>Points are projected into <cite>proj_crs</cite> and mapped to the nearest projected
T-cell center using a cached KDTree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon_deg</strong> (<em>array-like</em>) – Longitudes and latitudes in degrees (EPSG:4326).</p></li>
<li><p><strong>lat_deg</strong> (<em>array-like</em>) – Longitudes and latitudes in degrees (EPSG:4326).</p></li>
<li><p><strong>proj_crs</strong> (<em>str</em><em>, </em><em>default=&quot;EPSG:3031&quot;</em>) – Projected CRS used for KDTree search (meters).</p></li>
<li><p><strong>max_dist_km</strong> (<em>float</em><em>, </em><em>optional</em>) – If provided, points farther than this distance (km) from the nearest
T-cell center are flagged invalid.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ii</strong> (<em>numpy.ndarray</em>) – Nearest-cell i indices (int64).</p></li>
<li><p><strong>jj</strong> (<em>numpy.ndarray</em>) – Nearest-cell j indices (int64).</p></li>
<li><p><strong>dist_m</strong> (<em>numpy.ndarray</em>) – Distance (meters) from each point to the nearest T-cell center.</p></li>
<li><p><strong>valid</strong> (<em>numpy.ndarray</em>) – Boolean mask indicating finite distances and (if provided) max_dist_km
compliance.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Requires <cite>self.G_t</cite> to be loaded; if absent, <cite>load_cice_grid</cite> is called.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.map_xy_to_tgrid">
<span class="sig-name descname"><span class="pre">map_xy_to_tgrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_crs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'EPSG:3031'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.map_xy_to_tgrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.map_xy_to_tgrid" title="Link to this definition"></a></dt>
<dd><p>Map projected x/y points to the nearest CICE T-cell using a cached KDTree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_m</strong> (<em>array-like</em>) – Point coordinates in meters in the CRS specified by <cite>proj_crs</cite>.</p></li>
<li><p><strong>y_m</strong> (<em>array-like</em>) – Point coordinates in meters in the CRS specified by <cite>proj_crs</cite>.</p></li>
<li><p><strong>proj_crs</strong> (<em>str</em><em>, </em><em>default=&quot;EPSG:3031&quot;</em>) – CRS of input x/y coordinates. Must match the CRS used to build the KDTree.</p></li>
<li><p><strong>max_dist_km</strong> (<em>float</em><em>, </em><em>optional</em>) – If provided, points farther than this distance (km) from the nearest
T-cell center are flagged invalid.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ii</strong> (<em>numpy.ndarray</em>) – Nearest-cell i indices (int64).</p></li>
<li><p><strong>jj</strong> (<em>numpy.ndarray</em>) – Nearest-cell j indices (int64).</p></li>
<li><p><strong>dist_m</strong> (<em>numpy.ndarray</em>) – Distance (meters) from each point to the nearest T-cell center.</p></li>
<li><p><strong>valid</strong> (<em>numpy.ndarray</em>) – Boolean mask indicating finite distances and (if provided) max_dist_km
compliance.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Requires <cite>self.G_t</cite> to be loaded; if not present, <cite>load_cice_grid</cite> is called
with <cite>build_faces=True</cite> to ensure consistent grid metadata.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.normalise_longitudes">
<span class="sig-name descname"><span class="pre">normalise_longitudes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0-360'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.normalise_longitudes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.normalise_longitudes" title="Link to this definition"></a></dt>
<dd><p>Wrap longitudes to either [0, 360) or (-180, 180].
Works with numpy arrays, scalars, and xarray objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.read_grounded_iceberg_csv">
<span class="sig-name descname"><span class="pre">read_grounded_iceberg_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_csv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalise_lon_to</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0-360'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.read_grounded_iceberg_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.read_grounded_iceberg_csv" title="Link to this definition"></a></dt>
<dd><p>Read a grounded-iceberg (GI) point CSV and standardise columns.</p>
<p>The CSV must contain longitude and latitude columns (degrees). Optional
columns are preserved when present (e.g., area_m2, C_gi, orient_deg, t_start,
t_end). Longitudes are normalised to the chosen convention.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P_csv</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – Path to the CSV file.</p></li>
<li><p><strong>lon_col</strong> (<em>str</em><em>, </em><em>default=&quot;lon&quot;</em>) – Name of the longitude column in the CSV.</p></li>
<li><p><strong>lat_col</strong> (<em>str</em><em>, </em><em>default=&quot;lat&quot;</em>) – Name of the latitude column in the CSV.</p></li>
<li><p><strong>normalise_lon_to</strong> (<em>{&quot;0-360&quot;</em><em>,</em><em>&quot;-180-180&quot;}</em><em>, </em><em>default=&quot;0-360&quot;</em>) – Longitude convention applied after reading.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>df</strong> – DataFrame with at least columns:
- lon : float (degrees)
- lat : float (degrees)
and any recognised optional columns preserved.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If required columns are missing.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Rows with missing or non-numeric lon/lat are dropped. Latitudes are bounded
to [-90, 90] as a basic sanity check.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.read_grounded_iceberg_gpkg">
<span class="sig-name descname"><span class="pre">read_grounded_iceberg_gpkg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_gpkg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'grounded_icebergs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dedup_uid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uid_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Global_UID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Easting_3031'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Northing_3031'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Longitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Latitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_km2_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Area_Mean_km2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_attr_area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalise_lon_to</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0-360'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.read_grounded_iceberg_gpkg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.read_grounded_iceberg_gpkg" title="Link to this definition"></a></dt>
<dd><p>Read a grounded-iceberg polygon GeoPackage and derive mapping-ready attributes.</p>
<p>The GeoPackage is expected to contain grounded iceberg polygons (typically in
EPSG:3031). This method computes perimeter and area from geometry, optionally
prefers an attribute-provided mean area (e.g., Area_Mean_km2), and returns a
tabular representation suitable for mapping to the model grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P_gpkg</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – Path to the GeoPackage.</p></li>
<li><p><strong>layer</strong> (<em>str</em><em>, </em><em>default=&quot;grounded_icebergs&quot;</em>) – Layer name to read.</p></li>
<li><p><strong>dedup_uid</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, aggregate multiple detections sharing <cite>uid_col</cite> into one record
(mean position; median size metrics).</p></li>
<li><p><strong>uid_col</strong> (<em>str</em><em>, </em><em>default=&quot;Global_UID&quot;</em>) – Unique identifier column for deduplication.</p></li>
<li><p><strong>x_col</strong> (<em>str</em>) – Column names containing projected coordinates in EPSG:3031 meters.</p></li>
<li><p><strong>y_col</strong> (<em>str</em>) – Column names containing projected coordinates in EPSG:3031 meters.</p></li>
<li><p><strong>lon_col</strong> (<em>str</em>) – Optional geographic lon/lat columns (degrees) for metadata/debug.</p></li>
<li><p><strong>lat_col</strong> (<em>str</em>) – Optional geographic lon/lat columns (degrees) for metadata/debug.</p></li>
<li><p><strong>area_km2_col</strong> (<em>str</em><em>, </em><em>default=&quot;Area_Mean_km2&quot;</em>) – Attribute column containing mean iceberg area in km^2.</p></li>
<li><p><strong>use_attr_area</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True and <cite>area_km2_col</cite> exists, use it (falling back to geometry area
when missing/invalid). If False, use geometry area only.</p></li>
<li><p><strong>normalise_lon_to</strong> (<em>{&quot;0-360&quot;</em><em>,</em><em>&quot;-180-180&quot;}</em><em>, </em><em>default=&quot;0-360&quot;</em>) – Longitude convention applied to the lon column (if present).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>df</strong> – Table with columns:
- uid, x_m, y_m, lon, lat
- area_m2, perim_m
- bed_depth (if present), plus additional metadata columns when available</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Rows without finite x/y coordinates are dropped. Perimeter and geometry area
are computed in the native CRS units (meters for EPSG:3031).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.reapply_landmask">
<span class="sig-name descname"><span class="pre">reapply_landmask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_unmodified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.reapply_landmask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.reapply_landmask" title="Link to this definition"></a></dt>
<dd><p>Apply landmask to all spatial variables in the dataset.</p>
<p>Uses the modified bathymetry (<cite>kmt_mod</cite>) field from the model grid to mask out land cells.
Applies this mask to all variables with dimensions <cite>(“nj”, “ni”)</cite>, ensuring that land areas
are excluded from any subsequent analysis or output.</p>
<dl class="simple">
<dt>INPUTS:</dt><dd><p>DS : xarray.Dataset; Dataset containing sea ice fields to be masked.</p>
</dd>
<dt>OUTPUTS:</dt><dd><p>xarray.Dataset; Same dataset with land cells set to NaN for spatial variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_gridwork.SeaIceGridWork.write_F2_with_GI">
<span class="sig-name descname"><span class="pre">write_F2_with_GI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_F2_coast</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_GI</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_GI_CSV</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'simple-geometry'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_area_m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_gi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_cluster_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cluster_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_buffer_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_amplification</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'perim'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'perimeter'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dedup_uid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_gridwork.html#SeaIceGridWork.write_F2_with_GI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_gridwork.SeaIceGridWork.write_F2_with_GI" title="Link to this definition"></a></dt>
<dd><p>Combine coast-only F2 form factors with grounded-iceberg (GI) contributions
and write a new NetCDF.</p>
<p>This method loads an existing coastline-derived F2 file (containing <cite>F2x</cite> and
<cite>F2y</cite>), computes GI contributions from either:
- a CSV of GI points (.csv), or
- a GeoPackage of GI polygons (.gpkg),
then writes a combined dataset containing:
- total:     F2x, F2y
- components F2x_coast, F2y_coast, F2x_gi, F2y_gi
plus any available coastline vertex vectors and GI diagnostic vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P_F2_coast</strong> (<em>str</em><em>, </em><em>optional</em>) – Input coast-only F2 NetCDF path. If None, uses <cite>self.CICE_dict[“P_F2_coast”]</cite>.</p></li>
<li><p><strong>P_GI</strong> (<em>str</em><em>, </em><em>optional</em>) – Grounded iceberg input path. Supported extensions are “.csv” and “.gpkg”.
If None, falls back to <cite>P_GI_CSV</cite> (legacy) or <cite>self.GI_dict.get(“P_KJ”)</cite>.</p></li>
<li><p><strong>P_GI_CSV</strong> (<em>str</em><em>, </em><em>optional</em>) – Legacy CSV input path (kept for backward compatibility). Ignored if <cite>P_GI</cite>
is provided.</p></li>
<li><p><strong>P_out</strong> (<em>str</em><em>, </em><em>optional</em>) – Output NetCDF path. If None, uses <cite>self.CICE_dict[“P_F2_GI”]</cite>.</p></li>
<li><p><strong>method</strong> (<em>{&quot;simple-geometry&quot;</em><em>,</em><em>&quot;cluster-axis&quot;}</em><em>, </em><em>default=&quot;simple-geometry&quot;</em>) – GI parameterisation used when constructing GI form factors.</p></li>
<li><p><strong>base_area_m2</strong> (<em>float</em><em>, </em><em>optional</em>) – Default area used when GI input lacks feature area. Passed through to GI
builders where supported.</p></li>
<li><p><strong>C_gi</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Default GI scaling coefficient.</p></li>
<li><p><strong>eps_cluster_km</strong> (<em>float</em><em>, </em><em>default=15.0</em>) – Clustering radius (km) used for “cluster-axis” GI method.</p></li>
<li><p><strong>min_cluster_size</strong> (<em>int</em><em>, </em><em>default=3</em>) – Minimum cluster size used for “cluster-axis”.</p></li>
<li><p><strong>cluster_buffer_m</strong> (<em>float</em><em>, </em><em>optional</em>) – Buffer added to derived cluster axis lengths (meters).</p></li>
<li><p><strong>cluster_amplification</strong> (<em>float</em><em>, </em><em>default=0.0</em>) – Optional amplification of cluster axis lengths as a function of cluster size.</p></li>
<li><p><strong>length_scale</strong> (<em>{&quot;perimeter&quot;</em><em>,</em><em>&quot;area&quot;}</em><em>, </em><em>default=&quot;perimeter&quot;</em>) – Length-scale selection for the GI “simple-geometry” method.</p></li>
<li><p><strong>dedup_uid</strong> (<em>bool</em><em>, </em><em>default=True</em>) – For GeoPackage inputs, whether to deduplicate features by UID prior to mapping.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If False and <cite>P_out</cite> exists, raise FileExistsError. If True, overwrite.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ds_out</strong> – Combined dataset written to disk.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If required inputs are missing or GI file type is unsupported.</p></li>
<li><p><strong>FileExistsError</strong> – If <cite>overwrite=False</cite> and output path already exists.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Dim ordering is aligned to the coast file. GI arrays are transposed if needed
to match the coast file (typically (nj, ni)).</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sea_ice_classification">
<span id="sea-ice-classification"></span><h2>sea_ice_classification<a class="headerlink" href="#module-sea_ice_classification" title="Link to this heading"></a></h2>
<section id="seaiceclassification">
<h3>SeaIceClassification<a class="headerlink" href="#seaiceclassification" title="Link to this heading"></a></h3>
<p>Class utilities for classifying Antarctic fast ice using sea-ice concentration
(<cite>aice</cite>) and speed thresholds on multiple grids:</p>
<ul class="simple">
<li><p>B  : native CICE B-grid (cell centers) magnitude computed from (uvel, vvel)</p></li>
<li><p>Ta : 2×2 B-grid box average (area-like) magnitude</p></li>
<li><p>Tb : 2×2 B-grid box average (grid-like) magnitude</p></li>
<li><p>Tx : B-grid regridded to T-grid magnitude via precomputed weights</p></li>
</ul>
<section id="high-level-api">
<h4>High-level API<a class="headerlink" href="#high-level-api" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>classify_fast_ice(…): end-to-end daily fast-ice mask, binary-day mask, and
optional rolling-mean variant.</p></li>
<li><p>classify_binary_days_fast_ice(…): “persistence” classification over a sliding
window (N days) requiring ≥M fast-ice days within the window.</p></li>
</ul>
</section>
<section id="assumptions-required-attributes">
<h4>Assumptions / required attributes<a class="headerlink" href="#assumptions-required-attributes" title="Link to this heading"></a></h4>
<p>Before calling the high-level methods, the following attributes/methods must exist:</p>
<p>Attributes (populated externally or via your toolbox manager):
- self.CICE_dict: dict with keys</p>
<blockquote>
<div><p>“y_dim_length”, “x_dim_length”, “time_dim”, “FI_chunks”,
“spatial_dims”, “drop_coords”</p>
</div></blockquote>
<ul class="simple">
<li><p>self.icon_thresh: float   (sea-ice concentration threshold, e.g., 0.15)</p></li>
<li><p>self.ispd_thresh: float   (speed threshold for fast ice, e.g., 1e-4 m/s)</p></li>
<li><p>self.bin_win_days: int    (persistence window length, e.g., 31)</p></li>
<li><p>self.bin_min_days: int    (min fast-ice count in window, e.g., 16)</p></li>
<li><p>self.mean_period: int     (rolling mean length in days)</p></li>
<li><p>self.BorC2T_type: some combination of {“B”,”C”,”Ta”,”Tb”,”Tc”,”Tx”} to average into composite</p></li>
<li><p>self.G_t, self.G_u: dicts providing T- and U-grid lon/lat arrays</p></li>
<li><p>self.dt_range: pandas.DatetimeIndex used by np3d_to_xr3d</p></li>
</ul>
<p>Methods (provided elsewhere in your stack):
- self.load_cice_grid()
- self.define_reG_weights()
- self.load_cice_zarr(…)
- self.slice_hemisphere(xr.DataArray/xr.Dataset)
- self.define_datetime_vars(dt0_str, dtN_str)
- self.reG(xr.DataArray)   (B→T regridding using precomputed weights)</p>
</section>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sea_ice_classification.</span></span><span class="sig-name descname"><span class="pre">SeaIceClassification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Classify fast ice from CICE outputs using concentration and speed thresholds,
with support for daily, persistence (binary-day), and rolling-mean variants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sim_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name/identifier of the simulation (used for logs/paths).</p></li>
<li><p><strong>logger</strong> (<em>logging.Logger</em><em>, </em><em>optional</em>) – Logger instance. If None, uses a module-level logger.</p></li>
<li><p><strong>**kwargs</strong> – Arbitrary configuration attributes set directly on <cite>self</cite>. Common keys
include thresholds, window lengths, and dictionaries noted in the module
docstring.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul>
<li><dl class="simple">
<dt>The “daily” fast-ice mask is defined where:</dt><dd><p>(aice &gt; icon_thresh) AND (0 &lt; ispd &lt;= ispd_thresh)</p>
</dd>
</dl>
<p>after composing <cite>ispd</cite> from one or more of {B, Ta, Tb, Tx}.</p>
</li>
<li><p>The binary-day mask applies a centered sliding window that marks a day as
“persistent fast ice” if at least <cite>bin_min_days</cite> within <cite>bin_win_days</cite> are
fast-ice days.</p></li>
<li><p>Several operations use Dask via <cite>xr.apply_ufunc(…, dask=”parallelized”)</cite>,
but key intermediates are explicitly <cite>.compute()</cite>’d for determinism. Ensure
available memory/cluster config is appropriate for your domain size.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.B2Ta">
<span class="sig-name descname"><span class="pre">B2Ta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_len</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.B2Ta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.B2Ta" title="Link to this definition"></a></dt>
<dd><p>Compute T-cell speed magnitude by B-&gt;T averaging (method A) of u and v.</p>
<p>This routine:
1) Averages corner-staggered u and v to T-cell centers using <cite>Bavg_methA</cite>.
2) Computes speed magnitude: sqrt(uT^2 + vT^2).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uB</strong> (<em>numpy.ndarray</em>) – Corner-staggered velocity components with shape (time, y, x).</p></li>
<li><p><strong>vB</strong> (<em>numpy.ndarray</em>) – Corner-staggered velocity components with shape (time, y, x).</p></li>
<li><p><strong>y_len</strong> (<em>int</em>) – Target T-grid spatial dimensions.</p></li>
<li><p><strong>x_len</strong> (<em>int</em>) – Target T-grid spatial dimensions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sT</strong> – T-centered speed magnitude with shape (time, y_len, x_len).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Because <cite>Bavg_methA</cite> propagates NaNs, this speed product will also be NaN
where any of the contributing corners are NaN.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.B2Tb">
<span class="sig-name descname"><span class="pre">B2Tb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.B2Tb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.B2Tb" title="Link to this definition"></a></dt>
<dd><p>Compute T-cell speed magnitude by B-&gt;T averaging (method B) of u and v.</p>
<p>This routine:
1) Averages corner-staggered u and v to T-cell centers using <cite>Bavg_methB</cite></p>
<blockquote>
<div><p>(NaNs treated as 0.0 to enforce no-slip at masked corners).</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Computes speed magnitude: sqrt(uT^2 + vT^2).</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uB</strong> (<em>numpy.ndarray</em>) – Corner-staggered velocity components with shape (time, y, x).</p></li>
<li><p><strong>vB</strong> (<em>numpy.ndarray</em>) – Corner-staggered velocity components with shape (time, y, x).</p></li>
<li><p><strong>y_len</strong> (<em>int</em>) – Target T-grid spatial dimensions.</p></li>
<li><p><strong>x_len</strong> (<em>int</em>) – Target T-grid spatial dimensions.</p></li>
<li><p><strong>wrap_x</strong> (<em>bool</em>) – Whether to wrap the x-direction cyclically during averaging.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sT</strong> – T-centered speed magnitude with shape (time, y_len, x_len).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method is typically more robust near land masks because NaNs are treated
as 0.0 prior to averaging.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.B2Tx">
<span class="sig-name descname"><span class="pre">B2Tx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uB_da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vB_da</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.B2Tx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.B2Tx" title="Link to this definition"></a></dt>
<dd><p>Regrid B-grid velocity components to T points via xESMF and compute speed.</p>
<p>This method uses a pre-defined regridder <cite>self.reG</cite> (constructed by
<cite>define_reG_weights</cite> / <cite>_ensure_reG_defined</cite>) to map B-grid corner fields onto
the T-grid. Prior to regridding, NaNs are replaced by 0.0 to enforce a
no-slip-style boundary condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uB_da</strong> (<em>xarray.DataArray</em>) – Corner-staggered velocity components. Must be compatible with the
configured xESMF regridder. Typically dims are (time, y, x) or similar.</p></li>
<li><p><strong>vB_da</strong> (<em>xarray.DataArray</em>) – Corner-staggered velocity components. Must be compatible with the
configured xESMF regridder. Typically dims are (time, y, x) or similar.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ispd_Tx</strong> – T-grid speed magnitude computed as hypot(uT, vT), dtype float32. Uses
<cite>xr.apply_ufunc(…, dask=”parallelized”)</cite> for Dask compatibility.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This is distinct from the simple 2x2 averaging methods (<cite>B2Ta</cite>, <cite>B2Tb</cite>);</p></li>
</ul>
<p>it uses spatial regridding (often bilinear) and may yield smoother fields.
- Because NaNs are converted to 0.0, masked/corner land values do not
propagate into neighbouring T cells in the same way as NaN-preserving
averages.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.Bavg_methA">
<span class="sig-name descname"><span class="pre">Bavg_methA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B_component</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_len</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.Bavg_methA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.Bavg_methA" title="Link to this definition"></a></dt>
<dd><p>Average a corner-staggered (B-grid) field onto T-cell centers via a 2x2 mean.</p>
<p>This method computes the simple arithmetic mean of the four corner values
surrounding each T-cell:</p>
<blockquote>
<div><p>avg = (v00 + v01 + v10 + v11) / 4</p>
</div></blockquote>
<p>It then pads the result back to the target T-grid shape and optionally
wraps the x-direction by copying the first column into the last column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>B_component</strong> (<em>numpy.ndarray</em>) – Corner-staggered field with shape (time, y, x). Typically a velocity
component (u or v) on B-grid corners.</p></li>
<li><p><strong>y_len</strong> (<em>int</em>) – Target T-grid y dimension length. (Note: current implementation reads
<cite>self.CICE_dict[“y_dim_length”]</cite> and ignores the passed value.)</p></li>
<li><p><strong>x_len</strong> (<em>int</em>) – Target T-grid x dimension length. (Note: current implementation reads
<cite>self.CICE_dict[“x_dim_length”]</cite> and ignores the passed value.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>avg_T</strong> – T-centered field with shape (time, y_len, x_len). Padding is filled with
NaN. dtype is unchanged until returned (typically float).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This method does not apply a no-slip treatment: NaNs in the input propagate</p></li>
</ul>
<p>into the 2x2 average.
- X wrapping is implemented by setting the last x column equal to the first,
which is appropriate for cyclic/periodic global grids.
- If the input has insufficient halo/extent for the 2x2 operation, the output
will contain NaNs introduced by padding.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.Bavg_methB">
<span class="sig-name descname"><span class="pre">Bavg_methB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.Bavg_methB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.Bavg_methB" title="Link to this definition"></a></dt>
<dd><p>Average a corner-staggered (B-grid) field onto T-cell centers using a 2x2 mean
with no-slip handling at land corners (NaNs treated as zero).</p>
<p>The method forms the mean of the four corner values surrounding each T-cell,
but first converts NaNs to 0.0 to enforce a no-slip-style boundary at masked
corners:</p>
<blockquote>
<div><p>out = 0.25 * (nan_to_num(v00) + nan_to_num(v01) + nan_to_num(v10) + nan_to_num(v11))</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>B_component</strong> (<em>array-like</em>) – Corner-staggered field with shape (time, y, x), e.g., uvel or vvel on a
CICE B-grid.</p></li>
<li><p><strong>y_len</strong> (<em>int</em>) – Target T-grid y dimension length.</p></li>
<li><p><strong>x_len</strong> (<em>int</em>) – Target T-grid x dimension length.</p></li>
<li><p><strong>wrap_x</strong> (<em>bool</em>) – If True, enforce cyclic boundary in x by copying the first column to the
last column after padding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_T</strong> – T-centered field with shape (time, y_len, x_len), dtype float32.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>NaN-to-zero treatment is intentional and corresponds to a no-slip behaviour</p></li>
</ul>
<p>at land/corner masks; this differs from <cite>Bavg_methA</cite>, where NaNs propagate.
- Padding (if needed) is filled with NaN after averaging.
- For cyclic grids, the wrap is applied after padding and before trimming.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.C2T">
<span class="sig-name descname"><span class="pre">C2T</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uvelE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvelN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vvelE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vvelN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_to_zero</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.C2T"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.C2T" title="Link to this definition"></a></dt>
<dd><p>Reconstruct T-grid east/north velocity components from C-grid edge fields.</p>
<p>Inputs are assumed to be <em>physical</em> components in the local east/north basis:
- uvelE, uvelN: (E,N) components defined on the U-stagger (x-faces)
- vvelE, vvelN: (E,N) components defined on the V-stagger (y-faces)</p>
<p>The mapping is performed by edge-to-center averaging:
- U-stagger → T via direction=”x”
- V-stagger → T via direction=”y”</p>
<p>Then the two estimates are combined to produce a single (E,N) pair at T.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uvelE</strong> (<em>xarray.DataArray</em><em> or </em><em>array-like</em>) – C-grid velocity components on the U and V staggers.</p></li>
<li><p><strong>uvelN</strong> (<em>xarray.DataArray</em><em> or </em><em>array-like</em>) – C-grid velocity components on the U and V staggers.</p></li>
<li><p><strong>vvelE</strong> (<em>xarray.DataArray</em><em> or </em><em>array-like</em>) – C-grid velocity components on the U and V staggers.</p></li>
<li><p><strong>vvelN</strong> (<em>xarray.DataArray</em><em> or </em><em>array-like</em>) – C-grid velocity components on the U and V staggers.</p></li>
<li><p><strong>y_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Target T-grid spatial sizes. Defaults to <cite>self.CICE_dict[“*_dim_length”]</cite>.</p></li>
<li><p><strong>x_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Target T-grid spatial sizes. Defaults to <cite>self.CICE_dict[“*_dim_length”]</cite>.</p></li>
<li><p><strong>wrap_x</strong> (<em>bool</em><em>, </em><em>optional</em>) – Seam handling in x. Defaults to <cite>self.CICE_dict.get(“wrap_x”, True)</cite>.</p></li>
<li><p><strong>combine</strong> (<em>{&quot;mean&quot;</em><em>,</em><em>&quot;uv&quot;}</em><em>, </em><em>default &quot;mean&quot;</em>) – How to combine U- and V-stagger estimates at T:
- “mean”: E_T = 0.5*(E_from_U + E_from_V), N_T = 0.5*(N_from_U + N_from_V)
- “uv”  : E_T = E_from_U, N_T = N_from_V (classic C-grid intuition)</p></li>
<li><p><strong>nan_to_zero</strong> (<em>bool</em><em>, </em><em>default True</em>) – If True, treat NaNs as 0 prior to averaging (no-slip-like).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>velE_T, velN_T</strong> – Eastward and northward velocity components at T-cell centers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>same type as inputs</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you only need speed, you can compute <cite>hypot(velE_T, velN_T)</cite> downstream
using <cite>xr.apply_ufunc(np.hypot, …)</cite> for Dask-parallel execution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.Cavg_meth">
<span class="sig-name descname"><span class="pre">Cavg_meth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_to_zero</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.Cavg_meth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.Cavg_meth" title="Link to this definition"></a></dt>
<dd><p>Average a C-grid edge-centered field onto T-cell centers.</p>
<p>This is the C-grid analogue of your B-grid corner-to-center averaging, but uses
a 1D average along the staggered direction:</p>
<ul class="simple">
<li><p>direction=”x”: average along x (typical for U-grid / east-west faces)</p></li>
<li><p>direction=”y”: average along y (typical for V-grid / north-south faces)</p></li>
</ul>
<p>Supports both xarray.DataArray (Dask-friendly) and NumPy arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C_component</strong> (<em>xarray.DataArray</em><em> or </em><em>array-like</em>) – C-grid edge-centered field. Expected to have time as the first dimension
and the last two dims as (y, x) in some order consistent with typical CICE
output. For xarray input, dims are inferred from the last two dims.</p></li>
<li><p><strong>direction</strong> (<em>{&quot;x&quot;</em><em>,</em><em>&quot;y&quot;}</em>) – Stagger direction to average over:
- “x”: average adjacent points in x to map U-grid → T-grid
- “y”: average adjacent points in y to map V-grid → T-grid</p></li>
<li><p><strong>y_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Target T-grid spatial sizes. Defaults to <cite>self.CICE_dict[“y_dim_length”]</cite>
and <cite>self.CICE_dict[“x_dim_length”]</cite>.</p></li>
<li><p><strong>x_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Target T-grid spatial sizes. Defaults to <cite>self.CICE_dict[“y_dim_length”]</cite>
and <cite>self.CICE_dict[“x_dim_length”]</cite>.</p></li>
<li><p><strong>wrap_x</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to enforce cyclic wrap in the x-direction (seam handling). Defaults
to <cite>self.CICE_dict.get(“wrap_x”, True)</cite>.</p></li>
<li><p><strong>nan_to_zero</strong> (<em>bool</em><em>, </em><em>default True</em>) – If True, treat NaNs as 0.0 before averaging (no-slip-like treatment near
land/masks). If False, NaNs propagate into the average.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_T</strong> – T-centered field with shape (time, y_len, x_len), float32 for NumPy input.
For xarray input, coords/dims are preserved as much as possible.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>same type as input</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Size handling:
- If the staggered dimension has length (target+1), a straightforward adjacent
slice-average is used and yields the target length.
- If it has length (target), we average using roll/shift:</p>
<blockquote>
<div><ul class="simple">
<li><p>wrap_x=True uses roll (periodic)</p></li>
<li><p>wrap_x=False uses shift (non-periodic; last column becomes NaN)</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.classify_binary_days_fast_ice">
<span class="sig-name descname"><span class="pre">classify_binary_days_fast_ice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FI_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_win_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_min_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centered</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.classify_binary_days_fast_ice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.classify_binary_days_fast_ice" title="Link to this definition"></a></dt>
<dd><p>Backward-compatible wrapper: binary-day persistence for fast-ice masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>FI_mask</strong> (<em>xarray.DataArray</em>) – Input fast-ice mask (boolean or 0/1) with dimensions (time, y, x).</p></li>
<li><p><strong>bin_win_days</strong> (<em>int</em><em>, </em><em>optional</em>) – Window length and minimum count passed to <cite>classify_binary_days_mask</cite>.</p></li>
<li><p><strong>bin_min_days</strong> (<em>int</em><em>, </em><em>optional</em>) – Window length and minimum count passed to <cite>classify_binary_days_mask</cite>.</p></li>
<li><p><strong>time_dim</strong> (<em>str</em><em>, </em><em>optional</em>) – Time dimension name passed to <cite>classify_binary_days_mask</cite>.</p></li>
<li><p><strong>centered</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Center the rolling window.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset containing a uint8 variable named “FI_mask”.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.classify_binary_days_mask">
<span class="sig-name descname"><span class="pre">classify_binary_days_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_win_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_min_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centered</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.classify_binary_days_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.classify_binary_days_mask" title="Link to this definition"></a></dt>
<dd><p>Compute a generic binary-day persistence mask using xarray rolling counts.</p>
<p>In each rolling window of length W, the mask is set to 1 if at least M days
are True/1 within that window:</p>
<blockquote>
<div><p>mask_bin(t) = 1 if sum(mask[t-window]) &gt;= M else 0</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I_mask</strong> (<em>xarray.DataArray</em>) – Input boolean or 0/1 mask with dimensions (time, y, x).</p></li>
<li><p><strong>mask_name</strong> (<em>str</em>) – Name of the output variable (e.g., “FI_mask”, “PI_mask”).</p></li>
<li><p><strong>bin_win_days</strong> (<em>int</em><em>, </em><em>optional</em>) – Window length W. Defaults to <cite>self.bin_win_days</cite> when None.</p></li>
<li><p><strong>bin_min_days</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum days M. Defaults to <cite>self.bin_min_days</cite> when None.</p></li>
<li><p><strong>time_dim</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the time dimension. Defaults to <cite>self.CICE_dict[“time_dim”]</cite>.</p></li>
<li><p><strong>centered</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, uses a centered window. If False, uses a trailing window.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ds</strong> – Dataset containing one uint8 variable named <cite>mask_name</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Time chunking is adjusted so that time chunks are not larger than the</p></li>
</ul>
<p>rolling window, which generally improves Dask rolling performance.
- Rolling uses <cite>min_periods=M</cite>, so partial windows can contribute when at
least M samples are available; this differs from a strict “full-window only”
approach.
- If the input has zero time length, returns an empty dataset (with logging).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.classify_binary_days_pack_ice">
<span class="sig-name descname"><span class="pre">classify_binary_days_pack_ice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PI_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_win_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_min_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centered</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.classify_binary_days_pack_ice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.classify_binary_days_pack_ice" title="Link to this definition"></a></dt>
<dd><p>Wrapper: binary-day persistence for pack-ice masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PI_mask</strong> (<em>xarray.DataArray</em>) – Input pack-ice mask (boolean or 0/1) with dimensions (time, y, x).</p></li>
<li><p><strong>bin_win_days</strong> (<em>int</em><em>, </em><em>optional</em>) – Window length and minimum count passed to <cite>classify_binary_days_mask</cite>.</p></li>
<li><p><strong>bin_min_days</strong> (<em>int</em><em>, </em><em>optional</em>) – Window length and minimum count passed to <cite>classify_binary_days_mask</cite>.</p></li>
<li><p><strong>time_dim</strong> (<em>str</em><em>, </em><em>optional</em>) – Time dimension name passed to <cite>classify_binary_days_mask</cite>.</p></li>
<li><p><strong>centered</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Center the rolling window.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset containing a uint8 variable named “PI_mask”.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>“Pack ice” here is the converse classification of fast ice under the same
concentration threshold and a speed threshold (defined elsewhere).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.classify_fast_ice">
<span class="sig-name descname"><span class="pre">classify_fast_ice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_win_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_min_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_rolling_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roll_win_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dim_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.classify_fast_ice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.classify_fast_ice" title="Link to this definition"></a></dt>
<dd><p>Classify fast ice (FI) from model output using daily, persistence, and optional rolling criteria.</p>
<p>Fast ice is defined where sea-ice concentration exceeds a threshold and ice
speed is small (immobile) but non-zero:</p>
<blockquote>
<div><p>FI := (aice &gt; icon_thresh) AND (0 &lt; speed &lt;= ispd_thresh)</p>
</div></blockquote>
<p>The method returns:
1) A daily FI mask computed directly from instantaneous (daily) T-grid speed.
2) A binary-day (persistence) FI mask computed from the <em>extended-range</em> daily</p>
<blockquote>
<div><p>mask using a W-day window requiring at least M FI days.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Optionally, a rolling-mean FI mask computed from a rolling-mean speed field.</p></li>
<li><p>Speed diagnostics (daily and optional rolling speed) in <cite>ispd_out</cite>.</p></li>
</ol>
<p>To avoid edge artefacts in persistence and rolling calculations, the input time
range is extended by half the largest window on each side, masks are computed
on the extended range, and then cropped back to [dt0_str, dtN_str].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt0_str</strong> (<em>str</em>) – Start and end dates (inclusive) in a pandas-parsable format (e.g., “YYYY-MM-DD”).</p></li>
<li><p><strong>dtN_str</strong> (<em>str</em>) – Start and end dates (inclusive) in a pandas-parsable format (e.g., “YYYY-MM-DD”).</p></li>
<li><p><strong>bin_win_days</strong> (<em>int</em><em>, </em><em>optional</em>) – Persistence window length W (days). Defaults to <cite>self.bin_win_days</cite>.</p></li>
<li><p><strong>bin_min_days</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum FI days M within the window. Defaults to <cite>self.bin_min_days</cite>.</p></li>
<li><p><strong>enable_rolling_output</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, also compute a rolling-mean speed field and corresponding FI mask.</p></li>
<li><p><strong>roll_win_days</strong> (<em>int</em><em>, </em><em>optional</em>) – Rolling-mean window length (days). Defaults to <cite>self.mean_period</cite>.</p></li>
<li><p><strong>time_dim_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the time dimension. Defaults to <cite>self.CICE_dict[“time_dim”]</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>FI_dly</strong> (<em>xarray.Dataset</em>) – Daily fast-ice mask dataset with variable “FI_mask” over [dt0_str, dtN_str].</p></li>
<li><p><strong>FI_bin</strong> (<em>xarray.Dataset</em>) – Binary-day (persistence) fast-ice mask dataset with variable “FI_mask” over
[dt0_str, dtN_str].</p></li>
<li><p><strong>FI_roll</strong> (<em>xarray.Dataset or None</em>) – Rolling-mean fast-ice mask dataset with variable “FI_mask” over [dt0_str, dtN_str],
or None if <cite>enable_rolling_output</cite> is False.</p></li>
<li><p><strong>ispd_out</strong> (<em>dict</em>) – Dictionary with speed diagnostics:
- “daily”: DataArray “ispd_T”
- “rolly”: DataArray “ispd_T_roll” (if enabled), else None</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Loads variables [‘aice’,’uvel’,’vvel’] over an extended time range.</p></li>
<li><p>Computes T-grid speed once on the extended range and reuses it.</p></li>
<li><p>Uses Dask-friendly chunking with small time chunks to improve rolling operations.</p></li>
<li><p>The binary-day mask is computed from the extended daily mask to prevent “all-zero”</p></li>
</ul>
<p>behaviour near the analysis window edges.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.classify_pack_ice">
<span class="sig-name descname"><span class="pre">classify_pack_ice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_win_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_min_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_rolling_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roll_win_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dim_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.classify_pack_ice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.classify_pack_ice" title="Link to this definition"></a></dt>
<dd><p>Classify pack ice (PI) from model output using daily, persistence, and optional rolling criteria.</p>
<p>Pack ice is defined as the complement of fast ice under the same concentration
threshold, using a speed threshold:</p>
<blockquote>
<div><p>PI := (aice &gt; icon_thresh) AND (speed &gt; ispd_thresh)</p>
</div></blockquote>
<p>The method returns:
1) A daily PI mask computed from instantaneous (daily) T-grid speed.
2) A binary-day (persistence) PI mask computed from the <em>extended-range</em> daily</p>
<blockquote>
<div><p>mask using a W-day window requiring at least M PI days.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Optionally, a rolling-mean PI mask computed from rolling-mean speed.</p></li>
<li><p>Speed diagnostics (daily and optional rolling speed) in <cite>ispd_out</cite>.</p></li>
</ol>
<p>As with fast-ice classification, the input time range is extended to avoid
edge artefacts in persistence/rolling calculations, and products are cropped
back to [dt0_str, dtN_str].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt0_str</strong> (<em>str</em>) – Start and end dates (inclusive) in a pandas-parsable format (e.g., “YYYY-MM-DD”).</p></li>
<li><p><strong>dtN_str</strong> (<em>str</em>) – Start and end dates (inclusive) in a pandas-parsable format (e.g., “YYYY-MM-DD”).</p></li>
<li><p><strong>bin_win_days</strong> (<em>int</em><em>, </em><em>optional</em>) – Persistence window length W (days). Defaults to <cite>self.bin_win_days</cite>.</p></li>
<li><p><strong>bin_min_days</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum PI days M within the window. Defaults to <cite>self.bin_min_days</cite>.</p></li>
<li><p><strong>enable_rolling_output</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, also compute a rolling-mean speed field and corresponding PI mask.</p></li>
<li><p><strong>roll_win_days</strong> (<em>int</em><em>, </em><em>optional</em>) – Rolling-mean window length (days). Defaults to <cite>self.mean_period</cite>.</p></li>
<li><p><strong>time_dim_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the time dimension. Defaults to <cite>self.CICE_dict[“time_dim”]</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>PI_dly</strong> (<em>xarray.Dataset</em>) – Daily pack-ice mask dataset with variable “PI_mask” over [dt0_str, dtN_str].</p></li>
<li><p><strong>PI_bin</strong> (<em>xarray.Dataset</em>) – Binary-day (persistence) pack-ice mask dataset with variable “PI_mask” over
[dt0_str, dtN_str].</p></li>
<li><p><strong>PI_roll</strong> (<em>xarray.Dataset or None</em>) – Rolling-mean pack-ice mask dataset with variable “PI_mask” over [dt0_str, dtN_str],
or None if <cite>enable_rolling_output</cite> is False.</p></li>
<li><p><strong>ispd_out</strong> (<em>dict</em>) – Dictionary with speed diagnostics:
- “daily”: DataArray “ispd_T”
- “rolly”: DataArray “ispd_T_roll” (if enabled), else None</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Pack ice is only classified where <cite>aice &gt; icon_thresh</cite>.</p></li>
<li><p>Binary-day persistence is computed on the extended daily mask to avoid</p></li>
</ul>
<p>edge-related bias and truncation artefacts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.classify_sea_ice">
<span class="sig-name descname"><span class="pre">classify_sea_ice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dim_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.classify_sea_ice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.classify_sea_ice" title="Link to this definition"></a></dt>
<dd><p>Classify total sea ice (SI) using only a concentration threshold.</p>
<dl class="simple">
<dt>Total sea ice is defined as:</dt><dd><p>SI := (aice &gt; icon_thresh)</p>
</dd>
</dl>
<p>This classification does not use speed, and therefore does not produce
binary-day (persistence) or rolling-mean products.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt0_str</strong> (<em>str</em>) – Start and end dates (inclusive) in a pandas-parsable format (e.g., “YYYY-MM-DD”).</p></li>
<li><p><strong>dtN_str</strong> (<em>str</em>) – Start and end dates (inclusive) in a pandas-parsable format (e.g., “YYYY-MM-DD”).</p></li>
<li><p><strong>time_dim_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the time dimension. Defaults to <cite>self.CICE_dict[“time_dim”]</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>SI_dly</strong> (<em>xarray.Dataset</em>) – Daily sea-ice mask dataset with variable “SI_mask” over [dt0_str, dtN_str].</p></li>
<li><p><strong>SI_bin</strong> (<em>None</em>) – Always None (no persistence product for SI).</p></li>
<li><p><strong>SI_roll</strong> (<em>None</em>) – Always None (no rolling-mean product for SI).</p></li>
<li><p><strong>ispd_out</strong> (<em>dict</em>) – Empty dict, returned for API consistency with FI/PI classifiers.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Loads only <cite>aice</cite> (no velocity fields required).</p></li>
<li><p>Applies hemisphere slicing via <cite>self.slice_hemisphere</cite>.</p></li>
<li><p>Output is chunked using <cite>self.CICE_dict[“FI_chunks”]</cite> and computed into memory.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_classification.SeaIceClassification.compute_ispdT">
<span class="sig-name descname"><span class="pre">compute_ispdT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uvel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vvel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/sea_ice_classification.html#SeaIceClassification.compute_ispdT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_classification.SeaIceClassification.compute_ispdT" title="Link to this definition"></a></dt>
<dd><p>Compute T-grid sea-ice speed magnitude using the configured staggering→T strategy.</p>
<p>Supported conversion modes in <cite>self.BorC2T_type</cite>:
- “Ta”: B-grid corner 2x2 mean (NaNs propagate) via <cite>B2Ta</cite>
- “Tb”: B-grid corner 2x2 mean (NaNs-&gt;0, no-slip) via <cite>B2Tb</cite>
- “Tx”: regrid (xESMF) via <cite>B2Tx</cite>
- “Tc”: C-grid edge→center reconstruction from (uvelE/uvelN/vvelE/vvelN) via <cite>C2T</cite></p>
<p>IMPORTANT: “Tc” is exclusive. If “Tc” is selected, it must be the only mode
and the result is NOT averaged with other modes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uvel</strong> (<em>xarray.DataArray</em><em> or </em><em>xarray.Dataset</em>) – <dl class="simple">
<dt>For Ta/Tb/Tx:</dt><dd><p>uvel and vvel are the usual B-grid corner-staggered components.</p>
</dd>
<dt>For Tc:</dt><dd><p>pass a Dataset (or mapping-like object) containing the four required
variables: uvelE, uvelN, vvelE, vvelN. <cite>vvel</cite> is ignored in this case.</p>
</dd>
</dl>
</p></li>
<li><p><strong>vvel</strong> (<em>xarray.DataArray</em><em> or </em><em>xarray.Dataset</em>) – <dl class="simple">
<dt>For Ta/Tb/Tx:</dt><dd><p>uvel and vvel are the usual B-grid corner-staggered components.</p>
</dd>
<dt>For Tc:</dt><dd><p>pass a Dataset (or mapping-like object) containing the four required
variables: uvelE, uvelN, vvelE, vvelN. <cite>vvel</cite> is ignored in this case.</p>
</dd>
</dl>
</p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>optional</em>) – Optional label for logging; not required.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ispd_T</strong> – T-grid speed magnitude (float32).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If “Tc” is combined with other modes, or if required C-grid variables
    are missing.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-sea_ice_observations">
<span id="sea-ice-observations"></span><h2>sea_ice_observations<a class="headerlink" href="#module-sea_ice_observations" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sea_ice_observations.</span></span><span class="sig-name descname"><span class="pre">SeaIceObservations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.AF2020_clim_to_model_time">
<span class="sig-name descname"><span class="pre">AF2020_clim_to_model_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.AF2020_clim_to_model_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.AF2020_clim_to_model_time" title="Link to this definition"></a></dt>
<dd><p>Expand a DOY-based climatology to match model time steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>xr.DataArray</em>) – Model time series with <cite>time</cite> coordinate.</p></li>
<li><p><strong>clim</strong> (<em>xr.DataArray</em>) – Climatology indexed by DOY and region.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Climatology repeated over <cite>model.time</cite>, matched by DOY.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.AF2020_interpolate_FIA_clim">
<span class="sig-name descname"><span class="pre">AF2020_interpolate_FIA_clim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_doy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">6,</span> <span class="pre">7,</span> <span class="pre">8,</span> <span class="pre">9,</span> <span class="pre">10,</span> <span class="pre">11,</span> <span class="pre">12,</span> <span class="pre">13,</span> <span class="pre">14,</span> <span class="pre">15,</span> <span class="pre">16,</span> <span class="pre">17,</span> <span class="pre">18,</span> <span class="pre">19,</span> <span class="pre">20,</span> <span class="pre">21,</span> <span class="pre">22,</span> <span class="pre">23,</span> <span class="pre">24,</span> <span class="pre">25,</span> <span class="pre">26,</span> <span class="pre">27,</span> <span class="pre">28,</span> <span class="pre">29,</span> <span class="pre">30,</span> <span class="pre">31,</span> <span class="pre">32,</span> <span class="pre">33,</span> <span class="pre">34,</span> <span class="pre">35,</span> <span class="pre">36,</span> <span class="pre">37,</span> <span class="pre">38,</span> <span class="pre">39,</span> <span class="pre">40,</span> <span class="pre">41,</span> <span class="pre">42,</span> <span class="pre">43,</span> <span class="pre">44,</span> <span class="pre">45,</span> <span class="pre">46,</span> <span class="pre">47,</span> <span class="pre">48,</span> <span class="pre">49,</span> <span class="pre">50,</span> <span class="pre">51,</span> <span class="pre">52,</span> <span class="pre">53,</span> <span class="pre">54,</span> <span class="pre">55,</span> <span class="pre">56,</span> <span class="pre">57,</span> <span class="pre">58,</span> <span class="pre">59,</span> <span class="pre">60,</span> <span class="pre">61,</span> <span class="pre">62,</span> <span class="pre">63,</span> <span class="pre">64,</span> <span class="pre">65,</span> <span class="pre">66,</span> <span class="pre">67,</span> <span class="pre">68,</span> <span class="pre">69,</span> <span class="pre">70,</span> <span class="pre">71,</span> <span class="pre">72,</span> <span class="pre">73,</span> <span class="pre">74,</span> <span class="pre">75,</span> <span class="pre">76,</span> <span class="pre">77,</span> <span class="pre">78,</span> <span class="pre">79,</span> <span class="pre">80,</span> <span class="pre">81,</span> <span class="pre">82,</span> <span class="pre">83,</span> <span class="pre">84,</span> <span class="pre">85,</span> <span class="pre">86,</span> <span class="pre">87,</span> <span class="pre">88,</span> <span class="pre">89,</span> <span class="pre">90,</span> <span class="pre">91,</span> <span class="pre">92,</span> <span class="pre">93,</span> <span class="pre">94,</span> <span class="pre">95,</span> <span class="pre">96,</span> <span class="pre">97,</span> <span class="pre">98,</span> <span class="pre">99,</span> <span class="pre">100,</span> <span class="pre">101,</span> <span class="pre">102,</span> <span class="pre">103,</span> <span class="pre">104,</span> <span class="pre">105,</span> <span class="pre">106,</span> <span class="pre">107,</span> <span class="pre">108,</span> <span class="pre">109,</span> <span class="pre">110,</span> <span class="pre">111,</span> <span class="pre">112,</span> <span class="pre">113,</span> <span class="pre">114,</span> <span class="pre">115,</span> <span class="pre">116,</span> <span class="pre">117,</span> <span class="pre">118,</span> <span class="pre">119,</span> <span class="pre">120,</span> <span class="pre">121,</span> <span class="pre">122,</span> <span class="pre">123,</span> <span class="pre">124,</span> <span class="pre">125,</span> <span class="pre">126,</span> <span class="pre">127,</span> <span class="pre">128,</span> <span class="pre">129,</span> <span class="pre">130,</span> <span class="pre">131,</span> <span class="pre">132,</span> <span class="pre">133,</span> <span class="pre">134,</span> <span class="pre">135,</span> <span class="pre">136,</span> <span class="pre">137,</span> <span class="pre">138,</span> <span class="pre">139,</span> <span class="pre">140,</span> <span class="pre">141,</span> <span class="pre">142,</span> <span class="pre">143,</span> <span class="pre">144,</span> <span class="pre">145,</span> <span class="pre">146,</span> <span class="pre">147,</span> <span class="pre">148,</span> <span class="pre">149,</span> <span class="pre">150,</span> <span class="pre">151,</span> <span class="pre">152,</span> <span class="pre">153,</span> <span class="pre">154,</span> <span class="pre">155,</span> <span class="pre">156,</span> <span class="pre">157,</span> <span class="pre">158,</span> <span class="pre">159,</span> <span class="pre">160,</span> <span class="pre">161,</span> <span class="pre">162,</span> <span class="pre">163,</span> <span class="pre">164,</span> <span class="pre">165,</span> <span class="pre">166,</span> <span class="pre">167,</span> <span class="pre">168,</span> <span class="pre">169,</span> <span class="pre">170,</span> <span class="pre">171,</span> <span class="pre">172,</span> <span class="pre">173,</span> <span class="pre">174,</span> <span class="pre">175,</span> <span class="pre">176,</span> <span class="pre">177,</span> <span class="pre">178,</span> <span class="pre">179,</span> <span class="pre">180,</span> <span class="pre">181,</span> <span class="pre">182,</span> <span class="pre">183,</span> <span class="pre">184,</span> <span class="pre">185,</span> <span class="pre">186,</span> <span class="pre">187,</span> <span class="pre">188,</span> <span class="pre">189,</span> <span class="pre">190,</span> <span class="pre">191,</span> <span class="pre">192,</span> <span class="pre">193,</span> <span class="pre">194,</span> <span class="pre">195,</span> <span class="pre">196,</span> <span class="pre">197,</span> <span class="pre">198,</span> <span class="pre">199,</span> <span class="pre">200,</span> <span class="pre">201,</span> <span class="pre">202,</span> <span class="pre">203,</span> <span class="pre">204,</span> <span class="pre">205,</span> <span class="pre">206,</span> <span class="pre">207,</span> <span class="pre">208,</span> <span class="pre">209,</span> <span class="pre">210,</span> <span class="pre">211,</span> <span class="pre">212,</span> <span class="pre">213,</span> <span class="pre">214,</span> <span class="pre">215,</span> <span class="pre">216,</span> <span class="pre">217,</span> <span class="pre">218,</span> <span class="pre">219,</span> <span class="pre">220,</span> <span class="pre">221,</span> <span class="pre">222,</span> <span class="pre">223,</span> <span class="pre">224,</span> <span class="pre">225,</span> <span class="pre">226,</span> <span class="pre">227,</span> <span class="pre">228,</span> <span class="pre">229,</span> <span class="pre">230,</span> <span class="pre">231,</span> <span class="pre">232,</span> <span class="pre">233,</span> <span class="pre">234,</span> <span class="pre">235,</span> <span class="pre">236,</span> <span class="pre">237,</span> <span class="pre">238,</span> <span class="pre">239,</span> <span class="pre">240,</span> <span class="pre">241,</span> <span class="pre">242,</span> <span class="pre">243,</span> <span class="pre">244,</span> <span class="pre">245,</span> <span class="pre">246,</span> <span class="pre">247,</span> <span class="pre">248,</span> <span class="pre">249,</span> <span class="pre">250,</span> <span class="pre">251,</span> <span class="pre">252,</span> <span class="pre">253,</span> <span class="pre">254,</span> <span class="pre">255,</span> <span class="pre">256,</span> <span class="pre">257,</span> <span class="pre">258,</span> <span class="pre">259,</span> <span class="pre">260,</span> <span class="pre">261,</span> <span class="pre">262,</span> <span class="pre">263,</span> <span class="pre">264,</span> <span class="pre">265,</span> <span class="pre">266,</span> <span class="pre">267,</span> <span class="pre">268,</span> <span class="pre">269,</span> <span class="pre">270,</span> <span class="pre">271,</span> <span class="pre">272,</span> <span class="pre">273,</span> <span class="pre">274,</span> <span class="pre">275,</span> <span class="pre">276,</span> <span class="pre">277,</span> <span class="pre">278,</span> <span class="pre">279,</span> <span class="pre">280,</span> <span class="pre">281,</span> <span class="pre">282,</span> <span class="pre">283,</span> <span class="pre">284,</span> <span class="pre">285,</span> <span class="pre">286,</span> <span class="pre">287,</span> <span class="pre">288,</span> <span class="pre">289,</span> <span class="pre">290,</span> <span class="pre">291,</span> <span class="pre">292,</span> <span class="pre">293,</span> <span class="pre">294,</span> <span class="pre">295,</span> <span class="pre">296,</span> <span class="pre">297,</span> <span class="pre">298,</span> <span class="pre">299,</span> <span class="pre">300,</span> <span class="pre">301,</span> <span class="pre">302,</span> <span class="pre">303,</span> <span class="pre">304,</span> <span class="pre">305,</span> <span class="pre">306,</span> <span class="pre">307,</span> <span class="pre">308,</span> <span class="pre">309,</span> <span class="pre">310,</span> <span class="pre">311,</span> <span class="pre">312,</span> <span class="pre">313,</span> <span class="pre">314,</span> <span class="pre">315,</span> <span class="pre">316,</span> <span class="pre">317,</span> <span class="pre">318,</span> <span class="pre">319,</span> <span class="pre">320,</span> <span class="pre">321,</span> <span class="pre">322,</span> <span class="pre">323,</span> <span class="pre">324,</span> <span class="pre">325,</span> <span class="pre">326,</span> <span class="pre">327,</span> <span class="pre">328,</span> <span class="pre">329,</span> <span class="pre">330,</span> <span class="pre">331,</span> <span class="pre">332,</span> <span class="pre">333,</span> <span class="pre">334,</span> <span class="pre">335,</span> <span class="pre">336,</span> <span class="pre">337,</span> <span class="pre">338,</span> <span class="pre">339,</span> <span class="pre">340,</span> <span class="pre">341,</span> <span class="pre">342,</span> <span class="pre">343,</span> <span class="pre">344,</span> <span class="pre">345,</span> <span class="pre">346,</span> <span class="pre">347,</span> <span class="pre">348,</span> <span class="pre">349,</span> <span class="pre">350,</span> <span class="pre">351,</span> <span class="pre">352,</span> <span class="pre">353,</span> <span class="pre">354,</span> <span class="pre">355,</span> <span class="pre">356,</span> <span class="pre">357,</span> <span class="pre">358,</span> <span class="pre">359,</span> <span class="pre">360,</span> <span class="pre">361,</span> <span class="pre">362,</span> <span class="pre">363,</span> <span class="pre">364,</span> <span class="pre">365])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.AF2020_interpolate_FIA_clim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.AF2020_interpolate_FIA_clim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.NSIDC_coordinate_transformation">
<span class="sig-name descname"><span class="pre">NSIDC_coordinate_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.NSIDC_coordinate_transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.NSIDC_coordinate_transformation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.add_lonlat_from_epsg3031">
<span class="sig-name descname"><span class="pre">add_lonlat_from_epsg3031</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0..360'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float32'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.add_lonlat_from_epsg3031"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.add_lonlat_from_epsg3031" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.build_AF2020_grid_corners">
<span class="sig-name descname"><span class="pre">build_AF2020_grid_corners</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.build_AF2020_grid_corners"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.build_AF2020_grid_corners" title="Link to this definition"></a></dt>
<dd><p>Construct (ny+1, nx+1) corner arrays from center lat/lon arrays.
Assumes a regular 2D rectilinear grid in EPSG:3412 projection.</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>lat_c, lon_c<span class="classifier">2D arrays (ny, nx)</span></dt><dd><p>Latitude and longitude of pixel centers.</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>lat_b, lon_b<span class="classifier">2D arrays (ny+1, nx+1)</span></dt><dd><p>Latitude and longitude of grid cell corners.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.build_sea_ice_satellite_paths">
<span class="sig-name descname"><span class="pre">build_sea_ice_satellite_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemisphere</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">institutions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('ESA',</span> <span class="pre">'AWI')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_esa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_awi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.build_sea_ice_satellite_paths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.build_sea_ice_satellite_paths" title="Link to this definition"></a></dt>
<dd><p>Build a de-duplicated, time-filtered list of NetCDF files for satellite sea-ice
products across ESA and/or AWI directory layouts.</p>
<dl>
<dt>Time filtering:</dt><dd><ul class="simple">
<li><p>Returns files whose date/month lies within the closed interval</p></li>
</ul>
<p>[dt0_str, dtN_str], interpreted in UTC.
- Daily products (e.g., ESA L2P) are filtered by date parsed from the filename
(YYYYMMDD). Monthly products (e.g., ESA L3C or AWI monthly layout) are
filtered by overlap between the (year, month) and [dt0, dtN].</p>
</dd>
<dt>Supported directory patterns (walked automatically):</dt><dd><dl class="simple">
<dt>ESA “flat” layout:</dt><dd><p>&lt;root_esa&gt;/&lt;L2P|L3C&gt;/&lt;sensor&gt;/&lt;hemisphere&gt;/<a href="#id3"><span class="problematic" id="id4">*</span></a>.nc
(hemisphere directory may be ‘NH’/’SH’ or lowercase)
- L2P: filenames contain YYYYMMDD
- L3C: filenames often contain YYYYMM</p>
</dd>
<dt>ESA versioned layout:</dt><dd><p>&lt;root_esa&gt;/&lt;L2P|L3C&gt;/&lt;sensor&gt;/&lt;version&gt;/&lt;HEMISPHERE&gt;/&lt;YYYY&gt;/&lt;MM&gt;/<a href="#id5"><span class="problematic" id="id6">*</span></a>.nc
(HEMISPHERE can be ‘NH’/’SH’ or lowercase; &lt;MM&gt; subdirs may be absent)</p>
</dd>
<dt>AWI release layout:</dt><dd><p>&lt;root_awi&gt;/&lt;l2p_release|l3cp_release&gt;/&lt;hemisphere&gt;/&lt;sensor&gt;/&lt;YYYY&gt;[/&lt;MM&gt;]/<a href="#id7"><span class="problematic" id="id8">*</span></a>.nc</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt0_str</strong> – Start and end of the desired time window (inclusive). Any pandas-parsable
string is accepted (e.g., “2002-01-01”, “2012-12-31”). Interpreted as UTC.</p></li>
<li><p><strong>dtN_str</strong> – Start and end of the desired time window (inclusive). Any pandas-parsable
string is accepted (e.g., “2002-01-01”, “2012-12-31”). Interpreted as UTC.</p></li>
<li><p><strong>hemisphere</strong> – Hemisphere selector. If None, uses <cite>self.hemisphere_dict[‘abbreviation’]</cite>.
Case is normalized; both ‘sh’/’nh’ and ‘SH’/’NH’ are supported in dir scans.</p></li>
<li><p><strong>institutions</strong> – Iterable of institutions to include (case-insensitive). Valid values include
“ESA” and/or “AWI”. If None or empty, both are searched.</p></li>
<li><p><strong>sensors</strong> – Optional iterable of sensor names to filter (case-insensitive, matched to
directory names under the institution layout).</p></li>
<li><p><strong>levels</strong> – Optional iterable of level strings. ESA: “L2P”, “L3C”.
AWI: “l2p_release”, “l3cp_release”. If “l2p”/”l3c” are provided for AWI
they are mapped to “l2p_release”/”l3cp_release”.</p></li>
<li><p><strong>versions</strong> – ESA only: one or more version directory names (e.g., “v2.0”, “v3.0”).
Case-insensitive. Ignored for AWI.</p></li>
<li><p><strong>root_esa</strong> – Root directories for ESA and AWI datasets.</p></li>
<li><p><strong>root_awi</strong> – Root directories for ESA and AWI datasets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sorted unique list of file paths within the requested time window that
satisfy the filters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Path]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Filename parsing assumes dates follow YYYYMMDD (daily) or YYYYMM (monthly)</p></li>
</ul>
<p>within 2000–2099. Files without such tokens are kept only when they live in
a year/month directory that overlaps [dt0, dtN].
- If <cite>institutions</cite> is None or empty, both ESA and AWI are scanned.
- All timestamps are treated as UTC to avoid tz-comparison issues.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_sea_ice_satellite_paths</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;2002-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2002-12-31&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hemisphere</span><span class="o">=</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">institutions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ESA&quot;</span><span class="p">,</span> <span class="s2">&quot;AWI&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">sensors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cryosat2&quot;</span><span class="p">,</span> <span class="s2">&quot;envisat&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;L2P&quot;</span><span class="p">,</span><span class="s2">&quot;L3C&quot;</span><span class="p">,</span><span class="s2">&quot;l2p_release&quot;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">),</span> <span class="n">paths</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.compute_NSIDC_metrics">
<span class="sig-name descname"><span class="pre">compute_NSIDC_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_load_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monthly_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_zarr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.compute_NSIDC_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.compute_NSIDC_metrics" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.compute_fip_weight">
<span class="sig-name descname"><span class="pre">compute_fip_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FIP</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.compute_fip_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.compute_fip_weight" title="Link to this definition"></a></dt>
<dd><p>Return opacity weight in [0,1] where 0 =&gt; fully transparent, 1 =&gt; opaque.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.dedup_daily_one_file_per_day">
<span class="sig-name descname"><span class="pre">dedup_daily_one_file_per_day</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'last'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.dedup_daily_one_file_per_day"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.dedup_daily_one_file_per_day" title="Link to this definition"></a></dt>
<dd><p>From an indexed DataFrame (see index_satellite_paths), select one file per day.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – Output of <cite>index_satellite_paths</cite>.</p></li>
<li><p><strong>prefer</strong> (<em>{&quot;first&quot;</em><em>,</em><em>&quot;last&quot;}</em><em>, </em><em>default &quot;last&quot;</em>) – If multiple files map to the same day, choose the first/last after sorting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Subset of <cite>df</cite> with kind == “daily” and unique ‘date’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.dedup_monthly_one_file_per_month">
<span class="sig-name descname"><span class="pre">dedup_monthly_one_file_per_month</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'last'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.dedup_monthly_one_file_per_month"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.dedup_monthly_one_file_per_month" title="Link to this definition"></a></dt>
<dd><p>From an indexed DataFrame (see index_satellite_paths), select one file per month.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – Output of <cite>index_satellite_paths</cite>.</p></li>
<li><p><strong>prefer</strong> (<em>{&quot;first&quot;</em><em>,</em><em>&quot;last&quot;}</em><em>, </em><em>default &quot;last&quot;</em>) – If multiple files map to the same (year, month), keep the first/last after sorting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Subset with kind == “monthly” (or daily files that encode YYYYMM) and unique (year, month).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.define_FIP_diff_names">
<span class="sig-name descname"><span class="pre">define_FIP_diff_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">AF2020</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dim_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.define_FIP_diff_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.define_FIP_diff_names" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.define_fast_ice_coordinates">
<span class="sig-name descname"><span class="pre">define_fast_ice_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AF2020</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dim_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.define_fast_ice_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.define_fast_ice_coordinates" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.define_fast_ice_mask_da">
<span class="sig-name descname"><span class="pre">define_fast_ice_mask_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AF2020</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dim_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.define_fast_ice_mask_da"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.define_fast_ice_mask_da" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.define_fast_ice_persistence_da">
<span class="sig-name descname"><span class="pre">define_fast_ice_persistence_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reG</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.define_fast_ice_persistence_da"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.define_fast_ice_persistence_da" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.define_reG_regular_weights">
<span class="sig-name descname"><span class="pre">define_reG_regular_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">360,</span> <span class="pre">-90,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AF2020</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dim_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reG_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.define_reG_regular_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.define_reG_regular_weights" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.define_regular_G">
<span class="sig-name descname"><span class="pre">define_regular_G</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">360,</span> <span class="pre">-90,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dim_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('nj',</span> <span class="pre">'ni')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.define_regular_G"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.define_regular_G" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.ease2_nh_25km">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ease2_nh_25km</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.ease2_nh_25km"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.ease2_nh_25km" title="Link to this definition"></a></dt>
<dd><p>Convenience grid for NH (432×432 &#64; ~25 km, lon0=0).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.ease2_sh_50km">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ease2_sh_50km</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.ease2_sh_50km"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.ease2_sh_50km" title="Link to this definition"></a></dt>
<dd><p>Convenience grid roughly matching AWI SH L3C (216×216 &#64; ~50 km, lon0=0).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.grid_coords_from_area">
<span class="sig-name descname"><span class="pre">grid_coords_from_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">area_def</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.grid_coords_from_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.grid_coords_from_area" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.index_satellite_paths">
<span class="sig-name descname"><span class="pre">index_satellite_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.index_satellite_paths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.index_satellite_paths" title="Link to this definition"></a></dt>
<dd><p>Build a tidy index of satellite files with parsed dates for QA/QC and selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Columns:</dt><dd><ul class="simple">
<li><p>path: Path</p></li>
<li><p>kind: {“daily”,”monthly”,”unknown”}</p></li>
<li><p>date: UTC Timestamp (daily) or first-of-month (monthly) or NaT</p></li>
<li><p>year, month, day: ints or None</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.l2p_to_daily_grid_pyresample">
<span class="sig-name descname"><span class="pre">l2p_to_daily_grid_pyresample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_def</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roi_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">75.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbours</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_sigma_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_cut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_at_noon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.l2p_to_daily_grid_pyresample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.l2p_to_daily_grid_pyresample" title="Link to this definition"></a></dt>
<dd><p>Resample ESA/AWI <strong>L2P swath</strong> files to a <strong>daily gridded</strong> product on an
equal-area polar grid using pyresample nearest-neighbour sets.</p>
<p>The algorithm:
1) Group all valid swath samples by UTC day (per file) using <cite>time</cite> variable.
2) For each day:</p>
<blockquote>
<div><ul class="simple">
<li><p>Build a SwathDefinition from lon/lat points.</p></li>
<li><p>Use <cite>pyresample.kd_tree.get_neighbour_info</cite> to find up to <cite>neighbours</cite>
candidates within <cite>roi_km</cite> of each grid cell.</p></li>
<li><p>Combine neighbour SIT &amp; uncertainty with uniform or Gaussian weights.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Assemble (time, y, x) arrays and compute hemispheric daily means with
cos(latitude) weights.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>paths</strong> (<em>list</em><em> of </em><em>Path</em>) – L2P NetCDF files. Each must include variables:
<cite>sea_ice_thickness</cite>, <cite>sea_ice_thickness_uncertainty</cite>, <cite>lon</cite>, <cite>lat</cite>, <cite>time</cite>.</p></li>
<li><p><strong>hem</strong> (<em>{'sh'</em><em>,</em><em>'nh'}</em><em>, </em><em>optional</em>) – Hemisphere. Defaults to <cite>self.hemisphere_dict[‘abbreviation’]</cite> when present,
else ‘sh’.</p></li>
<li><p><strong>area_def</strong> (<em>pyresample.geometry.AreaDefinition</em><em>, </em><em>optional</em>) – Target equal-area grid. If None, uses <cite>ease2_sh_50km()</cite> for SH or
<cite>ease2_nh_25km()</cite> for NH.</p></li>
<li><p><strong>roi_km</strong> (<em>float</em><em>, </em><em>default 75.0</em>) – Radius of influence for neighbour search (kilometres).</p></li>
<li><p><strong>neighbours</strong> (<em>int</em><em>, </em><em>default 16</em>) – Max neighbours per grid cell from KD-tree.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em>, </em><em>default 0.0</em>) – Search tolerance passed to pyresample (trade accuracy vs. speed).</p></li>
<li><p><strong>gaussian_sigma_km</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>default None</em>) – If set, apply Gaussian weights with this sigma (km); otherwise uniform.</p></li>
<li><p><strong>lat_cut</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>default None</em>) – Optional extra swath mask: for SH keep <cite>lat &lt;= lat_cut</cite>; for NH keep
<cite>lat &gt;= lat_cut</cite>. Useful for excluding marginal seas.</p></li>
<li><p><strong>time_at_noon</strong> (<em>bool</em><em>, </em><em>default True</em>) – If True, time coordinate is day+12:00Z; else midnight.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dimensions: time, y, x
Coordinates: lon(y,x), lat(y,x), time
Data variables:</p>
<blockquote>
<div><p>SIT(time,y,x)       [m]
SIT_unc(time,y,x)   [m] propagated standard error
u_cell(time,y,x)    [m] per-cell uncertainty mean (neighbour-weighted)
n_cell(time,y,x)    [#] count of contributing neighbours per cell
SIT_hem(time)       [m] hemispheric mean
SIT_hem_unc(time)   [m] propagated SE for hemispheric mean
SIT_hem_u(time)     [m] hemispheric mean of per-cell uncertainty
SIT_hem_n(time)     [#] total contributing neighbours (sum over grid)</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Hemispheric means use cos(lat) weights on the target grid after resampling.</p></li>
<li><p>Propagated SE follows: sqrt(sum(w^2 * se^2)) / sum(w).</p></li>
<li><p>Files missing required variables are skipped (warning).</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.l3c_paths_to_monthly_grid">
<span class="sig-name descname"><span class="pre">l3c_paths_to_monthly_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sic_thresh_percent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_snow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_flags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_midpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.l3c_paths_to_monthly_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.l3c_paths_to_monthly_grid" title="Link to this definition"></a></dt>
<dd><p>Assemble ESA L3C / AWI l3cp_release files (already on LAEA grids) into a
single (time, y, x) dataset with hemispheric monthly means.</p>
<p>This function mirrors the L2P driver logic, but <strong>no resampling</strong> is done:
it reads gridded variables straight from the files and standardizes dims.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>paths</strong> (<em>list</em><em>[</em><em>Path</em><em>]</em>) – Monthly L3 NetCDF paths (ESA L3C or AWI l3cp_release).</p></li>
<li><p><strong>hem</strong> (<em>{'sh'</em><em>,</em><em>'nh'}</em><em>, </em><em>optional</em>) – Hemisphere hint (controls sign in optional lat_cut if you add one later).
Defaults to <cite>self.hemisphere_dict[‘abbreviation’]</cite> if present.</p></li>
<li><p><strong>sic_thresh_percent</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>default 15.0</em>) – If set, mask cells with sea_ice_concentration &lt; threshold (percent).</p></li>
<li><p><strong>mask_strategy</strong> (<em>{&quot;none&quot;</em><em>,</em><em>&quot;quality&quot;</em><em>,</em><em>&quot;status&quot;</em><em>,</em><em>&quot;both&quot;}</em><em>, </em><em>default &quot;none&quot;</em>) – <ul>
<li><p>“quality” keeps cells with quality_flag == 0</p></li>
<li><p>”status”  keeps cells with status_flag  == 0</p></li>
<li><p>”both”    requires both conditions</p></li>
</ul>
</p></li>
<li><p><strong>include_snow</strong> (<em>bool</em><em>, </em><em>default True</em>) – Include snow_depth and snow_depth_uncertainty when present.</p></li>
<li><p><strong>include_flags</strong> (<em>bool</em><em>, </em><em>default True</em>) – Include flag fields (quality_flag, status_flag, region_code) when present.</p></li>
<li><p><strong>min_obs</strong> (<em>int</em><em>, </em><em>default 1</em>) – If a count variable exists (e.g., “n_observations”), require count &gt;= min_obs.</p></li>
<li><p><strong>time_midpoint</strong> (<em>bool</em><em>, </em><em>default True</em>) – If time_bnds variable exists, use midpoint as the time coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dimensions: time, y, x
Coordinates: lon(y,x), lat(y,x), time
Data variables:</p>
<blockquote>
<div><p>SIT(time,y,x)       [m]
SIT_unc(time,y,x)   [m] per-cell uncertainty (SE)
SIC(time,y,x)       [%] if present
snow_depth(time,y,x) [m] if requested/present
snow_depth_unc(time,y,x) [m] if requested/present
quality_flag/status_flag/region_code if requested/present
SIT_hem(time)       [m] hemispheric mean
SIT_hem_unc(time)   [m] propagated SE = sqrt(sum(w^2 * se^2))/sum(w)
SIT_hem_u(time)     [m] hemispheric mean of per-cell uncertainty
SIT_hem_n(time)     [#] count of valid contributing cells</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.laea_area_def">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">laea_area_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.laea_area_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.laea_area_def" title="Link to this definition"></a></dt>
<dd><p>Build a Lambert Azimuthal Equal-Area grid centered on the pole.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hem</strong> (<em>{'sh'</em><em>,</em><em>'nh'}</em>) – Hemisphere.</p></li>
<li><p><strong>nx</strong> (<em>int</em>) – Grid shape (x, y).</p></li>
<li><p><strong>ny</strong> (<em>int</em>) – Grid shape (x, y).</p></li>
<li><p><strong>dx_km</strong> (<em>float</em>) – Grid spacing in kilometers (projected meters).</p></li>
<li><p><strong>lon0</strong> (<em>float</em><em>, </em><em>default 0.0</em>) – Central longitude (°E). ESA products commonly use 0.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyresample.geometry.AreaDefinition</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.load_AF2020_FIA_summary">
<span class="sig-name descname"><span class="pre">load_AF2020_FIA_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repeat_climatology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'1994-01-01'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'1999-12-31'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.load_AF2020_FIA_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.load_AF2020_FIA_summary" title="Link to this definition"></a></dt>
<dd><p>Load AF2020 landfast sea ice area time series and compute day-of-year climatology.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>repeat_climatology</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, returns climatology repeated over the date range. If False, only returns 1D raw data.</p></li>
<li><p><strong>start</strong> (<em>str</em><em>, </em><em>optional</em>) – Start date for repeated climatology (default: “1994-01-01”).</p></li>
<li><p><strong>end</strong> (<em>str</em><em>, </em><em>optional</em>) – End date for repeated climatology (default: “1999-12-31”).</p></li>
<li><p><strong>smooth</strong> (<em>int</em><em>, </em><em>optional</em>) – Rolling window size for smoothing the day-of-year climatology (default: 5 days).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Dataset with:</dt><dd><ul class="simple">
<li><p>’FIA_obs’:           Daily FIA time series [time, region]</p></li>
<li><p>’FIA_clim’:          Smoothed climatology [doy, region]</p></li>
<li><p>’FIA_clim_repeat’:   Climatology repeated over [start, end] (optional)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.load_local_NSIDC">
<span class="sig-name descname"><span class="pre">load_local_NSIDC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monthly_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.load_local_NSIDC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.load_local_NSIDC" title="Link to this definition"></a></dt>
<dd><p>Load NSIDC sea ice concentration data from local NetCDF files over a date range.</p>
<dl>
<dt>INPUTS:</dt><dd><p>dt0_str         : str, optional; start date in ‘YYYY-MM-DD’ format. Defaults to self.dt0_str.
dtN_str         : str, optional; end date in ‘YYYY-MM-DD’ format. Defaults to self.dtN_str.
local_directory : str or Path, optional; directory containing the NSIDC NetCDF files.</p>
<blockquote>
<div><p>If None, uses self.NSIDC_dict[“D_original”].</p>
</div></blockquote>
<p>monthly_files   : bool, optional; iff True, loads monthly files; otherwise loads daily files.</p>
</dd>
<dt>OUTPUTS</dt><dd><p>xarray.Dataset; combined dataset loaded with xarray.open_mfdataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.make_area_definition">
<span class="sig-name descname"><span class="pre">make_area_definition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'epsg3031_5km_union'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.make_area_definition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.make_area_definition" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.make_daily_gridded_SIT">
<span class="sig-name descname"><span class="pre">make_daily_gridded_SIT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemisphere</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">institutions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('ESA',</span> <span class="pre">'AWI')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_esa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_awi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roi_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">75.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbours</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_sigma_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_cut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_at_noon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'last'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_def</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.make_daily_gridded_SIT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.make_daily_gridded_SIT" title="Link to this definition"></a></dt>
<dd><p>Build a daily gridded SIT dataset for a time window in one call.</p>
<p>This:
1) Uses <cite>build_sea_ice_satellite_paths(…)</cite> to find L2P files in [dt0, dtN].
2) Indexes &amp; de-duplicates to one file per day (configurable).
3) Calls <cite>l2p_to_daily_grid_pyresample(…)</cite> to produce (time,y,x) fields</p>
<blockquote>
<div><p>plus hemispheric daily series.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>See <cite>l2p_to_daily_grid_pyresample</cite> for structure.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.make_monthly_gridded_SIT_L3">
<span class="sig-name descname"><span class="pre">make_monthly_gridded_SIT_L3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemisphere</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">institutions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('ESA',</span> <span class="pre">'AWI')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('L3C',</span> <span class="pre">'l3cp_release')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_esa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_awi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'last'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sic_thresh_percent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_snow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_flags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_midpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.make_monthly_gridded_SIT_L3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.make_monthly_gridded_SIT_L3" title="Link to this definition"></a></dt>
<dd><p>Build a monthly gridded SIT dataset from L3 products (ESA L3C / AWI l3cp_release)
in one call. Mirrors the L2P one-call driver but skips resampling.</p>
<p>Steps:
1) Find files with <cite>build_sea_ice_satellite_paths(…)</cite>
2) Index and de-duplicate to one file per month
3) Assemble into (time,y,x) arrays with <cite>l3c_paths_to_monthly_grid(…)</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.regional_fast_ice_area">
<span class="sig-name descname"><span class="pre">regional_fast_ice_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(52.5,</span> <span class="pre">97.5,</span> <span class="pre">-70.5,</span> <span class="pre">-64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'longitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'latitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'area'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fast_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Fast_Ice_Time_series'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0-360'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.regional_fast_ice_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.regional_fast_ice_area" title="Link to this definition"></a></dt>
<dd><p>Compute regional fast-ice area (km^2) time series from AF2020-like DS with
curvilinear lon/lat and a per-cell area field.
region = (lon_min, lon_max, lat_min, lat_max)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.resample_swath_to_area">
<span class="sig-name descname"><span class="pre">resample_swath_to_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_def</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.resample_swath_to_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.resample_swath_to_area" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.snap_extent_to_grid">
<span class="sig-name descname"><span class="pre">snap_extent_to_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.snap_extent_to_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.snap_extent_to_grid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.to_3031_extent">
<span class="sig-name descname"><span class="pre">to_3031_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.to_3031_extent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.to_3031_extent" title="Link to this definition"></a></dt>
<dd><p>Project a swath’s lat/lon to EPSG:3031 and return [xmin, ymin, xmax, ymax] (+buffer).
Wrap longitudes to [-180, 180) first to avoid dateline issues.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_observations.SeaIceObservations.union_extents">
<span class="sig-name descname"><span class="pre">union_extents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_observations.html#SeaIceObservations.union_extents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_observations.SeaIceObservations.union_extents" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sea_ice_metrics">
<span id="sea-ice-metrics"></span><h2>sea_ice_metrics<a class="headerlink" href="#module-sea_ice_metrics" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sea_ice_metrics.</span></span><span class="sig-name descname"><span class="pre">SeaIceMetrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.antarctic_year_labels">
<span class="sig-name descname"><span class="pre">antarctic_year_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_da</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.antarctic_year_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.antarctic_year_labels" title="Link to this definition"></a></dt>
<dd><p>Return an ‘ayear’ label for Jul→Jun years (e.g., 2000.5 dates -&gt; ayear=2000).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_area">
<span class="sig-name descname"><span class="pre">compute_hemisphere_ice_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_area_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dim_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sic_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_grounded_iceberg_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grounded_iceberg_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.compute_hemisphere_ice_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_area" title="Link to this definition"></a></dt>
<dd><p>Compute the total sea ice area (IA) by integrating sea ice concentration (SIC) over the grid area, and optionally
including the grounded iceberg area (GI_total_area).</p>
<p>This method computes the sea ice area by multiplying the sea ice concentration (SIC) by the grid cell area (GC_area),
summing the result over the specified spatial dimensions, and optionally adding the grounded iceberg area. The final
result is then scaled by an optional ice area scale factor.</p>
<section id="id9">
<h3>Parameters:<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>SIC<span class="classifier">xarray.DataArray</span></dt><dd><p>Sea ice concentration field with dimensions (nj, ni) representing the concentration of sea ice at each grid point.</p>
</dd>
<dt>A<span class="classifier">xarray.DataArray</span></dt><dd><p>Grid cell area with the same dimensions (nj, ni) as SIC, representing the area of each grid cell in square meters.</p>
</dd>
<dt>ice_area_scale<span class="classifier">float, optional</span></dt><dd><p>A scale factor for the sea ice area calculation. If not provided, the default scale is used from the <cite>FIC_scale</cite> attribute.</p>
</dd>
<dt>spatial_dim_names<span class="classifier">list of str, optional</span></dt><dd><p>The dimension names over which to sum the sea ice area (typically latitude and longitude). If not provided, the default spatial dimensions
are used from the <cite>CICE_dict</cite> attribute.</p>
</dd>
<dt>sic_threshold<span class="classifier">float, optional</span></dt><dd><p>Minimum SIC value to be included in the area calculation. Points with SIC below this threshold are excluded.
Defaults to <cite>self.icon_thresh</cite>.</p>
</dd>
<dt>add_grounded_iceberg_area<span class="classifier">bool, optional</span></dt><dd><p>A flag indicating whether to include the grounded iceberg area in the ice area calculation. Defaults to the class attribute <cite>use_gi</cite>.</p>
</dd>
<dt>grounded_iceberg_area<span class="classifier">float, optional</span></dt><dd><p>The grounded iceberg area in square meters to be added to the sea ice area. If not provided, the grounded iceberg area is computed using
<cite>compute_grounded_iceberg_area()</cite>.</p>
</dd>
</dl>
</section>
<section id="id10">
<h3>Returns:<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>IA<span class="classifier">xarray.DataArray</span></dt><dd><p>The total sea ice area, including the optional grounded iceberg area, with the same spatial dimensions as SIC and GC_area.
The value is returned after summing over the spatial dimensions and scaling by the provided <cite>ice_area_scale</cite>.</p>
</dd>
</dl>
</section>
<section id="notes">
<h3>Notes:<a class="headerlink" href="#notes" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The grounded iceberg area is added to the sea ice area calculation if <cite>add_grounded_iceberg_area</cite> is <cite>True</cite>. If no grounded iceberg area</p></li>
</ul>
<p>is provided, the method will compute it using the <cite>compute_grounded_iceberg_area()</cite> method.
- The sea ice area is computed as the sum of SIC * GC_area across the specified spatial dimensions, and then scaled by <cite>ice_area_scale</cite>.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_area_rate">
<span class="sig-name descname"><span class="pre">compute_hemisphere_ice_area_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DAT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dim_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.compute_hemisphere_ice_area_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_area_rate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_strength">
<span class="sig-name descname"><span class="pre">compute_hemisphere_ice_strength</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">HI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dim_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sic_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_strength_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.compute_hemisphere_ice_strength"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_strength" title="Link to this definition"></a></dt>
<dd><p>Compute hemispheric mean sea ice pressure in hectopascals (hPa), based on masked concentration,
thickness, strength, and area fields.</p>
<p>This function calculates an area-weighted mean ice thickness (m) by dividing total
ice volume by total ice-covered area. It then converts internal ice strength (N/m)
into an equivalent pressure field (Pa = N/m²), and finally into hectopascals (hPa).
Grid cells below a threshold sea ice concentration are masked from the analysis.</p>
<section id="inputs">
<h3>INPUTS:<a class="headerlink" href="#inputs" title="Link to this heading"></a></h3>
<p>SIC               : xr.DataArray; Sea ice concentration (unitless, typically 0–1), per grid cell.
HI                : xr.DataArray; Sea ice thickness in meters, per grid cell.
IS                : xr.DataArray; Internal ice strength in N/m, per grid cell.
A                 : xr.DataArray; Grid cell area in m².
spatial_dim_names : list, optional; Names of the spatial dimensions to reduce over (e.g., [“nj”, “ni”]).</p>
<blockquote>
<div><p>If not provided, defaults to values in self.CICE_dict[‘spatial_dims’].</p>
</div></blockquote>
<p>sic_threshold     : float, optional; Threshold for masking sea ice concentration (default: self.icon_thresh).</p>
</section>
<section id="outputs">
<h3>OUTPUTS:<a class="headerlink" href="#outputs" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>P<span class="classifier">xr.DataArray; Sea ice pressure in hectopascals (hPa), with masked cells excluded</span></dt><dd><p>and computed as (IS / mean_thickness) / 100.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The output pressure is an approximation derived from CICE’s internal strength field and is not a direct model output.</p></li>
<li><p>Use with caution where sea ice thickness is very small or near-zero.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_thickness">
<span class="sig-name descname"><span class="pre">compute_hemisphere_ice_thickness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">HI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dim_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sic_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.compute_hemisphere_ice_thickness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_thickness" title="Link to this definition"></a></dt>
<dd><p>Compute average sea ice thickness weighted by grid cell area and sea ice concentration.</p>
<p>This method calculates the domain-averaged sea ice thickness as the ratio of the total sea ice volume to
the total sea ice area. A SIC threshold is used to exclude low-concentration grid cells from both the numerator
and denominator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>HI</strong> (<em>xarray.DataArray</em>) – Sea ice thickness in meters.</p></li>
<li><p><strong>SIC</strong> (<em>xarray.DataArray</em>) – Sea ice concentration (unitless, typically between 0 and 1).</p></li>
<li><p><strong>GC_area</strong> (<em>xarray.DataArray</em>) – Grid cell area in square meters (m²).</p></li>
<li><p><strong>spatial_dim_names</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Names of spatial dimensions over which to compute the sums. Defaults to <cite>self.CICE_dict[‘spatial_dims’]</cite>.</p></li>
<li><p><strong>sic_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum SIC value to include in the average. Grid cells with SIC ≤ <cite>sic_threshold</cite> are excluded.
Defaults to <cite>self.icon_thresh</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Domain-averaged sea ice thickness, computed as the total volume divided by total area.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or xarray.DataArray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Computed as: ∑(HI × area) / ∑(SIC × area), with masking by <cite>sic_threshold</cite>.</p></li>
<li><p>Excludes cells with SIC below threshold from both numerator and denominator.</p></li>
<li><p>Units are in meters.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_volume">
<span class="sig-name descname"><span class="pre">compute_hemisphere_ice_volume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">HI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_grounded_iceberg_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_volume_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dim_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sic_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grounded_iceberg_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.compute_hemisphere_ice_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_volume" title="Link to this definition"></a></dt>
<dd><p>Compute total sea ice volume by integrating sea ice concentration, thickness, and grid cell area.</p>
<p>This method calculates the total sea ice volume as the sum of the product of sea ice concentration (SIC),
thickness (HI), and grid cell area (GC_area) across the model domain. A SIC threshold can be applied to exclude
grid cells with low concentrations. Optionally includes grounded iceberg volume and applies a scaling factor
for unit conversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SIC</strong> (<em>xarray.DataArray</em>) – Sea ice concentration (unitless, typically between 0 and 1).</p></li>
<li><p><strong>HI</strong> (<em>xarray.DataArray</em>) – Sea ice thickness in meters.</p></li>
<li><p><strong>A</strong> (<em>xarray.DataArray</em>) – Grid cell area in square meters (m²).</p></li>
<li><p><strong>ice_volume_scale</strong> (<em>float</em><em>, </em><em>optional</em>) – Scale factor for the output volume. Default is <cite>1e12</cite>, converting m³ to 1000 km³.</p></li>
<li><p><strong>spatial_dim_names</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Names of spatial dimensions to sum over (e.g., [‘nj’, ‘ni’]). Defaults to <cite>self.CICE_dict[‘spatial_dims’]</cite>.</p></li>
<li><p><strong>sic_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum SIC value to be included in the volume calculation. Grid cells with SIC ≤ <cite>sic_threshold</cite> are masked.
Defaults to <cite>self.icon_thresh</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total sea ice volume, optionally including grounded ice and scaled (e.g., in 1000 km³ if default scale is used).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>SIC, HI, and GC_area must share the same grid and be broadcastable.</p></li>
<li><p>Grid cells below <cite>sic_threshold</cite> are excluded from the volume calculation.</p></li>
<li><p>If <cite>self.use_gi</cite> is True, a grounded iceberg area is converted to volume and included.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_volume_rate">
<span class="sig-name descname"><span class="pre">compute_hemisphere_ice_volume_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DVT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dim_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sic_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.compute_hemisphere_ice_volume_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_ice_volume_rate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.compute_hemisphere_variable_aggregate">
<span class="sig-name descname"><span class="pre">compute_hemisphere_variable_aggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">da2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.compute_hemisphere_variable_aggregate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.compute_hemisphere_variable_aggregate" title="Link to this definition"></a></dt>
<dd><p>Compute a time-aggregated field from a DataArray across the specified time dimension.</p>
<p>This method calculates the mean of the input variable over time, with an optional
normalisation step based on the maximum value across the time dimension.
Designed for Dask-backed DataArrays to support scalable computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<em>xarray.DataArray</em>) – Input data array to aggregate over time. Typically a geophysical variable such as
sea ice thickness (m), strength (N/m), or velocity (m/s), with time as one of the dimensions.</p></li>
<li><p><strong>time_coord_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the time dimension to aggregate over. Default is ‘time’.</p></li>
<li><p><strong>flat_mean</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the data has simple mean over time, Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A time-aggregated version of the input array. If <cite>normalise_max</cite> is True,
the result represents the normalised mean occurrence across the time dimension;
otherwise, it is the simple time mean.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If the specified <cite>time_coord_name</cite> is not found in the input DataArray,</p></li>
</ul>
<p>the original array is returned with a warning.
- If <cite>normalise_max</cite> is enabled, the output represents a relative frequency-like
measure, especially useful for thresholded or binary input fields (e.g., fast ice presence).
- Assumes that all non-time dimensions are to be preserved in the output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.compute_sea_ice_metrics">
<span class="sig-name descname"><span class="pre">compute_sea_ice_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_mets_zarr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_area_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.compute_sea_ice_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.compute_sea_ice_metrics" title="Link to this definition"></a></dt>
<dd><p>Compute sea ice metrics from a processed sea ice simulation and compare against observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da_dict</strong> (<em>dict</em>) – Dictionary containing xarray DataArrays or Datasets for the fields:
‘aice’, ‘hi’, ‘tarea’, and a corresponding mask (‘FI_mask’, ‘PI_mask’, or ‘SI_mask’).</p></li>
<li><p><strong>ice_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of ice to process (e.g., ‘FI’, ‘FI_BT_bin’, etc.). Will be cleaned internally.</p></li>
<li><p><strong>dt0_str</strong> (<em>str</em><em>, </em><em>optional</em>) – Start date of the analysis window in ‘YYYY-MM-DD’. Defaults to self.dt0_str.</p></li>
<li><p><strong>dtN_str</strong> (<em>str</em><em>, </em><em>optional</em>) – End date of the analysis window in ‘YYYY-MM-DD’. Defaults to self.dtN_str.</p></li>
<li><p><strong>P_mets_zarr</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Path to save Zarr archive of computed metrics. If None, uses default path.</p></li>
<li><p><strong>ice_area_scale</strong> (<em>float</em><em>, </em><em>optional</em>) – Scaling factor to apply to the area field. Defaults to self.FIC_scale.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset containing time series, spatial, and summary metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.compute_seasonal_statistics">
<span class="sig-name descname"><span class="pre">compute_seasonal_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stat_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'FIA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_onset_doy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_retreat_doy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">240</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">growth_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(71,</span> <span class="pre">273)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retreat_early_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(273,</span> <span class="pre">330)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retreat_late_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">((331,</span> <span class="pre">365),</span> <span class="pre">(1,</span> <span class="pre">71))</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_leap_day</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_per_year</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.compute_seasonal_statistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.compute_seasonal_statistics" title="Link to this definition"></a></dt>
<dd><p>Fast version that loads once, computes derivatives once per year, and uses NumPy slicing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<em>xr.DataArray  # 1D</em><em>, </em><em>daily</em><em>, </em><em>with 'time'</em>)</p></li>
<li><p><strong>window</strong> (<em>as before</em>)</p></li>
<li><p><strong>polyorder</strong> (<em>as before</em>)</p></li>
<li><p><strong>min_onset_doy</strong> (<em>as before</em>)</p></li>
<li><p><strong>min_retreat_doy</strong> (<em>as before</em>)</p></li>
<li><p><strong>growth_range</strong> (<em>as before</em>)</p></li>
<li><p><strong>retreat_early_range</strong> (<em>as before</em>)</p></li>
<li><p><strong>retreat_late_range</strong> (<em>as before</em>)</p></li>
<li><p><strong>scaling_factor</strong> (<em>float  # multiplies slopes for nicer units</em>)</p></li>
<li><p><strong>drop_leap_day</strong> (<em>bool    # remove Feb 29 to keep DOY logic simple</em>)</p></li>
<li><p><strong>return_per_year</strong> (<em>bool  # also return a per-year table if True</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>summary</strong> (<em>dict[str, float | None]</em>)</p></li>
<li><p><strong>(optional) per_year</strong> (<em>pandas.DataFrame  # one row per year (except last, by design)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.compute_sector_FIA">
<span class="sig-name descname"><span class="pre">compute_sector_FIA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FI_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sector_defs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GI_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.compute_sector_FIA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.compute_sector_FIA" title="Link to this definition"></a></dt>
<dd><p>Backwards-compatible wrapper for fast-ice area (FIA).</p>
<p>For new workflows, prefer <cite>compute_sector_ice_area</cite>, which is ice-type agnostic.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.compute_sector_ice_area">
<span class="sig-name descname"><span class="pre">compute_sector_ice_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sector_defs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GI_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.compute_sector_ice_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.compute_sector_ice_area" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.compute_skill_statistics">
<span class="sig-name descname"><span class="pre">compute_skill_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.compute_skill_statistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.compute_skill_statistics" title="Link to this definition"></a></dt>
<dd><p>Compute statistical skill metrics between model and observational time series.
If time alignment fails and <cite>climatology_if_mismatch</cite> is True, computes climatological
skill instead (e.g., using day-of-year climatologies).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mod</strong> (<em>xarray.DataArray; Time series</em><em> of </em><em>modelled values.</em>)</p></li>
<li><p><strong>obs</strong> (<em>xarray.DataArray; Time series</em><em> of </em><em>observed values</em><em> (</em><em>must be aligned with model</em><em>, or </em><em>climatology is used</em><em>)</em><em>.</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict; Dictionary of skill metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.extrema_means_antarctic_year">
<span class="sig-name descname"><span class="pre">extrema_means_antarctic_year</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da_ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.extrema_means_antarctic_year"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.extrema_means_antarctic_year" title="Link to this definition"></a></dt>
<dd><p>da_ts: 1-D (time,) fast-ice area time series (km^2).
Returns dict with:
- max_mean: mean of per-AY maxima
- min_mean: mean of per-AY minima
- max_ts  : per-AY maxima time series (indexed by ‘ayear’)
- min_ts  : per-AY minima time series (indexed by ‘ayear’)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.fast_ice_metrics_data_dict">
<span class="sig-name descname"><span class="pre">fast_ice_metrics_data_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FI_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FI_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.fast_ice_metrics_data_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.fast_ice_metrics_data_dict" title="Link to this definition"></a></dt>
<dd><p>Utility function to create the dictionary for each FI type (dy, rl, bn).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.load_computed_metrics">
<span class="sig-name descname"><span class="pre">load_computed_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fast_ice_class_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'binary-days'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BorC2T_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ispd_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zarr_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_to_self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'time'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.load_computed_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.load_computed_metrics" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.pack_ice_metrics_data_dict">
<span class="sig-name descname"><span class="pre">pack_ice_metrics_data_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PI_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PI_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.pack_ice_metrics_data_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.pack_ice_metrics_data_dict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.persistence_ice_distance_mean_max">
<span class="sig-name descname"><span class="pre">persistence_ice_distance_mean_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice_prstnc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistence_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_coast_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crs_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'EPSG:3031'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.persistence_ice_distance_mean_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.persistence_ice_distance_mean_max" title="Link to this definition"></a></dt>
<dd><p>Mean/max distance from the USNIC/ADD coastline for persistent fast ice.
Uses a densified coastline KD-Tree in a metric CRS (default EPSG:3031).</p>
<p>Assumes <cite>ice_prstnc</cite> is a persistence field in [0..1] computed from a
binary fast-ice mask over the austral-winter window (e.g., May–Oct).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.persistence_stability_index">
<span class="sig-name descname"><span class="pre">persistence_stability_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistence_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">winter_months</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(5,</span> <span class="pre">6,</span> <span class="pre">7,</span> <span class="pre">8,</span> <span class="pre">9,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000000000.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.persistence_stability_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.persistence_stability_index" title="Link to this definition"></a></dt>
<dd><p>Compute FIPSI (Fast-Ice Persistence Stability Index) from a binary fast-ice mask.</p>
<section id="definition">
<h3>Definition<a class="headerlink" href="#definition" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>FIPSI = (area of grid cells whose WINTER fast-ice persistence ≥ threshold)</dt><dd><p>/ (area of grid cells that have fast ice at least once in WINTER),</p>
</dd>
</dl>
<p>where persistence is the fraction of winter days (e.g., May–Oct) that a cell is fast.</p>
<dl class="field-list simple">
<dt class="field-odd">param I_mask<span class="colon">:</span></dt>
<dd class="field-odd"><p>Binary fast-ice mask (0/1) with a ‘time’ dimension; if a Dataset is given,
a variable named ‘FI_mask’ is used.</p>
</dd>
<dt class="field-even">type I_mask<span class="colon">:</span></dt>
<dd class="field-even"><p>xarray.DataArray or xarray.Dataset</p>
</dd>
<dt class="field-odd">param A<span class="colon">:</span></dt>
<dd class="field-odd"><p>Grid-cell area on the same grid; if a Dataset is given, the first of
{‘tarea’,’area’,’TAREA’} is used. If A has a ‘time’ dim, the first slice is used.</p>
</dd>
<dt class="field-even">type A<span class="colon">:</span></dt>
<dd class="field-even"><p>xarray.DataArray or xarray.Dataset</p>
</dd>
<dt class="field-odd">param persistence_threshold<span class="colon">:</span></dt>
<dd class="field-odd"><p>Minimum winter persistence to classify a cell as persistent (default 0.8).</p>
</dd>
<dt class="field-even">type persistence_threshold<span class="colon">:</span></dt>
<dd class="field-even"><p>float, optional</p>
</dd>
<dt class="field-odd">param winter_months<span class="colon">:</span></dt>
<dd class="field-odd"><p>Months to include for the winter persistence (default May–Oct).</p>
</dd>
<dt class="field-even">type winter_months<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[int], optional</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>{‘persistence_stability_index’: float,   # FIPSI in [0,1] or NaN if undefined</dt><dd><p>‘area_persistent_winter’: float,        # area of persistent winter FI (units of A)
‘area_ever_winter’: float               # area with any winter FI (units of A)}</p>
</dd>
</dl>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses the class’s <cite>spatial_dims</cite> to sum areas.</p></li>
<li><p>Assumes <cite>I_mask</cite> is truly binary (0/1). For classification outputs that are boolean, they will be cast to float internally.</p></li>
<li><p>Designed to be Dask-friendly: only two area reductions are computed eagerly.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_metrics.SeaIceMetrics.sea_ice_metrics_data_dict">
<span class="sig-name descname"><span class="pre">sea_ice_metrics_data_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SI_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SI_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_metrics.html#SeaIceMetrics.sea_ice_metrics_data_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_metrics.SeaIceMetrics.sea_ice_metrics_data_dict" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sea_ice_plotter">
<span id="sea-ice-plotter"></span><h2>sea_ice_plotter<a class="headerlink" href="#module-sea_ice_plotter" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sea_ice_plotter.</span></span><span class="sig-name descname"><span class="pre">SeaIcePlotter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.create_IBCSO_bath">
<span class="sig-name descname"><span class="pre">create_IBCSO_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.create_IBCSO_bath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.create_IBCSO_bath" title="Link to this definition"></a></dt>
<dd><p>Extract and save a masked IBCSO bathymetry layer for Antarctic plotting.</p>
<p>This method loads the IBCSO v2.0 dataset (as a NetCDF raster), extracts
the seafloor depth (negative elevations), masks out land areas (positive or zero),
and saves a cleaned version to NetCDF for use in plotting.</p>
<p>The result is saved at the path specified in
<cite>self.config[‘pygmt_dict’][‘P_IBCSO_bath’]</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Input file is assumed to be a NetCDF raster with variable <cite>band_data</cite>.</p></li>
<li><p>Only <cite>band=0</cite> is used (i.e., the main bathymetric band).</p></li>
<li><p>Output variable is named <cite>bath</cite> and excludes attributes and encodings for simplicity.</p></li>
<li><p>This method is typically called once to prepare the bathymetry layer before reuse.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.create_cbar_frame">
<span class="sig-name descname"><span class="pre">create_cbar_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend_cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ann_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.create_cbar_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.create_cbar_frame" title="Link to this definition"></a></dt>
<dd><p>Construct a GMT-style colorbar annotation frame string for PyGMT plotting.</p>
<p>This utility generates a clean, readable colorbar frame string using adaptive
step sizing based on the data range. An optional second axis label (e.g., for units)
and extension arrows can be included.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<em>list</em><em> or </em><em>tuple</em><em> of </em><em>float</em>) – Data range for the colorbar as [vmin, vmax].</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Label text for the colorbar (e.g., “Fast Ice Persistence”).</p></li>
<li><p><strong>units</strong> (<em>str</em><em>, </em><em>optional</em>) – Units label to be shown along the secondary (y) axis (e.g., “1/100”).</p></li>
<li><p><strong>extend_cbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to append extension arrows to the colorbar (+e). Default is False.</p></li>
<li><p><strong>max_ann_steps</strong> (<em>int</em><em>, </em><em>default=10</em>) – Desired maximum number of major annotations (controls tick spacing).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>GMT-format colorbar annotation string (e.g., “a0.1f0.02+lLabel”), or
a list of two strings if <cite>units</cite> is provided.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str or list of str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Tick spacing is determined using a scaled logarithmic rounding to ensure clean steps (e.g., 0.1, 0.2, 0.5).</p></li>
<li><p>If <cite>extend_cbar</cite> is True, <cite>+e</cite> is added to indicate out-of-bounds extension arrows.</p></li>
<li><p>Compatible with <cite>pygmt.Figure.colorbar(frame=…)</cite>.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">create_cbar_frame</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;Persistence&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;1/100&quot;</span><span class="p">)</span>
<span class="go">[&#39;a0.1f0.02+lPersistence&#39;, &#39;y+l 1/100&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.extract_min_max_dates">
<span class="sig-name descname"><span class="pre">extract_min_max_dates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys2plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'FIA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.extract_min_max_dates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.extract_min_max_dates" title="Link to this definition"></a></dt>
<dd><p>Extract the minimum and maximum datetime values from time series data.</p>
<p>This method scans through a dictionary of time series objects (either xarray.DataArrays,
xarray.Datasets, or nested dictionaries containing a DataArray under <cite>primary_key</cite>),
and returns the earliest and latest valid time values found across all selected entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts_dict</strong> (<em>dict</em>) – A dictionary where each value is either:
- an xarray.DataArray with a <cite>time_coord</cite> coordinate, or
- a dictionary containing a DataArray under the key <cite>primary_key</cite>.
Keys typically represent simulation or experiment identifiers.</p></li>
<li><p><strong>keys2plot</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – If provided, restricts the operation to keys within this list.
Keys not in <cite>keys2plot</cite> will be skipped.</p></li>
<li><p><strong>primary_key</strong> (<em>str</em><em>, </em><em>default 'FIA'</em>) – The key to use when accessing nested dictionaries within <cite>ts_dict</cite>.
Ignored if the value is already a DataArray or Dataset.</p></li>
<li><p><strong>time_coord</strong> (<em>str</em><em>, </em><em>default 'time'</em>) – The name of the time coordinate to extract from each DataArray.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tmin</strong> (<em>pandas.Timestamp</em>) – The earliest datetime found across all valid time series.</p></li>
<li><p><strong>tmax</strong> (<em>pandas.Timestamp</em>) – The latest datetime found across all valid time series.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Entries in <cite>ts_dict</cite> with missing or malformed time coordinates are skipped.</p></li>
<li><p>The key “AF2020” is always excluded.</p></li>
<li><p>If no valid entries remain after filtering, a warning is logged and <cite>None</cite> is returned.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.generate_regional_annotation_stats">
<span class="sig-name descname"><span class="pre">generate_regional_annotation_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_coord_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_coord_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.generate_regional_annotation_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.generate_regional_annotation_stats" title="Link to this definition"></a></dt>
<dd><p>Generate summary statistics (mean, std, min, max) and their locations within a geographic region.</p>
<p>This helper function extracts the portion of a 2D <cite>xarray.DataArray</cite> that falls within a given
geographic bounding box, computes spatial statistics on valid (non-NaN) values, and formats
the results for annotation in PyGMT plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<em>xarray.DataArray</em>) – 2D gridded data array (e.g., fast ice persistence) with latitude and longitude coordinates.</p></li>
<li><p><strong>region</strong> (<em>list</em><em> or </em><em>tuple</em><em> of </em><em>float</em>) – Bounding box for the region in the form [lon_min, lon_max, lat_min, lat_max].</p></li>
<li><p><strong>lon_coord_name</strong> (<em>str</em>) – Name of the longitude coordinate in <cite>da</cite> (e.g., ‘TLON’).</p></li>
<li><p><strong>lat_coord_name</strong> (<em>str</em>) – Name of the latitude coordinate in <cite>da</cite> (e.g., ‘TLAT’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Formatted text lines with:
- Mean
- Standard deviation
- Data extent (number of valid grid cells)
- Minimum value and its lat/lon location
- Maximum value and its lat/lon location</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Longitude and latitude slices are derived using <cite>np.searchsorted</cite>, assuming monotonic grid coordinates.</p></li>
<li><p>Only finite (non-NaN) values are included in statistics.</p></li>
<li><p>Output is intended to be used directly in <cite>fig.text()</cite> or <cite>fig.legend()</cite> in PyGMT plotting routines.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_regional_annotation_stats</span><span class="p">(</span><span class="n">FIP_DA</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">75</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">],</span> <span class="n">lon_coord_name</span><span class="o">=</span><span class="s1">&#39;TLON&#39;</span><span class="p">,</span> <span class="n">lat_coord_name</span><span class="o">=</span><span class="s1">&#39;TLAT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="go">Mean: 0.73</span>
<span class="go">Std: 0.18</span>
<span class="go">Extent: 1246</span>
<span class="go">Min:  0.02 at (-68.41, 23.65)</span>
<span class="go">Max: 1.00 at (-66.82, 45.12)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.get_meridian_center_from_geographic_extent">
<span class="sig-name descname"><span class="pre">get_meridian_center_from_geographic_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geographic_extent</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.get_meridian_center_from_geographic_extent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.get_meridian_center_from_geographic_extent" title="Link to this definition"></a></dt>
<dd><p>Determine the optimal central meridian for PyGMT polar stereographic projections.</p>
<p>Given a geographic extent in longitude/latitude format, this method calculates
the central meridian (longitude) to use in ‘S&lt;lon&gt;/&lt;lat&gt;/&lt;width&gt;’ PyGMT projection
strings. It accounts for dateline wrapping and ensures the plot is centered visually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>geographic_extent</strong> (<em>list</em><em> of </em><em>float</em>) – Geographic region as [min_lon, max_lon, min_lat, max_lat]. Accepts longitudes in
either [-180, 180] or [0, 360] and gracefully handles dateline crossing.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Central meridian (longitude) in the range [-180, 180].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><dl class="simple">
<dt>If the computed center falls outside the intended range (e.g., due to dateline wrapping),</dt><dd><p>the method rotates the meridian 180° to better align the figure.</p>
</dd>
</dl>
</li>
<li><p>The result is saved to <cite>self.plot_meridian_center</cite> for reuse.</p></li>
<li><p>Used in PyGMT stereographic projections like <cite>‘S{lon}/-90/30c’</cite>.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.load_IBCSO_bath">
<span class="sig-name descname"><span class="pre">load_IBCSO_bath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.load_IBCSO_bath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.load_IBCSO_bath" title="Link to this definition"></a></dt>
<dd><p>Load masked IBCSO bathymetry dataset prepared by <cite>create_IBCSO_bath()</cite>.</p>
<p>Returns the <cite>bath</cite> variable from the NetCDF file specified in
<cite>self.config[‘pygmt_dict’][“P_IBCSO_bath”]</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D array of bathymetry values (only ocean depths, in meters).
Values are negative below sea level, NaN over land.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>xarray.DataArray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This method assumes that <cite>create_IBCSO_bath()</cite> has already been run.</p></li>
<li><p>Designed for use in PyGMT background plotting or masking.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.load_ice_shelves">
<span class="sig-name descname"><span class="pre">load_ice_shelves</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.load_ice_shelves"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.load_ice_shelves" title="Link to this definition"></a></dt>
<dd><p>Load and preprocess Antarctic ice shelf polygons for PyGMT plotting.</p>
<p>This method reads a shapefile containing Antarctic coastal geometries,
filters for polygons classified as ice shelves (<cite>POLY_TYPE == ‘S’</cite>),
ensures valid geometry, reprojects them to WGS84 (EPSG:4326),
and applies a zero-width buffer to clean topology issues.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Cleaned and reprojected geometries of Antarctic ice shelves.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>geopandas.GeoSeries</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The input shapefile path is read from <cite>self.config[‘pygmt_dict’][‘P_coast_shape’]</cite>.</p></li>
<li><p>This method is typically used to overlay ice shelf boundaries in PyGMT plots.</p></li>
<li><p>The returned geometries can be passed directly to <cite>pygmt.Figure.plot()</cite>.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.plot_taylor">
<span class="sig-name descname"><span class="pre">plot_taylor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stats_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.plot_taylor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.plot_taylor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.pygmt_FIP_figure">
<span class="sig-name descname"><span class="pre">pygmt_FIP_figure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_png</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">360,</span> <span class="pre">-90,</span> <span class="pre">-62)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'S0.0/-90.0/50/20c'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basemap_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('af',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">land_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#666666'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#BABCDE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shoreline_pen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1/0.25p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_pt_marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_pt_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.05'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_pt_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tricolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_tricolor_cpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tricolor_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_cat_cpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('Agreement',</span> <span class="pre">'Model-dominant',</span> <span class="pre">'Obs.-dominant')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('#FDAE61',</span> <span class="pre">'#2CA25F',</span> <span class="pre">'#2171B5')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'JBC+w15c/1c+mc+h'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('xa0.2f0.05+lFast</span> <span class="pre">Ice</span> <span class="pre">Persistence',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_cbar_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('+lFIP</span> <span class="pre">difference</span> <span class="pre">category',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transparency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_da</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transparency_from</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_transparency_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_GI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GI_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#E349D0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GI_marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GI_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.01'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GI_pt_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.pygmt_FIP_figure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.pygmt_FIP_figure" title="Link to this definition"></a></dt>
<dd><p>A single entry point for:
- single-source FIP (continuous)
- diff continuous (tri-color + alpha)
- diff categorical (0/1/2)</p>
<p>Notes:
- Uses binned transparency for robustness (multiple fig.plot calls).
- If obs/mod provided and tricolor=True: computes z,t internally.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.pygmt_da_prep">
<span class="sig-name descname"><span class="pre">pygmt_da_prep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcoords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tcoords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_coord_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_coord_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_wrap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_zero</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_clip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_range_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'float32'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_flat_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.pygmt_da_prep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.pygmt_da_prep" title="Link to this definition"></a></dt>
<dd><p>Returns a dict with 1D arrays for PyGMT plotting.</p>
<p>Always returns: lon, lat, z
Optionally returns:
- mask2d: 2D boolean mask on da2 grid
- flat_idx: 1D integer indices into da2.ravel() where mask is True
- shape: original 2D shape (for sanity checks)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.pygmt_fastice_panel">
<span class="sig-name descname"><span class="pre">pygmt_fastice_panel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fast_ice_variable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'FIA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'bin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roll_days</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_bndy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yaxis_pri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xaxis_pri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'a1Of15Dg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leg_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leg_box</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'+gwhite+p.5p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spat_var_style</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GI_plot_style</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'c0.05c'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GI_fill_color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'#BA561A'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_GI</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_max_trans_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yshift_top</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yshift_bot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom_frame_bndy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'WSne'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom_yaxis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom_xaxis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">land_clr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'#D1DDE0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_clr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'#EDF2F5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coast_pen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'1/0.5p,black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_coord_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_coord_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_frame</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ANT_IS_pen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0.2p,black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ANT_IS_color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'#C1CED6'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_annot_pri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'24p,Times-Roman'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_annot_sec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'16p,Times-Roman'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_lab</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'22p,Times-Bold'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_pen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'2p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_pen_pri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.5p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_pen_sec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.25p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt_geo_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'D:mm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_png</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.pygmt_fastice_panel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.pygmt_fastice_panel" title="Link to this definition"></a></dt>
<dd><p>Unified PyGMT fast-ice panel plotter.</p>
<dl class="simple">
<dt>Set <cite>fast_ice_variable</cite> to:</dt><dd><ul class="simple">
<li><p>“FIA” (or “fia”)  -&gt; plots FIA time series + FIP maps</p></li>
<li><p>“FIT” (or “fit”)  -&gt; plots FIT time series + FIHI maps</p></li>
</ul>
</dd>
</dl>
<p>Everything else (loading, styling, legends, grounded iceberg overlay, etc.)
follows the same code path with variable-specific defaults injected via
a small configuration dictionary.</p>
<p>The rest of the arguments let you override those defaults if you need to.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.pygmt_map_plot_multi_var_8sectors">
<span class="sig-name descname"><span class="pre">pygmt_map_plot_multi_var_8sectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">das</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_stamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tit_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">panel_titles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_GI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_units_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend_cbars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_coord_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_coord_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bcoords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_tcoords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_sq_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GI_sq_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GI_fill_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_iceshelves</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">land_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_png</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w+1c'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.pygmt_map_plot_multi_var_8sectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.pygmt_map_plot_multi_var_8sectors" title="Link to this definition"></a></dt>
<dd><p>8-sector plot with 2–3 panels laid out left-to-right using shift_origin.</p>
<p>Performance: compute PyGMT plot point clouds ONCE per panel (u1/u2/du),
then sector-filter the point clouds cheaply (no repeated Dask compute).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.pygmt_map_plot_one_var">
<span class="sig-name descname"><span class="pre">pygmt_map_plot_one_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_regions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regional_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemisphere</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'south'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_stamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tit_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_GI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend_cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_coord_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bcoords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_tcoords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_sq_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GI_sq_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GI_fill_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_iceshelves</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_stat_annot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">land_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_png</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.pygmt_map_plot_one_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.pygmt_map_plot_one_var" title="Link to this definition"></a></dt>
<dd><p>Generate a PyGMT figure showing a variable (e.g., FIA, FIP, differences) as a spatial map
over Antarctic regions or hemispheric view, optionally including grounded icebergs,
ice shelf outlines, and bathymetry.</p>
<p>This flexible mapping function supports multiple types of visualizations:
- Scalar field plots (e.g., fast ice persistence, concentration)
- Binary or categorical masks (e.g., agreement maps, simulation masks)
- Difference plots (e.g., observation minus simulation)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<em>xarray.DataArray</em>) – Input 2D (or broadcastable) data array to be plotted, e.g., fast ice persistence.</p></li>
<li><p><strong>var_name</strong> (<em>str</em>) – Name of the variable to be plotted. Used to look up color map settings and labels.</p></li>
<li><p><strong>sim_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Simulation name used for file naming and figure annotation. Defaults to <cite>self.sim_name</cite>.</p></li>
<li><p><strong>plot_regions</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Number of regional plots:
- 8 : Antarctic 8-sector view
- 2 : East/West sectors
- None : Full hemisphere plot (default)</p></li>
<li><p><strong>regional_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Custom dictionary of plotting regions (overrides built-ins if provided).</p></li>
<li><p><strong>hemisphere</strong> (<em>str</em><em>, </em><em>default=&quot;south&quot;</em>) – Hemisphere name for hemispheric plot. Typically “south”.</p></li>
<li><p><strong>time_stamp</strong> (<em>str</em><em>, </em><em>optional</em>) – Timestamp string for file naming. Defaults to <cite>self.dt0_str</cite>.</p></li>
<li><p><strong>tit_str</strong> (<em>str</em><em>, </em><em>optional</em>) – Title string to display on the figure.</p></li>
<li><p><strong>plot_GI</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to overlay grounded iceberg locations using <cite>load_GI_lon_lats()</cite>.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Color map name for continuous scalar plots.</p></li>
<li><p><strong>series</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Min, max, and increment for the colorbar (e.g., [0, 1, 0.1]).</p></li>
<li><p><strong>reverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to reverse the colormap.</p></li>
<li><p><strong>cbar_label</strong> (<em>str</em><em>, </em><em>optional</em>) – Label to show on the colorbar.</p></li>
<li><p><strong>cbar_units</strong> (<em>str</em><em>, </em><em>optional</em>) – Units for the colorbar (shown on secondary axis).</p></li>
<li><p><strong>extend_cbar</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to add extension arrows to colorbar.</p></li>
<li><p><strong>cbar_position</strong> (<em>str</em><em>, </em><em>optional</em>) – PyGMT-compatible position string for placing the colorbar.</p></li>
<li><p><strong>lon_coord_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Longitude coordinate name in <cite>da</cite>. Defaults to <cite>self.pygmt_dict</cite>.</p></li>
<li><p><strong>lat_coord_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Latitude coordinate name in <cite>da</cite>. Defaults to <cite>self.pygmt_dict</cite>.</p></li>
<li><p><strong>fig_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Figure width in centimeters for hemispheric plot.</p></li>
<li><p><strong>var_sq_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Marker size (in cm) for main plotted variable (for scatter plotting).</p></li>
<li><p><strong>GI_sq_size</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Marker size (in cm) for grounded iceberg overlay.</p></li>
<li><p><strong>GI_fill_color</strong> (<em>str</em><em>, </em><em>default=&quot;red&quot;</em>) – Color to use for grounded iceberg markers.</p></li>
<li><p><strong>plot_iceshelves</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to overlay Antarctic ice shelf outlines.</p></li>
<li><p><strong>plot_bathymetry</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to plot IBCSO bathymetry using shaded relief (<cite>grdimage</cite>).</p></li>
<li><p><strong>add_stat_annot</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to annotate figure with basic regional statistics.</p></li>
<li><p><strong>land_color</strong> (<em>str</em><em>, </em><em>optional</em>) – Color for land. Defaults to <cite>self.pygmt_dict[‘land_color’]</cite>.</p></li>
<li><p><strong>water_color</strong> (<em>str</em><em>, </em><em>optional</em>) – Color for ocean/water. Defaults to <cite>self.pygmt_dict[‘water_color’]</cite>.</p></li>
<li><p><strong>P_png</strong> (<em>pathlib.Path</em><em>, </em><em>optional</em>) – File path to save the figure. If None, path is generated automatically.</p></li>
<li><p><strong>var_out</strong> (<em>str</em><em>, </em><em>optional</em>) – Output variable name used in file naming. Defaults to <cite>var_name</cite>.</p></li>
<li><p><strong>overwrite_fig</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to overwrite existing figure if it exists.</p></li>
<li><p><strong>show_fig</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to display the figure interactively.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The method generates and optionally saves or displays a PyGMT figure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Supports 8-region, 2-region, or full hemisphere plotting via <cite>plot_regions</cite>.</p></li>
<li><p>For “diff” plots (where ‘diff’ in var_name), colors are assigned categorically (e.g., agreement/simulation/observation).</p></li>
<li><p>Bathymetry and ice shelf overlays are loaded from NetCDF and shapefiles respectively.</p></li>
<li><p>The method gracefully skips plotting if required coordinates or data are missing.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">pygmt_map_plot_one_var</span><span class="p">(</span><span class="n">FIP_DA</span><span class="p">,</span> <span class="s2">&quot;FIP&quot;</span><span class="p">,</span> <span class="n">plot_regions</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.pygmt_timeseries">
<span class="sig-name descname"><span class="pre">pygmt_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'FIA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_smooth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">climatology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1000]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yaxis_pri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytick_pri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytick_sec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xaxis_pri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xaxis_sec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_bndy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'WS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_box</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'+gwhite+p0.5p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt_dt_pri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt_dt_sec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt_dt_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnt_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Helvetica'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnt_wght_lab</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'20p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnt_wght_ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'18p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_pen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'1p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_wght_pri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.25p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_wght_sec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.1p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_png</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_coord</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'time'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_coord_alt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys2plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'inside_others'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat_ref_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_x_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_line</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_line_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_line_pen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'2p,black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.pygmt_timeseries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.pygmt_timeseries" title="Link to this definition"></a></dt>
<dd><p>Plot time series of a primary variable (e.g., FIA) for a set of simulations or observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts_dict</strong> (<em>dict</em>) – Dictionary of xarray DataArrays keyed by simulation or dataset name.</p></li>
<li><p><strong>comp_name</strong> (<em>str</em>) – Name for the comparison (used in figure title and filename).</p></li>
<li><p><strong>primary_key</strong> (<em>str</em>) – Key used to extract the variable from each dataset (except ‘AF2020’).</p></li>
<li><p><strong>climatology</strong> (<em>bool</em>) – If True, plot daily climatology with fill and mean lines.</p></li>
<li><p><strong>ylim</strong> (<em>tuple</em><em> or </em><em>None</em>) – Y-axis limits. If None, inferred from data with 5% padding.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em>) – Label for the Y-axis.</p></li>
<li><p><strong>ytick_inc</strong> (<em>int</em>) – Interval between Y-axis ticks.</p></li>
<li><p><strong>xaxis_pri</strong> (<em>str</em>) – GMT frame settings for primary and secondary axes (when climatology is False).</p></li>
<li><p><strong>xaxis_sec</strong> (<em>str</em>) – GMT frame settings for primary and secondary axes (when climatology is False).</p></li>
<li><p><strong>P_png</strong> (<em>str</em><em> or </em><em>None</em>) – Optional full path to save figure. If None, default filename is constructed.</p></li>
<li><p><strong>legend_box</strong> (<em>str</em>) – GMT legend box styling.</p></li>
<li><p><strong>line_pen</strong> (<em>str</em>) – Line thickness for plotted time series.</p></li>
<li><p><strong>time_coord</strong> (<em>str</em>) – Name of time coordinate in each DataArray.</p></li>
<li><p><strong>keys2plot</strong> (<em>list</em><em> or </em><em>None</em>) – If provided, only datasets with keys in this list are plotted.</p></li>
<li><p><strong>show_fig</strong> (<em>bool</em><em> or </em><em>None</em>) – If True, show figure interactively. Defaults to self.show_fig.</p></li>
<li><p><strong>repeat_keys</strong> (<em>list</em><em>[</em><em>str</em><em>] or </em><em>None</em>) – Keys in <cite>ts_dict</cite> to plot as a repeated day-of-year climatology when
<cite>climatology=False</cite>.</p></li>
<li><p><strong>repeat_policy</strong> (<em>{&quot;outside_others&quot;</em><em>,</em><em>&quot;fill_gaps&quot;</em><em>,</em><em>&quot;always&quot;}</em>) – <ul>
<li><p>“outside_others”: keep original values where <em>other</em> series exist in time,</p></li>
</ul>
<p>but replace values outside that union with day-of-year climatology of
the nominated series (good for fair comparison).
- “fill_gaps”: use climatology only where the nominated series has no data,
keep original where it does.
- “always”: ignore original values and plot the repeated climatology across
the full x-range.</p>
</p></li>
<li><p><strong>repeat_ref_keys</strong> (<em>list</em><em>[</em><em>str</em><em>] or </em><em>None</em>) – If provided, these keys define the “others” time span for the
“outside_others” policy. By default, it’s all plotted series except the
current one.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.tricolor_cpt_and_alpha">
<span class="sig-name descname"><span class="pre">tricolor_cpt_and_alpha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_cpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'#2CA25F'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'#FDAE61'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'#2171B5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'obs-mod'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_power</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_floor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_transparency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.tricolor_cpt_and_alpha"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.tricolor_cpt_and_alpha" title="Link to this definition"></a></dt>
<dd><p>Returns (cpt_path, z, t)
z: clipped difference in [vmin,vmax]
t: transparency percent in [0,100] (0 opaque)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.write_tricolor_category_cpt">
<span class="sig-name descname"><span class="pre">write_tricolor_category_cpt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_cpt</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">int0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1.0,</span> <span class="pre">2.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2.0,</span> <span class="pre">3.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hex0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#FDAE61'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hex1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#2CA25F'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hex2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#2171B5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_rgb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'255/255/255'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_rgb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0/0/0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_rgb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'255/255/255'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.write_tricolor_category_cpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.write_tricolor_category_cpt" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_plotter.SeaIcePlotter.write_tricolour_cpt">
<span class="sig-name descname"><span class="pre">write_tricolour_cpt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_cpt</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'#2CA25F'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'#FDAE61'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'#2171B5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_rgb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'255/255/255'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_rgb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0/0/0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_rgb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'255/255/255'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/sea_ice_plotter.html#SeaIcePlotter.write_tricolour_cpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_plotter.SeaIcePlotter.write_tricolour_cpt" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sea_ice_regridder">
<span id="sea-ice-regridder"></span><h2>sea_ice_regridder<a class="headerlink" href="#module-sea_ice_regridder" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sea_ice_regridder.</span></span><span class="sig-name descname"><span class="pre">SeaIceRegridder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder.add_lonlat_from_epsg3031">
<span class="sig-name descname"><span class="pre">add_lonlat_from_epsg3031</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0..360'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float32'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder.add_lonlat_from_epsg3031"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder.add_lonlat_from_epsg3031" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder.define_reG_weights">
<span class="sig-name descname"><span class="pre">define_reG_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder.define_reG_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder.define_reG_weights" title="Link to this definition"></a></dt>
<dd><p>Define and store an xESMF regridder to remap CICE B-grid (U-point) data to the T-grid.</p>
<p>This method constructs two CICE grids—one at the U-point (B-grid) and one at the T-point (centered)—using
internally defined grid definitions. It then either reuses existing xESMF regridding weights or creates
them if they do not already exist.</p>
<p>The resulting regridder is stored as <cite>self.reG</cite>, and a flag <cite>self.reG_weights_defined</cite> is set to True
upon successful creation or reuse of the regridder.</p>
<p>Grid details:
- The source grid (<cite>G_u</cite>) is built using U-point coordinates (<cite>grid_type=’u’</cite>).
- The target grid (<cite>G_t</cite>) is built using T-point coordinates (<cite>grid_type=’t’</cite>) and includes a land-sea mask.
- Both grids include corner information to support conservative or bilinear regridding.</p>
<p>Regridding parameters:
- Method: “bilinear”
- Periodic: True (assumes global grid)
- Degenerate cells: ignored
- Extrapolation: nearest-neighbor (source to destination)
- Weight reuse: enabled if existing file is found at path <cite>self.CICE_dict[“P_reG_u2t_weights”]</cite></p>
<p>Logging:
- Logs whether existing weights are reused or new weights are created.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The regridder is stored as <cite>self.reG</cite> and is not returned explicitly.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder.grid_coords_from_area">
<span class="sig-name descname"><span class="pre">grid_coords_from_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">area_def</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder.grid_coords_from_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder.grid_coords_from_area" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder.make_area_definition">
<span class="sig-name descname"><span class="pre">make_area_definition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'epsg3031_5km_union'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder.make_area_definition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder.make_area_definition" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder.pygmt_regrid">
<span class="sig-name descname"><span class="pre">pygmt_regrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'200k'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder.pygmt_regrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder.pygmt_regrid" title="Link to this definition"></a></dt>
<dd><p>Regrid a 2D data array using PyGMT’s nearneighbor interpolation.</p>
<p>This method applies PyGMT’s <cite>nearneighbor</cite> algorithm to interpolate scattered
data values (<cite>da</cite>) onto a regular grid based on specified longitude and latitude
arrays. The input is masked to ignore NaNs or non-finite values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<em>xarray.DataArray</em>) – 2D array of data values to interpolate (e.g., sea ice thickness).</p></li>
<li><p><strong>lon</strong> (<em>xarray.DataArray</em><em> or </em><em>np.ndarray</em>) – Longitude values corresponding to <cite>da</cite>, same shape.</p></li>
<li><p><strong>lat</strong> (<em>xarray.DataArray</em><em> or </em><em>np.ndarray</em>) – Latitude values corresponding to <cite>da</cite>, same shape.</p></li>
<li><p><strong>grid_res</strong> (<em>str</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – Grid spacing for the output grid (e.g., “0.5”, “10m”). Required by PyGMT.</p></li>
<li><p><strong>region</strong> (<em>list</em><em> or </em><em>tuple</em><em>, </em><em>optional</em>) – Bounding box for the output grid in the form [west, east, south, north].</p></li>
<li><p><strong>search_radius</strong> (<em>str</em><em> or </em><em>float</em><em>, </em><em>default &quot;200k&quot;</em>) – Search radius for PyGMT’s nearneighbor (e.g., “100k” for 100 km).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gridded</strong> – Gridded output with interpolated values over the defined region.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>All non-finite values in <cite>da</cite> are excluded prior to interpolation.</p></li>
<li><p>PyGMT must be properly installed and configured with GMT for this to work.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder.reG_bgrid_to_tgrid_xesmf">
<span class="sig-name descname"><span class="pre">reG_bgrid_to_tgrid_xesmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder.reG_bgrid_to_tgrid_xesmf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder.reG_bgrid_to_tgrid_xesmf" title="Link to this definition"></a></dt>
<dd><p>Regrid a single B-grid DataArray to the T-grid using pre-defined xESMF regridder.</p>
<p>If coord_names are not provided then assumes coordinate names provided in JSON configuration file,
which are like [“ULON”,”ULAT”]</p>
<p>INPUTS:
da : xr.DataArray; b-grid variable with coordinates coord_names</p>
<p>OUTPUTS:
xr.DataArray; re-gridded DataArray on the T-grid with dimensions (time, nj, ni).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder.resample_swath_to_area">
<span class="sig-name descname"><span class="pre">resample_swath_to_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_def</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder.resample_swath_to_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder.resample_swath_to_area" title="Link to this definition"></a></dt>
<dd><p>Nearest-neighbour resample a 2D swath (lat2d, lon2d) to an AreaDefinition grid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder.simple_spatial_averaging_bgrid_to_tgrid">
<span class="sig-name descname"><span class="pre">simple_spatial_averaging_bgrid_to_tgrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder.simple_spatial_averaging_bgrid_to_tgrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder.simple_spatial_averaging_bgrid_to_tgrid" title="Link to this definition"></a></dt>
<dd><p>Dask-safe 4-point unweighted average from B-grid to T-grid.</p>
<p>Uses efficient array shifting and avoids costly concatenation over new dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> (<em>xr.DataArray</em>) – 2D or 3D (time, nj, ni) array on B-grid.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Averaged field on T-grid with shape (time, nj, ni).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder.snap_extent_to_grid">
<span class="sig-name descname"><span class="pre">snap_extent_to_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder.snap_extent_to_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder.snap_extent_to_grid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder.subset_by_lonlat_box">
<span class="sig-name descname"><span class="pre">subset_by_lonlat_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TLON'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TLAT'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nj'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ni'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-180-180'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder.subset_by_lonlat_box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder.subset_by_lonlat_box" title="Link to this definition"></a></dt>
<dd><p>Subset a curvilinear grid by a geographic box. Works with dask.
If the lon_range crosses the seam (e.g. (350, 20) in 0..360), it handles it.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder.to_3031_extent">
<span class="sig-name descname"><span class="pre">to_3031_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder.to_3031_extent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder.to_3031_extent" title="Link to this definition"></a></dt>
<dd><p>Project a swath’s lat/lon to EPSG:3031 and return [xmin, ymin, xmax, ymax] (+buffer).
Wrap longitudes to [-180, 180) first to avoid dateline issues.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_regridder.SeaIceRegridder.union_extents">
<span class="sig-name descname"><span class="pre">union_extents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_regridder.html#SeaIceRegridder.union_extents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_regridder.SeaIceRegridder.union_extents" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sea_ice_icebergs">
<span id="sea-ice-icebergs"></span><h2>sea_ice_icebergs<a class="headerlink" href="#module-sea_ice_icebergs" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sea_ice_icebergs.SeaIceIcebergs">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sea_ice_icebergs.</span></span><span class="sig-name descname"><span class="pre">SeaIceIcebergs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_icebergs.html#SeaIceIcebergs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_icebergs.SeaIceIcebergs" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_icebergs.SeaIceIcebergs.check_GI_coverage">
<span class="sig-name descname"><span class="pre">check_GI_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GI_counts'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lat'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_icebergs.html#SeaIceIcebergs.check_GI_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_icebergs.SeaIceIcebergs.check_GI_coverage" title="Link to this definition"></a></dt>
<dd><p>Assess grounded iceberg (GI) or landmask coverage across Antarctica.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<em>xr.DataArray</em>) – The GI or KMT data.</p></li>
<li><p><strong>varname</strong> (<em>str</em>) – Determines masking logic: ‘GI_counts’ uses &gt;0, anything else uses &gt;1.</p></li>
<li><p><strong>lon_name</strong> (<em>str</em><em>, </em><em>default 'lon'</em>) – Name of the longitude coordinate.</p></li>
<li><p><strong>lat_name</strong> (<em>str</em><em>, </em><em>default 'lat'</em>) – Name of the latitude coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>report</strong> – Dictionary of summary statistics and Antarctic sector coverage.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_icebergs.SeaIceIcebergs.compute_grounded_iceberg_area">
<span class="sig-name descname"><span class="pre">compute_grounded_iceberg_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_icebergs.html#SeaIceIcebergs.compute_grounded_iceberg_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_icebergs.SeaIceIcebergs.compute_grounded_iceberg_area" title="Link to this definition"></a></dt>
<dd><p>Returns:
- dict of km^2 by region if region is provided
- total GI area (m^2) if region is None (or km^2 if you divide by scale)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_icebergs.SeaIceIcebergs.load_GI_lon_lats">
<span class="sig-name descname"><span class="pre">load_GI_lon_lats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_icebergs.html#SeaIceIcebergs.load_GI_lon_lats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_icebergs.SeaIceIcebergs.load_GI_lon_lats" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_icebergs.SeaIceIcebergs.load_existing_thinned">
<span class="sig-name descname"><span class="pre">load_existing_thinned</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_icebergs.html#SeaIceIcebergs.load_existing_thinned"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_icebergs.SeaIceIcebergs.load_existing_thinned" title="Link to this definition"></a></dt>
<dd><p>Load previously saved thinned grounded iceberg data and modified KMT file.</p>
<p>Sets the attributes <cite>self.GI_thin_da</cite>, <cite>self.GI_thin_mask</cite>, and <cite>self.GI_KMT</cite>
if their respective NetCDF files exist.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_icebergs.SeaIceIcebergs.modify_landmask_with_grounded_icebergs">
<span class="sig-name descname"><span class="pre">modify_landmask_with_grounded_icebergs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_icebergs.html#SeaIceIcebergs.modify_landmask_with_grounded_icebergs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_icebergs.SeaIceIcebergs.modify_landmask_with_grounded_icebergs" title="Link to this definition"></a></dt>
<dd><p>Apply probabilistic thinning to the grounded iceberg mask based on iceberg counts.</p>
<section id="id11">
<h3>Parameters:<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>p_min<span class="classifier">float</span></dt><dd><p>Minimum probability of retaining a cell with low counts.</p>
</dd>
<dt>p_max<span class="classifier">float</span></dt><dd><p>Maximum probability of retaining a cell with high counts.</p>
</dd>
<dt>scaling_exponent<span class="classifier">float</span></dt><dd><p>Controls steepness of probability scaling with count.</p>
</dd>
</dl>
</section>
<section id="id12">
<h3>Sets:<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<p>self.GI_thin_da : xarray.DataArray
self.GI_thin_mask : ndarray (boolean)
self.GI_thin_fact : float (fraction thinned out)</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_icebergs.SeaIceIcebergs.process_raw_grounded_iceberg_database">
<span class="sig-name descname"><span class="pre">process_raw_grounded_iceberg_database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GI_P_raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_icebergs.html#SeaIceIcebergs.process_raw_grounded_iceberg_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_icebergs.SeaIceIcebergs.process_raw_grounded_iceberg_database" title="Link to this definition"></a></dt>
<dd><p>Load and spatially map raw grounded iceberg locations from CSV to the model grid.</p>
<p>Uses a KD-tree nearest-neighbor search to assign iceberg coordinates to grid cells.
Sets <cite>self.GI_clean</cite> with attached (nj, ni) indices.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_icebergs.SeaIceIcebergs.regrid_gi_to_fip_bool">
<span class="sig-name descname"><span class="pre">regrid_gi_to_fip_bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gi_mask_da</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gi_lon2d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gi_lat2d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fip_lon2d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fip_lat2d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilate_pixels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_icebergs.html#SeaIceIcebergs.regrid_gi_to_fip_bool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_icebergs.SeaIceIcebergs.regrid_gi_to_fip_bool" title="Link to this definition"></a></dt>
<dd><p>Regrids a boolean GI mask from the model grid onto the FIP grid via nearest-neighbour
on great-circle distance (xesmf ‘nearest_s2d’). Returns a boolean mask on the FIP grid.
Optionally dilates by N pixels on the target grid to include coast-adjacent cells.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_icebergs.SeaIceIcebergs.write_modified_landmask_and_counts_to_disk">
<span class="sig-name descname"><span class="pre">write_modified_landmask_and_counts_to_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_icebergs.html#SeaIceIcebergs.write_modified_landmask_and_counts_to_disk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_icebergs.SeaIceIcebergs.write_modified_landmask_and_counts_to_disk" title="Link to this definition"></a></dt>
<dd><p>Save the thinned grounded iceberg counts and modified KMT landmask to NetCDF files.</p>
<p>File paths are generated from the config template using GI thinning factor and version.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sea_ice_ACCESS">
<span id="sea-ice-access"></span><h2>sea_ice_ACCESS<a class="headerlink" href="#module-sea_ice_ACCESS" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sea_ice_ACCESS.SeaIceACCESS">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sea_ice_ACCESS.</span></span><span class="sig-name descname"><span class="pre">SeaIceACCESS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_ACCESS.html#SeaIceACCESS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_ACCESS.SeaIceACCESS" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_ACCESS.SeaIceACCESS.list_access_cice_variables">
<span class="sig-name descname"><span class="pre">list_access_cice_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_ACCESS.html#SeaIceACCESS.list_access_cice_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_ACCESS.SeaIceACCESS.list_access_cice_variables" title="Link to this definition"></a></dt>
<dd><p>Lists all available CICE sea ice variables in the ACCESS-NRI Intake catalog
for the specified experiment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>experiment</strong> (<em>str</em><em>, </em><em>optional</em>) – ACCESS experiment name (e.g., “access-om2-01-iaf”).
If not provided, falls back to <cite>self.AOM2_dict[‘experiment’]</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sorted list of unique CICE variable names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_ACCESS.SeaIceACCESS.load_ACCESS_OM_CICE">
<span class="sig-name descname"><span class="pre">load_ACCESS_OM_CICE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt0_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtN_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_ACCESS.html#SeaIceACCESS.load_ACCESS_OM_CICE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_ACCESS.SeaIceACCESS.load_ACCESS_OM_CICE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sea_ice_ACCESS.SeaIceACCESS.write_ACCESS_to_monthly_zarr">
<span class="sig-name descname"><span class="pre">write_ACCESS_to_monthly_zarr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sea_ice_ACCESS.html#SeaIceACCESS.write_ACCESS_to_monthly_zarr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sea_ice_ACCESS.SeaIceACCESS.write_ACCESS_to_monthly_zarr" title="Link to this definition"></a></dt>
<dd><p>Splits a daily dataset into monthly chunks and writes each to a separate Zarr file.</p>
<p>INPUTS:
DS : xarray.Dataset</p>
<blockquote>
<div><p>Daily model output dataset with a ‘time’ dimension.</p>
</div></blockquote>
<dl class="simple">
<dt>overwrite<span class="classifier">bool</span></dt><dd><p>If True, overwrite existing Zarr directories.</p>
</dd>
</dl>
<p>OUTPUTS:
Writes: D_out/iceh_YYYY-MM.zarr for each month in DS</p>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="AFIM Python Package Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="AFIM_sensitivity_methodology.html" class="btn btn-neutral float-right" title="Methodology: Antarctic (Land)Fast (Sea) Ice Modelling and Metrics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Daniel Atwater.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>